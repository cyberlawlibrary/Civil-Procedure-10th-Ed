var alphabeticalLastNameCQPerf=[],lowestCQPerf=[],highestCQPerf=[],cqStudXlReport=[],cqStudDetailsXlReport=[],cqClassXlReport=[],maxChoiceCount=0;function redeemClassCode(e,t){var a=$(".redeemClassCode-input").val().trim();$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:t,pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassCode:a}};$.ajax({url:properties[properties.env]+"/manageCQ/redeemCQClassCode",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"===e.status){if(e.cqClassVO){$("#redeemClassCode-inputId").val("");var a=$(".creditClassCount").attr("creditCount");if(parseInt(a)-1!=0){$(".classCodeAddSection").show();var o=parseInt(a)-1;$(".creditClassCount").attr("creditcount",o),$(".creditClassCount").html(o+" Credit")}else $(".classCodeAddSection").hide(),$(".classCodeAddSection").html("");e.cqClassVO.pendingQPQuizCount&&("0"!==e.cqClassVO.pendingQPQuizCount?($(".cq-notification-cog-new").css("display","inline-block"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)):($(".cq-notification-cog-new").css("display","none"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)));var i=$(".classCodeAddSection").html();localStorage.setItem("classCodeAddSectionRefresh",i),"Bookshelf"!=t&&$("#okay-gotItBtns").attr("onclick","connectQuizStudentLanding('redeem',null)");var r="You've successfully redeemed Connected Quizzing for "+e.cqClassVO.cqTitle+" with Professor "+e.cqClassVO.professorFirstName+" "+e.cqClassVO.professorLastName;$("#thankYouGetCQPopover .modal-thankYouCQPopoverHeader").html(r),$("#thankYouGetCQPopover").modal("show")}if(e.cqProductVOList){$(".cq-title").parent().find(".student-book-author").remove(),"object"==$.type(e.cqProductVOList)&&(e.cqProductVOList=[e.cqProductVOList]);for(var s=0;s<e.cqProductVOList.length;s++)$(".cq-title").after('<div class="student-book-author" tabindex="0" onclick="connectQuizStudentLanding(true,null)"><p>'+e.cqProductVOList[s].cqTitle+"</p></div>")}$(".cq-productBook").attr("onclick","connectQuizStudentLanding(true,null)"),$(".student-book-title.cq-title").attr("onclick","connectQuizStudentLanding(true,null)"),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),"bus.exception.class.code.has.been.already.used.by.you"==e.responseJSON.wkErrorCode?alertMessagesModal("You are already enrolled in this class. Please try a different class code."):"bus.exception.invalid.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("The class code you entered does not exist. Please check the code and try again."):"bus.exception.semester.end.date.has.past.for.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("This class is no longer in session. Please try a different class code."):alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function getQpAuthenticationToken(e,t,a,o,i,r,s,n){var d={clientCode:connectQuizzing.clientCode,secretKey:connectQuizzing.secretKey,email:localStorage.getItem("email"),firstName:localStorage.getItem("firstName"),lastName:localStorage.getItem("lastName"),clientUserId:map.userId};$.ajax({url:properties.quizzingPlatform+"/api/authenticate",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(d)}).then(function(d){d.token&&(localStorage.setItem("authTokenCQ",d.token),e&&("preview"==e?previewQuestion(t,a,o,i):"PPIdentifierCreation"==e?createidentifierforPPQuiz(t,a,o,i,r):"PPinstanceCreation"==e?createidentifierforPPQuiz(t,a,o,i,r,s,n):createInstanceforQuiz(t,a,o,i)))},function(e){})}function showAssignPopover(e,t){var a=$(e.currentTarget),o=a.attr("quiz-Identifier"),i=a.attr("quizId"),r=a.attr("publishResultInstantlyFlag"),s=(a.parent().attr("cqId"),a.parent().attr("classId")),n=a.parent().attr("id"),d=a.parent().attr("classname"),l=a.text();if($("#assignBtn").removeClass("firstAssign"),$("#assignBtn").removeClass("dblAssign"),"prof"==t){d=$(".breadCrumbSection .studSemesterNames").html(),l=localStorage.getItem("quizName"),$(".errorMsgAssignQuiz").html("");a.attr("quizEndDate"),a.attr("assignedCount"),a.attr("completedCount");var c,p,u,g=a.attr("quizstartdate");u=g;var m=a.attr("quizenddate");$(".semester-drpdwn").val();if(a.parent().find(".dueDate").length>0){var h=a.parent().find(".dueDate")[0].innerText;h&&((h=h.split("at"))[0].split(":")[1],h[1])}if(a.parent().find(".startDate").length>0){var v=a.parent().find(".startDate")[0].innerText;v&&(c=(v=v.split("at"))[0].split(":")[1],p=v[1])}if(a.hasClass("assigned")||a.hasClass("completed")){$("#myModalStart").modal("show");var I=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],S=$(".semester-drpdwn option:selected")[0].getAttribute("semesterstartdate").split(" ")[0],b=moment().format().split("T")[0],C=Date.parse(S),f=Date.parse(b);Date.parse(I);f<C?$("#myModalStart #calenderSelectDueDatemyModalStart").datepicker({dateFormat:"MM dd, yy",minDate:moment(S).format("MMMM DD, YYYY"),maxDate:moment(I).format("MMMM DD, YYYY")}):$("#myModalStart #calenderSelectDueDatemyModalStart").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:new Date(I)});for(var T="",R=1;R<13;R++)T+=R<10?"<option value=0"+R+">0"+R+"</option>":"<option value="+R+">"+R+"</option>";$("#myModalStart #calenderSelectDueTime").html(T);var y=(P=m.split(" "))[1].split(":");a.hasClass("completed")?($("#myModalStart #calenderSelectDueDatemyModalStart").datepicker().datepicker("setDate",""),$("#myModalStart #calenderSelectDueTime").val(""),$("#myModalStart #calenderSelectDueMins").val(""),$("#myModalStart #calenderSelectDueMeridian").val("")):($("#myModalStart #calenderSelectDueDatemyModalStart").datepicker().datepicker("setDate",moment(P[0]).format("MMMM DD, YYYY")),$("#myModalStart #calenderSelectDueTime").val(y[0]),$("#myModalStart #calenderSelectDueMins").val(y[1]),$("#myModalStart #calenderSelectDueMeridian").val(P[2])),$("#myModalStart #calenderSelectStartDate").val(c),$("#myModalStart #calenderSelectStartDate").attr("quizEditStartDate",u),$("#myModalStart #calenderSelectStartTime").val(p),$("#reassign").attr("quizId",i),$("#reassign").attr("classId",s),$("#reassign").attr("quizIdentifier",o),$(".modalClassNameHeader").html(l+"<span> for </span><span class='classNameHeaderStyle'>"+d+"</span>"),localStorage.setItem("xlStartDate",a.attr("quizStartDate")),localStorage.setItem("xlEndDate",a.attr("quizEndDate")),null!=r&&null!=r&&"true"==r?$("#myModalStart .quiz-res-dec .stud-sub").prop("checked",!0):$("#myModalStart .quiz-res-dec .after-quiz").prop("checked",!0)}else{I=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],S=$(".semester-drpdwn option:selected")[0].getAttribute("semesterstartdate").split(" ")[0],b=moment().format().split("T")[0],C=Date.parse(S),f=Date.parse(b);if(Date.parse(I)<f)$("#mySemComplete").modal("show");else{$("#myModalForPropertyIntroduction").modal("show"),$("#startImmediately").prop("checked",!1),$("#myModalForPropertyIntroduction #calenderSelectDueDate").val(""),f<C?($("#modal-date-container #calenderSelectStartDate").datepicker({dateFormat:"MM dd, yy",minDate:moment(S).format("MMMM DD, YYYY"),maxDate:moment(I).format("MMMM DD, YYYY")}),$("#modal-date-container #calenderSelectDueDate").datepicker({dateFormat:"MM dd, yy",minDate:moment(S).format("MMMM DD, YYYY"),maxDate:moment(I).format("MMMM DD, YYYY")})):($("#modal-date-container #calenderSelectStartDate").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:moment(I).format("MMMM DD, YYYY")}),$("#modal-date-container #calenderSelectDueDate").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:moment(I).format("MMMM DD, YYYY")}));for((new Date).getHours(),T="",R=1;R<13;R++)T+=R<10?"<option value=0"+R+">0"+R+"</option>":"<option value="+R+">"+R+"</option>";if($("#calenderSelectDueTime").html(T),$("#calenderSelectStartTime").html(T),a.hasClass("futureAssign")){var O=g.split(" "),z=O[1].split(":");$("#myModalForPropertyIntroduction #calenderSelectStartDate").datepicker().datepicker("setDate",moment(O[0]).format("MMMM DD, YYYY")),$("#myModalForPropertyIntroduction #calenderSelectStartTime").val(z[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMins").val(z[1]),$("#myModalForPropertyIntroduction #calenderSelectStartMeridian").val(O[2]);var P;y=(P=m.split(" "))[1].split(":");$("#myModalForPropertyIntroduction #calenderSelectDueDate").datepicker().datepicker("setDate",moment(P[0]).format("MMMM DD, YYYY")),$("#myModalForPropertyIntroduction #calenderSelectDueTime").val(y[0]),$("#myModalForPropertyIntroduction #calenderSelectDueMins").val(y[1]),$("#myModalForPropertyIntroduction #calenderSelectDueMeridian").val(P[2])}else $("#myModalForPropertyIntroduction #calenderSelectDueDate").datepicker().datepicker("setDate",""),$("#myModalForPropertyIntroduction #calenderSelectDueTime").val(""),$("#myModalForPropertyIntroduction #calenderSelectDueMins").val(""),$("#myModalForPropertyIntroduction #calenderSelectDueMeridian").val(""),$("#modal-date-container #calenderSelectStartDate").datepicker().datepicker("setDate",moment().format("MMMM DD, YYYY")),$("#assignBtn").addClass("firstAssign"),$("#startImmediately").trigger("click");$(".modalClassNameHeader").html(l+"<span> for </span><span class='classNameHeaderStyle'>"+d+"</span>"),$("#assignBtn").attr("quizId",i),$("#assignBtn").attr("classId",s),$("#assignBtn").attr("quizIdentifier",o),$("#assignBtn").show(),$("#assignBtn").addClass("dblAssign")}null!=r&&null!=r&&"true"==r?$("#myModalForPropertyIntroduction .quiz-res-dec .stud-sub").prop("checked",!0):$("#myModalForPropertyIntroduction .quiz-res-dec .after-quiz").prop("checked",!0)}}else{var k=a.attr("qpQuizInstanceURL"),Q=compareTimeWithLocal(a.attr("quizEndDate")),V=Q/1e3;if(V=Q>0?"Time Left: "+(V=convertSecstoHrs(V)):"Time Left: 0m",a.hasClass("studQuizBtn"))$("#myModalQuizStart").modal("show"),$("#myModalQuizStart .modalClassNameHeaderQuizTest").html(l),$("#myModalQuizStart .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizStart .cQuizDateTextStyles.timeLeft").html(V),$("#startBtns").attr("quizId",i),null!=k&&null!=k&&""!=k?($("#startBtns").text("Continue"),$("#startBtns").attr("onclick","showQuizFrame('"+k+"','stud')")):($("#startBtns").text("Start"),$("#startBtns").attr("onclick","createInstanceforQuiz('"+o+"',"+n+","+s+")"));else if("completed"==a.attr("quizstatus")){var A=a.parent().find(".completedDate")[0].innerHTML.split("Due:")[1],w=a.attr("instanceId"),L=a.parent().attr("classid");$("#myModalQuizSummary").modal("show"),$("#myModalQuizSummary .cQuizDateTextStyles.detailedText").remove(),$("#myModalQuizSummary .modalClassNameHeaderQuizTest").html(l),$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizSummary .cQuizDateTextStyles.timeLeft").html("Submitted: "+A),$(".modalClassNameHeaderQuizTestSummary").html(l),$("#myModalQuizSummary .cQuizViewResultsStyles").html("View Results:"),$("#summaryBtns").show(),"true"==r?($("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+w+","+L+")"),$("#detailedBtns").show()):"Time Left: 0m"==V?($("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+w+","+L+")"),$("#detailedBtns").show()):($("#detailedBtns").hide(),$("#summaryDetailBtns").after('<p class="cQuizDateTextStyles detailedText" style="margin-bottom: 15px;">Detailed Results will post on '+a.parent().find(".dueDate")[0].innerHTML.split("Due:")[1]+"</p>")),$("#summaryBtns").attr("onclick","showQuizFrame('"+k+"','stud')")}else $("#myModalQuizSummary").modal("show"),$("#myModalQuizSummary .cQuizDateTextStyles.detailedText").remove(),$("#myModalQuizSummary .modalClassNameHeaderQuizTestSummary").html(l),$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizSummary .cQuizDateTextStyles.timeLeft").html(V),$("#myModalQuizSummary .cQuizViewResultsStyles").html("View Results: Not Submitted"),$("#detailedBtns").hide(),$("#summaryBtns").hide()}}function endQuizPopover(e){$("#myModalStart").modal("hide"),$("#myModalEndQuizPopup").modal("show"),$("#myModalEndQuizPopup #yesBtnEndQuiz").attr("onclick","endQuiz("+e+")")}function endQuizNoPopover(){$("#myModalEndQuizPopup").modal("hide")}function convert24to12hrs(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function startImmediatley(e){if($(e.currentTarget).prop("checked")){var t=moment.tz.guess(),a=moment.tz(new Date,t).format().split("T");$("#myModalForPropertyIntroduction #calenderSelectStartDate").datepicker().datepicker("setDate",moment().format("MMMM DD, YYYY"));var o=convert24to12hrs((a=a[1].split(":"))[0]+":"+a[1]);(o=o.split(":"))[0]<10&&(o[0]="0"+o[0]);var i=o[1].split(" ");$("#myModalForPropertyIntroduction #calenderSelectStartTime").val(o[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMins").val(i[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMeridian").val(i[1])}}function unchkStartImmediatley(){$("#startImmediately").prop("checked",!1)}function triggerDate(e){$("#"+e).datepicker("show"),"calenderSelectStartDate"==e&&unchkStartImmediatley()}function assignQuiz(e){var t=$(e.currentTarget).attr("quizId"),a=$(e.currentTarget).attr("classId"),o=$(e.currentTarget).attr("estTime"),i=$(e.currentTarget).attr("startTime"),r=$(e.currentTarget).attr("publishResultInstantlyFlag"),s=$(".btn-sec").attr("id"),n=$("#"+t).attr("quiz-identifier"),d=$(".semester-drpdwn").val();$("#page-loading-spinner").show();var l={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:n,cqClassId:a,qpProductId:s,lastViewedCQSemesterId:d},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:t,assigned:!0,publishResultInstantlyFlag:r,quizEndDate:o,quizStartDate:i},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/assignQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(l)}).then(function(e){if($("#page-loading-spinner").hide(),"true"===e.status){if($("#myModalAssignPopup").modal("hide"),e.qpQuizVO){$("#"+t).attr("quizstartdate",convertStartTimeFunc(e.qpQuizVO.quizStartDate)),$("#"+t).attr("quizenddate",convertStartTimeFunc(e.qpQuizVO.quizEndDate)),$("#"+t).attr("assignedcount",e.qpQuizVO.assignedCount),$("#"+t).attr("completedcount",e.qpQuizVO.completedCount),$("#"+t).attr("publishResultInstantlyFlag",r);var a=compareTimeWithLocal(e.qpQuizVO.quizEndDate),o=a/1e3,i=compareTimeWithLocal(e.qpQuizVO.quizStartDate);a>0&&(o="Due: "+convetTimeESTAppend(e.qpQuizVO.quizEndDate));var s="Due: "+convetTimeESTAppend(e.qpQuizVO.quizStartDate);checkQuiz(t,a,i,s,o,e.qpQuizVO.assignedCount,e.qpQuizVO.completedCount,!0),$("#"+t).after('<div class="dueDate" style="display:none">'+o+"</div>"),$("#"+t).after('<div class="startDate" style="display:none">'+s+"</div>"),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),$(".breadCrumbSection.startEnd").show()}}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function endQuiz(e){var t=$(".btn-sec").attr("classid"),a=$(".btn-sec").attr("id"),o=$("#"+e).attr("quiz-identifier"),i=$(".semester-drpdwn").val();$("#page-loading-spinner").show();var r={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:o,cqClassId:t,qpProductId:a,lastViewedCQSemesterId:i},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:e}};$.ajax({url:properties[properties.env]+"/manageCQ/endQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(r)}).then(function(t){if($("#page-loading-spinner").hide(),"true"===t.status){if($("#myModalEndQuizPopup").modal("hide"),$("#"+e).removeClass("assigned"),$("#"+e).addClass("completed"),$("#"+e).html("Reopen Quiz"),$("#endQuizBtnStart").remove(),$("#cancelQuiz").remove(),t.qpQuizVO){$("#"+e).attr("quizenddate",convertStartTimeFunc(t.qpQuizVO.quizEndDate)),$("#"+e).parent().find(".dueDate").remove();var a="Due: "+convetTimeESTAppend(t.qpQuizVO.quizEndDate);$("#"+e).after('<div class="dueDate" style="display:none">'+a+"</div>");var o=(a=a.split("at"))[0].split(":")[1],i=a[1];$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+o+" at "+i),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html())}var r=$(".completedBtnGroup .completedBtn").html();r.length>0&&(r=r.replace("In Progress","Completed"),$(".completedBtnGroup .completedBtn").html(r),$(".completedBtnGroup").css("background","#dadada"),localStorage.setItem("progresString",r))}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function connectQuizProfLanding(e,t){if(null!=e&&null!=e&&localStorage.setItem("eulaValidationCheck",e.currentTarget.getAttribute("eulaFlag")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),e)var a=e.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(a).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"})}$("#page-loading-spinner").show();var o="";t&&(o="true"==t?$(".semester-drpdwn").val():t);var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_DASHBOARD",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};t&&(i.cqSemesterVO={semesterId:o},i.userVO.userActivityVO.lastViewedCQSemesterId=o),$.ajax({url:properties[properties.env]+"/manageCQ/getCQClassBySemesterId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insidePracticePerfect=!1,insideCQuizzing=!0,e.cqClassVOList){var a=e.cqClassVOList;"object"==$.type(a)&&(a=[a]);for(var i=0;i<a.length;i++)"object"==$.type(a[i].classQuizVOList)&&(a[i].classQuizVOList=[a[i].classQuizVOList]);map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){getSemesterBySchoolId(a[0].semesterId);var e=Handlebars.getTemplate("connect-Quiz-landing")(a);$("#cQuiz-course-admin-progress").html(e),adjustLeftNavHeight(),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show()})}else map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){t?getSemesterBySchoolId(o):($(".semester-drpdwn").html("<option value='-999'>Select a Semester</option>"),getSemesterBySchoolId(-999)),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show(),adjustLeftNavHeight()});Utility.hideSpinner()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function previewQuestion(e,t,a){if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("preview",e,t,a),!0;$("#page-loading-spinner").show();fetch(properties.quizzingPlatform+"/api/tests/"+e+"/preview?productId="+t+"&showAnswer=true",{method:"GET",headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(e){e&&($("#myModalForPropertyIntroduction").modal("hide"),showQuizFrame(e,"prof",a)),Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function getSemesterBySchoolId(e){localStorage.getItem("schoolId");$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_DASHBOARD",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqSemesterVO:{schoolId:localStorage.getItem("schoolId")}};$.ajax({url:properties[properties.env]+"/manageCQ/getActiveSemesterForProfessor",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){if("true"==t.status){if(t.cqSemesterVOList){var a=t.cqSemesterVOList;"object"==$.type(a)&&(a=[a]);for(var o="",i=0;i<a.length;i++)o+="<option value='"+a[i].semesterId+"' semesterStartDate='"+a[i].semesterStartDate+"' semesterEndDate='"+a[i].semesterEndDate+"'>"+a[i].semesterName+"</option>";$(".semester-drpdwn").html(o),$(".semester-drpdwn").val(e),$(".timeLeftShow").each(function(){"Completed"==$(this).html()&&$(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn").addClass("quizStartYesBtn")})}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function connectQuizStudentLanding(e,t){if(null!=t&&null!=t&&localStorage.setItem("eulaValidationCheck",t.currentTarget.getAttribute("eulaFlag")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),t)var a=t.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(a).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true,"+e+")"})}if("redeem"!=e){var o=$(".classCodeAddSection").html();null!=localStorage.getItem("classCodeAddSectionRefresh")&&null!=localStorage.getItem("classCodeAddSectionRefresh")||localStorage.setItem("classCodeAddSectionRefresh",o)}$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentCQDashboard",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insidePracticePerfect=!1,insideCQuizzing=!0,e.cqClassVOList){var t=e.cqClassVOList;"object"==$.type(t)&&(t=[t]),map.wk_conatiner.load("connectQuizStudent-landing.html?v4",function(){for(var e=0;e<t.length;e++)t[e].qpQuizVOList&&"object"==$.type(t[e].qpQuizVOList)&&(t[e].qpQuizVOList=[t[e].qpQuizVOList]);var a=localStorage.getItem("classCodeAddSectionRefresh");null!=a&&null!=a&&"undefined"!=a&&($(".classCodeAddSectionHeaderpart").html(a),$(".add-classCode").attr("onclick",'redeemClassCode(event,"CQ_STUDENT_DASHBOARD_PAGE")'));var o=Handlebars.getTemplate("student-connect-Quiz-landing")(t);$("#studCQuiz-course-admin-progress").html(o),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),$(".timeLeftShow").each(function(){"Not Submitted"==$(this).html()&&($(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn").addClass("studQuizCompleteBtn").addClass("quizStartYesBtn"),$(this).prev(".btn-primary").attr("quizStatus","ended"))}),ConnectQuizSetSection(),adjustLeftNavHeight()})}else map.wk_conatiner.load("connectQuizStudent-landing.html?v4",function(){var e=localStorage.getItem("classCodeAddSectionRefresh");null!=e&&null!=e&&"undefined"!=e&&($(".classCodeAddSectionHeaderpart").html(e),$(".add-classCode").attr("onclick",'redeemClassCode(event,"CQ_STUDENT_DASHBOARD_PAGE")')),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),ConnectQuizSetSection(),adjustLeftNavHeight()});$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function createInstanceforQuiz(e,t,a){if($("#myModalQuizStart").modal("hide"),null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("instanceCreation",e,t,a),!0;var o="/api/tests/identifier/"+e+"/instances?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+o,{method:"POST",body:JSON.stringify({productId:t,showAnswer:!1,externalContext:{productType:"cq"}}),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(t){t?(postInstanceUrlToCC(t,e,a),showQuizFrame(t,"stud"),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function postInstanceUrlToCC(e,t,a){$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,qpQuizInstanceURL:e,qpAuthToken:localStorage.getItem("authTokenCQ")},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/postUserQuizInstance",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){"true"===e.status&&$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function loadProfResultSummary(e,t,a,o){$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getOverallResultForClass",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status){if(e.cqResultVO){var t=Handlebars.getTemplate("professor-quizDetailedResults")(e.cqResultVO);$("#profCQuiz-detailedResult-progress").html(t)}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getTopicResultsForClass(e,t,a,o){$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t,qpProductId:o}};$.ajax({url:properties[properties.env]+"/manageCQ/getTopicResultsForClass",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);cqClassXlReport=e.qpQuestionVOList}else cqClassXlReport=[];if(e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var a=0;a<e.qpTopicVOList.length;a++)"object"==$.type(e.qpTopicVOList[a].associatedQuestionVOList)&&(e.qpTopicVOList[a].associatedQuestionVOList=[e.qpTopicVOList[a].associatedQuestionVOList])}var o=Handlebars.getTemplate("professor-quizTopicResults")(e);$("#profCQuiz-TopicResult-progress").html(o)}if(maxChoiceCount=parseInt(e.maxChoiceCount),e.userSettingsVO)"topicView"==e.userSettingsVO.cqResultDisplayOption?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide(),$("#cqquestionOrder").val("topicView")):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide(),$("#cqquestionOrder").val("questionView"));else $("#cqquestionOrder").val("topicView");$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function updateCQResultView(e){var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},userSettingsVO:{cqResultDisplayOption:e}};"Student"==localStorage.getItem("userRole")?(t.userVO.userActivityVO.lastActivityCode="CQ_STUDENT_RESULT_SUMMARY_PAGE",t.userVO.userActivityVO.instanceId=localStorage.getItem("instanceID"),t.userVO.userActivityVO.cqClassId=localStorage.getItem("classID"),t.userVO.userActivityVO.qpQuizIdentifier=localStorage.getItem("quizIdentifier")):t.userVO.userActivityVO.lastActivityCode="CQ_PROFESSOR_RESULT_SUMMARY_PAGE",$.ajax({url:properties[properties.env]+"/manageCQ/updateCQResultView",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){e.status},function(e){Utility.handleSessionAuthentication(e.responseJSON)&&alertMessagesModal(e.responseJSON.errorMessg)})}function getAllStudentsScore(e,t,a,o){$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getAllStudentsScore",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(a){if("true"===a.status){if(a.cqResultVOList){"object"==$.type(a.cqResultVOList)&&(a.cqResultVOList=[a.cqResultVOList]),alphabeticalLastNameCQPerf=a.cqResultVOList,lowestCQPerf=a.cqResultVOList,kendoInCQSummaryPage(),$("#profCQuiz-studResult-progress").show(),$(".overAllPerformanceClass-parent").show(),$(".stud-ClassName-ResultSection").remove();var i=Handlebars.getTemplate("professor-quizStudentResults")(a.cqResultVOList);$("#profCQuiz-studResult-progress .orderingPercentageSection").after(i),adjustLeftNavHeight(),$(".prof-expandResults").attr("onclick","getDetailedResultForStudent(event,'"+e+"','"+t+"','"+o+"')")}else alphabeticalLastNameCQPerf=[],$("#profCQuiz-studResult-progress").hide(),$(".overAllPerformanceClass-parent").hide(),highestCQPerf=[],lowestCQPerf=[];$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getDetailedResultForStudent(e,t,a,o){var i=$(e.currentTarget).attr("instanceId"),r=$(e.currentTarget).attr("userId");if("Expand Results"==$(e.currentTarget).html()?$(e.currentTarget).html("Collapse Results"):$(e.currentTarget).html("Expand Results"),$("#prof-student-detailed"+r).children().length>0);else{$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:t,instanceId:i,qpProductId:o,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,instanceId:i},cqClassVO:{cqClassId:a},userSearchVO:{userId:r}};$.ajax({url:properties[properties.env]+"/manageCQ/getDetailedResultForStudent",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList&&"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]),e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var t=0;t<e.qpTopicVOList.length;t++)"object"==$.type(e.qpTopicVOList[t].associatedQuestionVOList)&&(e.qpTopicVOList[t].associatedQuestionVOList=[e.qpTopicVOList[t].associatedQuestionVOList])}var a=Handlebars.getTemplate("professor-detailedStudentsResults")(e);$("#prof-student-detailed"+r).html(a),"topicView"==$("#cqquestionOrder").val()?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide()):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide()),adjustLeftNavHeight()}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}}function profDetailedResultPage(e,t,a,o){var i=$(e.currentTarget),r=i.attr("quiz-Identifier"),s=i.attr("quizId"),n=i.parent().attr("cqId"),d=i.parent().attr("classId"),l=i.parent().attr("id"),c=i.parent().attr("classname"),p=i.text(),u=i.attr("publishResultInstantlyFlag");localStorage.setItem("quizName",p);i.attr("quizEndDate");var g,m,h,v,I,S=i.attr("assignedCount"),b=i.attr("completedCount"),C=(t=i.attr("quizstartdate"),$(".semester-drpdwn").val()),f=$(".semester-drpdwn option:selected").text(),T=$("#classCodeInput"+d).val();localStorage.setItem("semName",f),localStorage.setItem("classCode",T),localStorage.setItem("semId",C);var R=i.attr("quizenddate");C=$(".semester-drpdwn").val();if(i.parent().find(".dueDate").length>0){var y=i.parent().find(".dueDate")[0].innerText;v=y,y&&(y=y.split("at"),a=y[0].split(":")[1],g=y[1])}if(i.parent().find(".startDate").length>0){var O=i.parent().find(".startDate")[0].innerText;I=O,O&&((O=O.split("at"))[0].split(":")[1],m=O[1])}insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,$("#cQuiz-landing-content-area").remove(),$(".cquizHeaderContainer").after('<div id="res-prof-sam" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"></div>'),$("#res-prof-sam").load("professor-QuizDetailedResult-landing.html?v26576",function(){if($(".backToQuiz a").attr("onclick","connectQuizProfLanding(null,"+C+")"),$(".proff-ResultClassName-header").html(p),$(".breadCrumbSection .studSemesterNames").html(c),$(".btn-sec").attr("cqId",n),$(".btn-sec").attr("classId",d),$(".btn-sec").attr("id",l),previewQuestionPrint(r,d,C,l),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("quizIdentifier",r),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("classId",d),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("semId",C),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("qpId",l),i.hasClass("quizAssignYesBtn"))h="In Progress: "+b+"/"+S+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+m),$(".completedBtnGroup .completedBtn").html(h),$(".completedBtnGroup").css("background","#A6D1EB"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+g),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="endQuizBtnStart" class="btn btn-md btn-primary cq-prof-result-btn end-quiz ellipsis" onclick="endQuizPopover('+s+')">End Quiz</button><button id="'+s+'" class="btn btn-md btn-primary cq-prof-result-btn assigned ellipsis">Edit Assignment Details</button>'),$("#"+s).attr("quiz-identifier",r),$("#"+s).attr("onclick","showAssignPopover(event,'prof')"),$("#"+s).attr("quizid",s),$("#"+s).attr("completedCount",b),$("#"+s).attr("assignedCount",S),$("#"+s).attr("quizstartdate",t),$("#"+s).attr("quizenddate",R),$("#"+s).attr("publishResultInstantlyFlag",u),$("#"+s).after('<div class="dueDate" style="display:none">'+v+"</div>"),$("#"+s).after('<div class="startDate" style="display:none">'+I+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",i.attr("quizStartDate")),localStorage.setItem("xlEndDate",i.attr("quizEndDate"));else if(i.hasClass("quizStartYesBtn"))h="Completed: "+b+"/"+S+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+m),$(".completedBtnGroup .completedBtn").html(h),$(".completedBtnGroup").css("background","#dadada"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+a+" at "+g),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+s+'" class="btn btn-md btn-primary cq-prof-result-btn completed ellipsis">Reopen Quiz</button>'),$("#"+s).attr("quiz-identifier",r),$("#"+s).attr("onclick","showAssignPopover(event,'prof')"),$("#"+s).attr("quizid",s),$("#"+s).attr("completedCount",b),$("#"+s).attr("assignedCount",S),$("#"+s).attr("quizstartdate",t),$("#"+s).attr("quizenddate",R),$("#"+s).attr("publishResultInstantlyFlag",u),$("#"+s).after('<div class="dueDate" style="display:none">'+v+"</div>"),$("#"+s).after('<div class="startDate" style="display:none">'+I+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",i.attr("quizStartDate")),localStorage.setItem("xlEndDate",i.attr("quizEndDate"));else if(i.hasClass("quizFutureBtn"))$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Starts: "+dateModification(t)+" at "+m),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+g),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="cancelQuiz" class="btn btn-md btn-primary cq-prof-result-btn cancel ellipsis" onclick="cancelQuiz(event)">Cancel Quiz</button><button id="'+s+'" class="btn btn-md btn-primary cq-prof-result-btn futureAssign ellipsis">Edit Assignment Details</button>'),$("#"+s).attr("quiz-identifier",r),$("#"+s).attr("onclick","showAssignPopover(event,'prof')"),$("#"+s).attr("quizid",s),$("#"+s).attr("completedCount",b),$("#"+s).attr("assignedCount",S),$("#"+s).attr("quizstartdate",t),$("#"+s).attr("quizenddate",R),$("#"+s).attr("publishResultInstantlyFlag",u),$("#"+s).after('<div class="dueDate" style="display:none">'+v+"</div>"),$("#"+s).after('<div class="startDate" style="display:none">'+I+"</div>"),$(".preview-page").show();else{$(".breadCrumbSection .studSemesterNames").html(c),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide();var e=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],o=moment().format().split("T")[0],f=Date.parse(o);Date.parse(e)<f||($("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+s+'" class="btn btn-md btn-primary cq-prof-result-btn unassigned ellipsis">Assign to Class</button>'),$("#"+s).attr("quiz-identifier",r),$("#"+s).attr("onclick","showAssignPopover(event,'prof')"),$("#"+s).attr("quizid",s)),$(".preview-page").show()}localStorage.setItem("quizNameString",p),localStorage.setItem("classNameString",$(".breadCrumbSection .studSemesterNames").html()),localStorage.setItem("progresString",h),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),adjustLeftNavHeight()})}function previewQuestionPrint(e,t,a,o){$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t,qpProductId:o}};$.ajax({url:properties[properties.env]+"/manageCQ/getCQPreviewByQuizIdentifier",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);var a=Handlebars.getTemplate("professor-preview")(e);$(".preview-page").html(a)}$("#page-loading-spinner").hide()}$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}var cancelQuizReqData="";function cancelQuiz(e){var t=$(".btn-sec").attr("classid"),a=$(".btn-sec").attr("id"),o=$(".futureAssign").attr("quiz-identifier"),i=$(".futureAssign").attr("id"),r=$(".semester-drpdwn").val(),s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:o,cqClassId:t,qpProductId:a,lastViewedCQSemesterId:r},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassId:t},qpQuizVO:{id:i,qpQuizIdentifier:o}};$("#myModalCancelPopup").modal("show"),cancelQuizReqData=s,$("#myModalCancelPopup #yesBtn").attr("onclick","cancelQuizServ()")}function cancelQuizServ(){$("#myModalCancelPopup").modal("hide");var e=cancelQuizReqData;$("#page-loading-spinner").show(),$.ajax({url:properties[properties.env]+"/manageCQAdmin/cancelQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(t){if("true"===t.status){$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide();var a=e.qpQuizVO.id,o=e.qpQuizVO.qpQuizIdentifier;$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+a+'" class="btn btn-md btn-primary cq-prof-result-btn unassigned ellipsis">Assign to Class</button>'),$("#"+a).attr("quiz-identifier",o),$("#"+a).attr("onclick","showAssignPopover(event,'prof')"),$("#"+a).attr("quizid",a),$(".preview-page").show(),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html(""),$(".breadCrumbSection.startEnd .cQuizClassNames").html(""),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function getDetailedResults(e,t,a){var o=$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html();$("#myModalQuizSummary").modal("hide"),$(".modal-backdrop").remove(),$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,instanceId:t,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e,instanceId:t},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentOverallResult",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(i){"true"===i.status&&(i.qpQuizVO?(loadStudDetailedPage(i.qpQuizVO,e,t,a,o,i.qpQuizVO.strCompletedDate),$("#page-loading-spinner").hide()):$("#page-loading-spinner").hide())},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getStudentResultSummary(e,t,a){$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,instanceId:t,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e,instanceId:t},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentResultSummary",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"===e.status)if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);cqClassXlReport=e.qpQuestionVOList}else cqClassXlReport=[];if(e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var a=0;a<e.qpTopicVOList.length;a++)"object"==$.type(e.qpTopicVOList[a].associatedQuestionVOList)&&(e.qpTopicVOList[a].associatedQuestionVOList=[e.qpTopicVOList[a].associatedQuestionVOList])}var o=Handlebars.getTemplate("student-quizResultSummary")(e);if($("#studCQuiz-detailedResult-progress .timeSpentResultShowIpad").after(o),e.userSettingsVO)"topicView"==e.userSettingsVO.cqResultDisplayOption?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide(),$("#cqquestionOrder").val("topicView")):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide(),$("#cqquestionOrder").val("questionView"));else $("#cqquestionOrder").val("topicView");for(a=0;a<e.qpTopicVOList.length;a++)if(e.qpTopicVOList[a].associatedQuestionVOList)for(var i=0;i<e.qpTopicVOList[a].associatedQuestionVOList.length;i++){var r=e.qpTopicVOList[a].associatedQuestionVOList[i].questionIdentifier;if(e.qpTopicVOList[a].associatedQuestionVOList[i].choiceIndex&&"false"==e.qpTopicVOList[a].associatedQuestionVOList[i].correct){var s=parseInt(e.qpTopicVOList[a].associatedQuestionVOList[i].choiceIndex)-1;$($(".cqTopicperformance #question"+r+" .optionalAnswersContext")[s]).after('<div class="glypicWrongGroup display-inline-block"><a class="glypicStyleWrong" href="#/" style=""><span class="glyphicon glyphicon-remove"></span></a></div>')}}for(a=0;a<cqClassXlReport.length;a++){r=cqClassXlReport[a].questionIdentifier;var n=cqClassXlReport[a].choiceIndex;if(n&&"false"==cqClassXlReport[a].correct){s=parseInt(n)-1;$($(".cqQuizcenterOrder #questionQorder"+r+" .optionalAnswersContext")[s]).after('<div class="glypicWrongGroup display-inline-block"><a class="glypicStyleWrong" href="#/" style=""><span class="glyphicon glyphicon-remove"></span></a></div>')}}adjustLeftNavHeight(),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain,$("#page-loading-spinner").hide()})}function loadStudDetailedPage(e,t,a,o,i,r){var s=$(".modalClassNameHeaderQuizTestSummary").html(),n=$("#"+o+".breadCrumbSection").html();insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1;var d=convetTimeESTAppend(r);map.wk_conatiner.load("student-QuizDetailedResult-landing.html?v2",function(){var r=Handlebars.getTemplate("student-quizDetailedResults")(e);$("#studCQuiz-detailedResult-progress").html(r),$(".stud-ResultClassName-header").html(s),$(".sem-profName-ClassName .detailedResultsDueDate").html(i),$(".sem-profName-ClassName .submittedBtnGroup").html("Submitted: "+d),$(".breadCrumbSection").html(n),localStorage.setItem("classNameString",$(".breadCrumbSection").html()),localStorage.setItem("quizNameString",s),localStorage.setItem("submittedDate",$(".sem-profName-ClassName .submittedBtnGroup").html()),localStorage.setItem("dueDate",i),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),localStorage.setItem("instanceID",a),localStorage.setItem("classID",o),localStorage.setItem("quizIdentifier",t),getStudentResultSummary(t,a,o),adjustLeftNavHeight()})}function expandAllQuestions(e,t){"Expand All Questions"==$(e.currentTarget).html()?($(e.currentTarget).html("Collapse All Questions"),$("#"+t+" .answersFieldSection").addClass("in"),$(".rationaleContext").css("height","auto"),$("#"+t+" .ellipseText").addClass("nonEllipseText").removeClass("ellipsis").removeClass("ellipseText")):($(e.currentTarget).html("Expand All Questions"),$("#"+t+" .answersFieldSection").removeClass("in"),$("#"+t+" .nonEllipseText").addClass("ellipseText").addClass("ellipsis").removeClass("nonEllipseText")),adjustLeftNavHeight()}function expandselectedQuestion(e){var t=$(e.currentTarget).parent().find(".prof-questionBreakDown")[0];$(t).hasClass("ellipseText")?($($(t).attr("data-target")).css("height","auto"),$($(t).attr("data-target")).css("display","inline-block"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function expandselectedQuestionStud(e){var t=$(e.currentTarget).parent().find(".cQuizAttemptedQuestion")[0];$(t).hasClass("ellipseText")?($($(t).attr("data-target")).css("height","auto"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function expandselectedQuestionCheckSymbol(e){var t=e.currentTarget;$(t).hasClass("ellipseText")?($($(t).prev(".cQuizAttemptedQuestion").attr("data-target")).css("height","auto"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis"),$(t).prev(".cQuizAttemptedQuestion").removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$(t).prev(".cQuizAttemptedQuestion").removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function showQuizFrame(e,t,a,o,i){if($("#myModalQuizStart").modal("hide"),$(".modal-backdrop").remove(),null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("continueCreation",e,t,a),!0;insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1;var r="",s="";"pp"==t&&i&&(r=$(i.currentTarget).hasClass("boxCoverModal")?$(i.currentTarget).find(".vidTakeName").html():$(i.currentTarget).parent().parent().find(".vidTakeName").html(),s=$(i.currentTarget).attr("instanceId")),map.wk_conatiner.load("quizPage.html?v6",function(){var n=localStorage.getItem("quizName");if(null!=n&&null!=n&&$(".questionTitleSection").html(n),"prof"==t)$(".container-left-desktop-fix-cq").removeClass("container-left-desktop-fix-pp"),$(".cqDashBoardBtnSection #backToDashboard").attr("onclick","connectQuizProfLanding(null,"+a+")"),$(".cqDashBoardBtnSection").show(),$(".cqDashBoardBtnSection-header").attr("style","display:block"),$(".ppDashBoardBtnSection").hide(),$(".ppDashBoardBtnSection-header").attr("style","display:none !important"),$(".pp-header-Container").hide(),$(".userClassNameStyles").hide(),insideCQuizzing=!0,insidePracticePerfect=!1;else if("pp"==t){$(".pp-header-Container").show();var d=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+d),$(".pp-holder-name .subjectAreaName").html(d),"video"==a?($(".questionTitleSection").hide(),$(".ppDashBoardBtnSection #backToDashboard").html("Back to Video"),$(".ppDashBoardBtnSection #backToDashboard").attr("onclick","getAllVideoTracker('"+o+"')"),$("#reviewResultsModalSection #yesRetakeBtn").attr("onclick","getVideoQuizProgress()")):($(".questionTitleSection").hide(),$(".ppDashBoardBtnSection #backToDashboard").html("Back to Quiz Center"),$(".ppDashBoardBtnSection #backToDashboard").addClass("pp-quizAttemptBtn"),$(".ppDashBoardBtnSection #backToDashboard").attr("onclick","quizPage()"),$("#reviewResultsModalSection #yesRetakeBtn").attr("onclick","quizCenterProgressLazyLoad()")),i&&($(".userClassNameStyles").html(r),$(".ppDashBoardBtnSection #progressBtn").attr("instanceId",s),$(".ppDashBoardBtnSection #progressBtn").show()),$(".cqDashBoardBtnSection").hide(),$(".cqDashBoardBtnSection-header").attr("style","display:none !important"),$(".ppDashBoardBtnSection").show(),$(".ppDashBoardBtnSection-header").attr("style","display:block"),insideCQuizzing=!1,insidePracticePerfect=!0}else $(".cqDashBoardBtnSection #backToDashboard").attr("onclick","connectQuizStudentLanding(true,null)"),$(".container-left-desktop-fix-cq").removeClass("container-left-desktop-fix-pp"),$(".cqDashBoardBtnSection").show(),$(".cqDashBoardBtnSection-header").attr("style","display:block"),$(".ppDashBoardBtnSection").hide(),$(".ppDashBoardBtnSection-header").attr("style","display:none !important"),$(".pp-header-Container").hide(),$(".titleContent").hide(),insideCQuizzing=!0,insidePracticePerfect=!1;$("form#previewQuiz #engineURL").val(e),$("form#previewQuiz #accessToken").val(localStorage.getItem("authTokenCQ")),document.getElementById("previewQuiz").action=e,document.getElementById("previewQuiz").submit(),adjustLeftNavHeight()})}function expandAllQuestionsBreakDown(e,t){var a=$(e.currentTarget).text();document.getElementsByClassName("cQuizAttemptedQuestion");"Expand question breakdown"===a?($("#"+t).show(),$(e.currentTarget).text("Collapse question breakdown")):($(e.currentTarget).text("Expand question breakdown"),$("#"+t).hide()),adjustLeftNavHeight()}function sortingFunct(e){var t=$(e.currentTarget).val(),a=$(".prof-expandResults").attr("onclick"),o=[];o="lowestPerformance"==t?lowestCQPerf:"highestPerformance"==t?lowestCQPerf.slice().reverse():alphabeticalLastNameFunc(alphabeticalLastNameCQPerf),$("#profCQuiz-studResult-progress .stud-ClassName-ResultSection").remove();var i=Handlebars.getTemplate("professor-quizStudentResults")(o);$("#profCQuiz-studResult-progress .orderingPercentageSection").after(i),$(".prof-expandResults").attr("onclick",a),adjustLeftNavHeight()}function convertSecstoHrs(e){var t,a,o=parseInt(e),i="";return o<60?i="0m":o>=60&&o<3600?i=parseInt(o/60)+"m":o>=3600&&o<86400?(t=parseInt(o/3600),o=parseInt(o%3600),i=t+"h "+parseInt(o/60)+"m"):o>=86400&&(a=parseInt(o/86400),o=parseInt(o%86400),t=parseInt(o/3600),o=parseInt(o%3600),i=a+"d "+t+"h "+parseInt(o/60)+"m"),i}function compareTimeWithLocal(e){var t=moment.tz(e,"America/New_York").clone().tz(moment.tz.guess()),a=moment.tz(moment.tz.guess());return t.diff(a)}function kendoInCQSummaryPage(){var e=0,t=0,a=0,o=0,i=0,r=0,s=0,n=0,d=0,l=0;if(lowestCQPerf.length>0){$(".overAllPerformanceClass-parent").show(),$.each(lowestCQPerf,function(c,p){p.score>=0&&p.score<=9?e++:p.score>=10&&p.score<=19?t++:p.score>=20&&p.score<=29?a++:p.score>=30&&p.score<=39?o++:p.score>=40&&p.score<=49?i++:p.score>=50&&p.score<=59?r++:p.score>=60&&p.score<=69?s++:p.score>=70&&p.score<=79?n++:p.score>=80&&p.score<=89?d++:p.score>=90&&p.score<=100&&l++});var c=[{category:"0-9%",score:e},{category:"10-19%",score:t},{category:"20-29%",score:a},{category:"30-39%",score:o},{category:"40-49%",score:i},{category:"50-59%",score:r},{category:"60-69%",score:s},{category:"70-79%",score:n},{category:"80-89%",score:d},{category:"90-100%",score:l}];$("#overAllPerformanceChart").kendoChart({title:{text:""},dataSource:{data:c},series:[{field:"score",color:"#ea8f00",opacity:.5,name:"",highlight:{visible:!1}}],seriesDefaults:{overlay:{gradient:null}},layers:[{type:"shape",style:{stroke:{color:"#ea8f00",width:4,opacity:.5}}}],categoryAxis:{field:"category",labels:{rotation:{angle:45}},majorGridLines:{visible:!1},name:"category",title:{text:"Scores",font:"13px fira-sans, sans-serif",color:"#000",margin:{top:10}}},valueAxis:{field:"score",min:0,max:5,majorUnit:1,width:3,name:"Scores",title:{text:"Number of Students",font:"10px fira-sans, sans-serif",margin:{top:6,right:2}}},majorTicks:{visible:!0}}),$(window).on("resize",function(){kendo.resize($("#overAllPerformanceChart"))})}else $(".overAllPerformanceClass-parent").hide()}function contactAssessmentSpecialist(){$("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),"Professor"===map.userRole?($("#myModalAssesmentSpecilaist").modal("show"),$(".phone-inputField").val(""),$(".email-inputField").val(""),$(".addMessagesInput").val(""),$("input:checkbox.checkBox-style").removeAttr("checked")):window.open("https://support.wklegaledu.com/hc/en-us/categories/360002135031-Connected-Quizzing","_blank")}function validateEmailConcierge(){var t=$(".phone-inputField").val().trim(),a=$(".email-inputField").val().trim(),o=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i=$(".addMessagesInput").val().trim();if($("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),""==t||""==a||!o.test(a))return""==t&&$("#errorMsgNot").html("<span class='err col-sm-3' style='margin-left: 0px;margin-top: 24px;'><span class='password-err-label'>Please enter a phone number.</span></span>"),""==a&&$("#errorMsgNotEmail").html("<span class='err col-sm-3' style='margin-left: 2px;margin-top: 24px;'><span class='password-err-label'>Please enter an email address.</span></span>"),o.test(a)||$("#errorMsgNotEmail").html("<span class='err col-sm-3' style='margin-left:2px;margin-top: 24px;'><span class='password-err-label loginErrMsg'>Please enter a valid email address.</span></span>"),e.preventDefault(),!1;for(var r=[],s=$(".checkBox-style"),n=0;n<s.length;n++)s[n].checked&&r.push($(s[n]).next(".checkBox-content-style").html());$("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),$("#myModalAssesmentSpecilaist").modal("hide"),$("#myModalThankyouPopup").modal("show");var d={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},userProfVO:{email:a,phoneNum:t,conciergeMessages:r,message:i}};$.ajax({url:properties[properties.env]+"/manageCQ/contactMeNotify",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(d)}).then(function(e){e.status},function(e){$("#page-loading-spinner").hide(),$("#myModalAssesmentSpecilaist").modal("hide")})}function excelSheetReportServiceCQ(e,t,a,o){var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,qpProductId:o,cqClassId:t,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getAllStudentsResultForReportGeneration",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status)if(e.cqResultVOList){"object"==$.type(e.cqResultVOList)&&(e.cqResultVOList=[e.cqResultVOList]);for(var t=0;t<e.cqResultVOList.length;t++)"object"==$.type(e.cqResultVOList[t].questionLevelScore)&&(e.cqResultVOList[t].questionLevelScore=[e.cqResultVOList[t].questionLevelScore]);cqStudXlReport=e.cqResultVOList}else cqStudXlReport=[]},function(e){alertMessagesModal(e.responseJSON.errorMessg),$("#page-loading-spinner").hide()})}function fetchCrctAnsOption(e){switch(e){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F";case 6:return"G";case 7:return"H";case 8:return"I";case 9:return"J";case 10:return"K";case 11:return"L";case 12:return"M";case 13:return"N";case 14:return"O";case 15:return"P";case 16:return"Q";case 17:return"R";case 18:return"S";case 19:return"T";case 20:return"U";case 21:return"V";case 22:return"W";case 23:return"X";case 24:return"Y";case 25:return"Z";default:return"N/A"}}function fetchCrctAnsCQ(e){for(var t="",a=0;a<e.length;a++)if("true"==e[a].correct){t=a;break}return fetchCrctAnsOption(t)}function checkCrct(e,t,a){return"true"==e?t?{value:pickChoiceID(a),hAlign:"center"}:{value:"correct",hAlign:"center"}:t?{value:pickChoiceID(a),hAlign:"center",background:"#FFCCCC",color:"#9C0006"}:{value:"incorrect",hAlign:"center",background:"#FFCCCC",color:"#9C0006"}}function cqXLReportDownload(){var e={color:"#000000",size:1},t=$(".avgscr").text().split("%"),a=($(".classCodeInput").text(),$(".highscr").text().split("%")),o=$(".lowscr").text().split("%");""==t[0]&&(t[0]=0),""==a[0]&&(a[0]=0),""==o[0]&&(o[0]=0);var i=$(".proff-ResultClassName-header").text(),r=$(".prof-timeResultDetails")[0].innerText.replace("m"," minutes"),s=$(".studSemesterNames").text(),n=$(".completedBtn").text().split(" ");n=n[n.length-2].split("/");var d=dateXlFormat(localStorage.getItem("xlStartDate")),l=dateXlFormat(localStorage.getItem("xlEndDate")),c=($(".gradiant-button").css("background-color","red"),cqStudXlReport.slice().sort(function(e,t){return c1=e.firstName.toLowerCase(),c2=t.firstName.toLowerCase(),c1<c2?-1:c1>c2?1:0})),p=0;c.length>0&&(p=c[0].questionLevelScore.length);for(var u=moment(Date()).format("MM/DD/YYYY hh:mm A"),g=moment(Date()).format("MMDDYYYY"),m=new kendo.data.DataSource({type:"odata",schema:{model:{fields:{StringVal:{type:"string"},Numbering:{type:"string"}}}}}),h=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(t[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(a[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(o[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{background:"#E7E6E6",borderBottom:e,borderTop:e},{value:"Percent of Students Selecting each Answer",borderBottom:e,borderTop:e,colspan:4,background:"#E7E6E6"},{background:"#E7E6E6",borderBottom:e,borderTop:e},{background:"#E7E6E6",borderBottom:e,borderTop:e}]},{cells:[{value:"Question Number",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0},{value:"Topic",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0},{value:"% Students answered correctly",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0}],height:40}],v=0;v<maxChoiceCount;v++)h[h.length-1].cells.push({value:"Option "+fetchCrctAnsOption(v)+" (%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0});h[h.length-1].cells.push({value:"No Answer (%)",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e,borderRight:e,bold:!0}),h[h.length-1].cells.push({value:"Correct Answer",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0});var I=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:t[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:a[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:o[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{value:"Question Results",borderBottom:e,borderTop:e,colspan:p,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"}]},{cells:[{value:"Last Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"First Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}],S=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:t[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:a[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:o[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{value:"Question Results",borderBottom:e,borderTop:e,colspan:p,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"}]},{cells:[{value:"Last Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"First Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}];m.fetch(function(){for(var t=cqClassXlReport,a=0;a<t.length;a++){if(h.push({cells:[{value:parseInt(t[a].ordinalNumber),hAlign:"center"},{value:$("#questionCollapese"+t[a].questionIdentifier).attr("subtitle"),hAlign:"left"},{value:roundToOne(t[a].correctPercentage),hAlign:"center"}]}),t[a].choiceVOList)for(var o=0;o<maxChoiceCount;o++)t[a].choiceVOList[o]&&t[a].choiceVOList[o].userResponsePercentage?h[h.length-1].cells.push({value:roundToOne(t[a].choiceVOList[o].userResponsePercentage),hAlign:"center"}):h[h.length-1].cells.push({value:"0",hAlign:"center"});h[h.length-1].cells.push({value:roundToOne(t[a].unansweredPercentage),hAlign:"center"}),h[h.length-1].cells.push({value:fetchCrctAnsCQ(t[a].choiceVOList),hAlign:"center"})}for(var r=1;r<=p;r++)I[9].cells.push({value:r,hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e});for(var s=0;s<c.length;s++)if(I.push({cells:[{value:c[s].lastName,hAlign:"center"},{value:c[s].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[s].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[s].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}),p>0)for(o=0;o<c[s].questionLevelScore.length;o++)I[I.length-1].cells.push(checkCrct(c[s].questionLevelScore[o].correct));for(var n=1;n<=p;n++)S[9].cells.push({value:n,hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e});for(var d=0;d<c.length;d++)if(S.push({cells:[{value:c[d].lastName,hAlign:"center"},{value:c[d].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[d].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[d].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}),p>0)for(var l=0;l<c[d].questionLevelScore.length;l++)S[S.length-1].cells.push(checkCrct(c[d].questionLevelScore[l].correct,!0,c[d].questionLevelScore[l].choiceIndex));var u=new kendo.ooxml.Workbook({sheets:[{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Class",rows:h},{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Student_Summary",rows:I},{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Student_Details",rows:S}]});kendo.saveAs({dataURI:u.toDataURL(),fileName:localStorage.getItem("lastName")+"_"+localStorage.getItem("classCode")+"_"+i+"_"+g+".xlsx"})})}function checkChoiceColor(e){if(e){var t=e.toString().split(".")[1];if(1===t.length&&"0"===t)var a=e.toString().split(".")[0];else a=parseFloat(e).toFixed(1);return 0==parseFloat(a)?{value:parseFloat(e),hAlign:"center"}:parseFloat(a)>=50?{value:parseFloat(a),hAlign:"center",background:"#C6EFCE",color:"#006100"}:{value:parseFloat(a),hAlign:"center",background:"#FFCCCC",color:"#9C0006"}}return""}function dateXlFormat(e){return e.split(" ")[0].split("-")[1]+"/"+e.split(" ")[0].split("-")[2]+"/"+e.split(" ")[0].split("-")[0]+" "+e.split(" ")[1].split("/")+" "+e.split(" ")[2].split("/")+" "+e.split(" ")[3].split("/")}function cancelEditDate(){$(".editDateContainer").hide(),$(".hideWhileEdit").show()}function reAssignQuiz(e){var t=$(e.currentTarget).attr("quizId"),a=$(e.currentTarget).attr("classId"),o=$(e.currentTarget).attr("estTime"),i=$(e.currentTarget).attr("startTime"),r=$(e.currentTarget).attr("publishResultInstantlyFlag"),s=$(".btn-sec").attr("id"),n=$("#"+t).attr("quiz-identifier"),d=$(".semester-drpdwn").val();$("#page-loading-spinner").show();var l={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:n,cqClassId:a,qpProductId:s,lastViewedCQSemesterId:d},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:t,assigned:!0,publishResultInstantlyFlag:r,quizEndDate:o,quizStartDate:i},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/updateAssignedQuizDate",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(l)}).then(function(e){if($("#page-loading-spinner").hide(),"true"===e.status){$("#myModalAssignPopup").modal("hide");var a=dateFormatConversion(i),s=dateFormatConversion(o);$("#"+t).attr("quizstartdate",convertStartTimeFunc(a)),$("#"+t).attr("quizenddate",convertStartTimeFunc(s)),$("#"+t).attr("publishResultInstantlyFlag",r),$("#"+t).parent().find(".dueDate").remove(),$("#"+t).parent().find(".startDate").remove();var n=compareTimeWithLocal(s),d=compareTimeWithLocal(a),l="Due: "+convetTimeESTAppend(s),c="Due: "+convetTimeESTAppend(a);checkQuiz(t,n,d,c,l,null,null,!0),$("#"+t).after('<div class="dueDate" style="display:none">'+l+"</div>"),$("#"+t).after('<div class="startDate" style="display:none">'+c+"</div>");var p=$(".completedBtnGroup .completedBtn").html();p.length>0&&(p=p.replace("Completed","In Progress"),$(".completedBtnGroup .completedBtn").html(p),$(".completedBtnGroup").css("background","#A6D1EB"),localStorage.setItem("progresString",p)),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML)}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function dateFormatConversion(e){var t="",a=e.split(" "),o=a[0].split("-");t=o[2]+"-"+o[0]+"-"+o[1]+" ";var i=a[1].split(":"),r=i[0],s=i[1];return"PM"==a[a.length-1]?(12==r||(r=parseInt(r)+12),24==r&&(r=0)):12==r&&(r="00"),t+(r+":")+s+":00.0"}function convertStartTimeFunc(e){var a=moment.tz(e,"America/New_York");t=a.clone().tz(moment.tz.guess());var o,i,r=a.clone().tz(moment.tz.guess()).format("z"),s=t.format().split("T"),n=s[1].split(":");(t=s[0],null!=n&&null!=n)?(n[0]>12?(meridian="PM",(o=n[0]-12)<10&&(o="0"+o),i=n[1]):"12"==n[0]?(meridian="PM",o="12",i=n[1]):(meridian="AM",o="00"==n[0]?"12":n[0],i=n[1]),t=t+" "+o+":"+i+" "+meridian+" "+r):t+=" ";return t}function convetTimeESTAppend(e){var t,a,o=moment.tz(e,"America/New_York"),i=o.clone().tz(moment.tz.guess()),r=o.clone().tz(moment.tz.guess()).format("z"),s=i.format().split("T"),n=s[1].split(":");(i=dateModification(s[0]),null!=n&&null!=n)?(n[0]>12?(meridian="PM",t=n[0]-12,a=n[1]):"12"==n[0]?(meridian="PM",t="12",a=n[1]):(meridian="AM",a=n[1],t="00"==n[0]?"12":n[0]),i=i+' <span class="timeShowLoc"> at '+t+":"+a+" "+meridian+" "+r+"</span>"):i+=" ";return i}function checkQuiz(e,t,a,o,i,r,s,n){var d=(i=i.split("at"))[0].split(":")[1],l=i[1],c=(o=o.split("at"))[0].split(":")[1],p=o[1];a>0?($("#"+e).removeClass("unassigned"),$("#"+e).removeClass("assigned"),$("#"+e).removeClass("completed"),$("#"+e).addClass("futureAssign"),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Starts: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+d+" at "+l),null!=s&&null!=r&&(n="In Progress: "+s+"/"+r+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#A6D1EB")),"cancelQuiz"!=$(".btn-sec button")[0].id&&$("#"+e).before('<button id="cancelQuiz" class="btn btn-md btn-primary cq-prof-result-btn cancel ellipsis" onclick="cancelQuiz(event)">Cancel Quiz</button>'),$("#"+e).html("Edit Assignment Details"),$("#endQuizBtnStart").remove()):a<=0&&t>0?($("#"+e).removeClass("unassigned"),$("#"+e).addClass("assigned"),$("#"+e).removeClass("completed"),$("#"+e).removeClass("futureAssign"),null!=s&&null!=r&&(n="In Progress: "+s+"/"+r+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#A6D1EB")),"endQuizBtnStart"!=$(".btn-sec button")[0].id&&$("#"+e).before('<button id="endQuizBtnStart" class="btn btn-md btn-primary cq-prof-result-btn end-quiz ellipsis" onclick="endQuizPopover('+e+')">End Quiz</button>'),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+d+" at "+l),$("#"+e).html("Edit Assignment Details"),$("#cancelQuiz").remove()):t<0&&($("#"+e).removeClass("unassigned"),$("#"+e).removeClass("assigned"),$("#"+e).addClass("completed"),$("#"+e).removeClass("futureAssign"),null!=s&&null!=r&&(n="Completed: "+s+"/"+r+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#dadada")),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+d+" at "+l),$("#"+e).html("Reopen Quiz"),$("#endQuizBtnStart").remove(),$("#cancelQuiz").remove()),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("progresString",$(".completedBtnGroup .completedBtn").html()),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").show()}function captchaLoginVerify(){$("#recaptchaLogin").next(".error-label").remove();var e=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show();var t={};t.url=properties[properties.env]+"/manageUserService/userAuthentication";var a=$("#login_email").val().trim(),o=$("#login_password").val().trim();t.data={email:a,password:o,responseCaptcha:e},Handler.login.request(t),t.method="POST",t.handler=Handler.login,Utility.fireRequest(t)}function captchaRegisterVerify(){$("#recaptchaLogin").next(".error-label").remove();var e=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show();var t={};t.url=properties[properties.env]+"/manageUserService/userOneStepRegistration";var a=$("#reg_firstName").val().trim(),o=$("#reg_lastName").val().trim(),i=$("#reg_email").val().trim(),r=$("#reg_confirmEmail").val().trim(),s=$("#reg_password").val().trim(),n=$("#reg_confirmPassword").val().trim(),d=$("#user-country-name").val().trim(),l=$("#user-school-location").val().trim(),c=$("#user-school-name").val().trim();t.data={firstName:a,lastName:o,email:i,confirmEmail:r,password:s,confirmPassword:n,country:d,schoolLocation:l,schoolName:c,responseCaptcha:e},Handler.createAccount.request(t),t.method="POST",t.handler=Handler.createAccount,Utility.fireRequest(t)}function ppLandingpage(e){var t="";if(null!=e&&null!=e&&(localStorage.setItem("eulaValidationCheck",e.currentTarget.getAttribute("eulaFlag")),t=$(e.currentTarget).attr("bookid")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),e)var a=e.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(a).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"})}insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open"),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){getPPTopicsBySATagId(t);var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").show(),$(".searchInput").val(""),getFeaturedVideo(),getRecentlyWatchedVideo()})}function vidChange(){"interactive"==$("#ppVideoFormat").val()?localStorage.getItem("interactiveVideoPath")?$("#videoPlayed iframe").attr("src",localStorage.getItem("interactiveVideoPath")):alertMessageContent("It doesnt have a interactive video"):localStorage.getItem("continuousVideoPath")?$("#videoPlayed iframe").attr("src",localStorage.getItem("continuousVideoPath")):alertMessageContent("It doesnt have a continuous video")}function searchPP(e){var t=!1,a=JSON.parse(localStorage.getItem("ppProductVo")),o=(localStorage.getItem("schoolId"),$(".searchInput").val().trim());if(e?(13!=e.keyCode&&"touchstart"!==e.type&&"click"!==e.type||(t=!0),localStorage.setItem("ppSearch",o)):t=!0,t)if(-1===stopWords.indexOf(o)){$(".no-search").remove(),$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_SEARCH_RESULTS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,lastSearchKeyword:o},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,ppProductVO:{searchKeyword:o}};$.ajax({url:properties[properties.env]+"/managePP/searchPPVideos",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,$("#ppLanding-top").hide(),$(".allVideosText").html("Search Results"),e.ppTopicVOList){var t=e.ppTopicVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].ppSubTopicVOList)&&(t[a].ppSubTopicVOList=[t[a].ppSubTopicVOList]);$("#subVideoSection").show(),$("#btnContainer").show();var o=Handlebars.getTemplate("pp-video-resluts")(e);$("#subVideoSection").html(o),$(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".videosGroupContainer").show()}else $(".videosGroupContainer").show(),$("#subVideoSection").hide(),$("#btnContainer").hide(),$(".vidSectionContainer").after('<div class="no-search col-lg-12 col-md-12 col-xs-12 no-padding"><div class="error-msg pp-secSub-name col-lg-12 col-md-12 col-xs-12 no-padding">There are no videos that match your search.</div><a href="#/" onclick="ppLandingpage()">Back to Video Library</a><div class="display-inline-block col-lg-12 col-md-12 col-xs-12 no-padding pp-borderLine"></div></div>');$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}else alertMessagesModal(exceptionMsg.enterValidSearch)}function getAllVideoTracker(e){var t=$("#ppVideoFormat").val(),a=JSON.parse(localStorage.getItem("ppProductVo"));localStorage.getItem("schoolId");$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_LANDING_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,ppSubTopicTagId:e},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,ppSubTopicVO:{subTopictagId:e,modeType:t}};$.ajax({url:properties[properties.env]+"/managePP/getPPVideoTracker",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"==e.status){var t,a,o,i;if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVO)e.ppSubTopicVO.continuousVideoPath?(o=e.ppSubTopicVO.continuousVideoPath,localStorage.setItem("continuousVideoPath",o)):o=null,e.ppSubTopicVO.interactiveVideoPath?(i=e.ppSubTopicVO.interactiveVideoPath,localStorage.setItem("interactiveVideoPath",i)):i=null,t=e.ppSubTopicVO.subTopictagId,a=e.ppSubTopicVO.totalQuestions?e.ppSubTopicVO.totalQuestions:void 0,map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var r=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+r),$(".pp-holder-name .subjectAreaName").html(r),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("pp-videoPage.html?v25",function(){e.ppSubTopicVO.modeType?"interactive"==e.ppSubTopicVO.modeType?null==i||null==i?($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()):($("#videoPlayed iframe").attr("src",i),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),null!=i&&null!=i||($("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove())):i?($("#videoPlayed iframe").attr("src",i),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()),e.ppSubTopicVO.customerFacingSubTopicName&&($(".userClassNameStyles").html(e.ppSubTopicVO.customerFacingSubTopicName),$(".userClassNameStyles").attr("subTopictagId",e.ppSubTopicVO.subTopictagId)),a?($("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+t+'","'+a+'")'),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t+'","'+a+'")')):$(".vidSecContiner").html('<div class="display-inline-block col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"><div class="display-inline-block no-quiz">There is no quiz for this video.</div></div>'),$(".practiceResultLink").hide(),$(".gradedResultLink").hide();var r=localStorage.getItem("ppProductTitle");if($(".ereader-main-header-title").html("PracticePerfect: "+r),$("#pp-container-hide").show(),$(".no-search").remove(),e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]);for(var s=0;s<e.ppQuizResultVOList.length;s++)"true"==e.ppQuizResultVOList[s].isGraded?"true"==e.ppQuizResultVOList[s].isCompleted?($(".gradedResultLink").show(),$(".gradedResultLink").attr("instanceid",e.ppQuizResultVOList[s].instanceId),$(".gradedResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#gradedMode").attr("evtClick",'createInstanceforPPQuiz("'+e.ppQuizResultVOList[s].quizIdentifier+'","video",true,"'+t+'","'+a+'",300)'),$("#gradedMode").attr("onclick","retakeQuizFun(event)"),$("#gradedMode").html("Retake Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn")):($(".gradedResultLink").hide(),e.ppQuizResultVOList[s].instanceURL?($("#gradedMode").html("Continue Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn"),$("#gradedMode").attr("onclick",'showQuizFrame("'+e.ppQuizResultVOList[s].instanceURL+'","pp","video","'+t+'",event)'),$("#gradedMode").attr("instanceId",e.ppQuizResultVOList[s].instanceId)):($("#gradedMode").html("Graded Mode"),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t+'","'+a+'")'))):"true"==e.ppQuizResultVOList[s].isCompleted?($(".practiceResultLink").show(),$(".practiceResultLink").attr("instanceid",e.ppQuizResultVOList[s].instanceId),$(".practiceResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#practiceMode").attr("evtClick",'createInstanceforPPQuiz("'+e.ppQuizResultVOList[s].quizIdentifier+'","video",false,"'+t+'","'+a+'",300)'),$("#practiceMode").attr("onclick","retakeQuizFun(event)"),$("#practiceMode").html("Retake Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn")):($(".practiceResultLink").hide(),e.ppQuizResultVOList[s].instanceURL?($("#practiceMode").html("Continue Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn"),$("#practiceMode").attr("onclick",'showQuizFrame("'+e.ppQuizResultVOList[s].instanceURL+'","pp","video","'+t+'",event)'),$("#practiceMode").attr("instanceId",e.ppQuizResultVOList[s].instanceId)):($("#practiceMode").html("Practice Mode"),$("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+t+'","'+a+'")')))}e.ppSubTopicVO.continuousTimeSpent?localStorage.setItem("resumePlayContinuous",e.ppSubTopicVO.continuousTimeSpent):localStorage.setItem("resumePlayContinuous",0),e.ppSubTopicVO.interactiveTimeSpent?localStorage.setItem("resumePlayInteractive",e.ppSubTopicVO.interactiveTimeSpent):localStorage.setItem("resumePlayInteractive",0),$(window).trigger("resize")})});$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function checkList(e,t,a){if(0==e)return!0;var o=$("#ppVideoFormat").val(),i=e/t*100,r=localStorage.getItem("schoolId"),s=JSON.parse(localStorage.getItem("ppProductVo")),n={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:r,ppSubjectAreaTagId:s[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:s[0].ppSubjectAreaTagId,ppSubTopicVO:{subTopictagId:a,timeSpent:e,modeType:o,completionProgress:parseInt(i)}};$.ajax({url:properties[properties.env]+"/managePP/updatePPVideoTimeTracker",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(n)}).then(function(e){var t,o;"true"==e.status&&(localStorage.setItem("latestSubTopicID",a),localStorage.setItem("percentileVal",parseInt(i)),$(".redbar-"+a+" .vidProgressCalc span").css("width",parseInt(i)+"%"),$(".redbar-"+a+" .vidProgCalc-list").css("stroke-dasharray",parseInt(i)+",999"),e.ppSubTopicVO&&(e.ppSubTopicVO.continuousVideoPath?(t=e.ppSubTopicVO.continuousVideoPath,localStorage.setItem("continuousVideoPath",t)):t=null,e.ppSubTopicVO.interactiveVideoPath?(o=e.ppSubTopicVO.interactiveVideoPath,localStorage.setItem("interactiveVideoPath",o)):o=null))},function(e){})}function progressbarLoading(e){closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");var t=localStorage.getItem("firstName");$("#video").hide(),$("#video").addClass("remove"),$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId"));var a=document.getElementById("video");$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){$("#pp-container-hide").after(a),$(".userClassNameStyles").html(t+"'s progress"),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),e?"videoQuiz"==e?getVideoQuizProgress():getQuizCenterProgress():getTopicsForConfidencePage()})}function updateExpandBtn(e){$(e);"Expand"==$(e).html()?$(e).html("Collapse"):$(e).html("Expand")}function expandAllPPProgress(e){e?($(".progress-bar-container.collapse").addClass("in"),$(".progress-bar-container.collapse").css("height","auto"),$(".pp-progresbar-expandBtn").html("Collapse")):($(".progress-bar-container.collapse").removeClass("in"),$(".progress-bar-container.collapse").css("height","0px"),$(".pp-progresbar-expandBtn").html("Expand"))}function expandAllPPresSum(e){e?($(".answersFieldSection.collapse").addClass("in"),$(".answersFieldSection.collapse").css("height","auto"),$(".ppQuizAttemptedQuestion").html("Collapse")):($(".answersFieldSection.collapse").removeClass("in"),$(".answersFieldSection.collapse").css("height","0px"),$(".ppQuizAttemptedQuestion").html("Expand"))}function getprogressbarTemplate(){var e=$("#ppVideoFormat").val();"1"==e?getTopicsForConfidencePage():"2"==e?getQuizCenterProgress():getVideoQuizProgress()}function getTopicsForConfidencePage(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_CONFIDENCE_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getTopicsForConfidencePage",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppTopicVOList){"object"==$.type(e.ppTopicVOList)&&(e.ppTopicVOList=[e.ppTopicVOList]);for(var t=0;t<e.ppTopicVOList.length;t++)e.ppTopicVOList[t].ppSubTopicVOList&&"object"==$.type(e.ppTopicVOList[t].ppSubTopicVOList)&&(e.ppTopicVOList[t].ppSubTopicVOList=[e.ppTopicVOList[t].ppSubTopicVOList]);var a=Handlebars.getTemplate("confidenceDashboard")(e);$("#practicePerfect-progressContainer").html(a);var o=localStorage.getItem("firstName");$(".userClassNameStyles").html(o+"'s progress");var i=localStorage.getItem("ppProductTitle");$(".pp-confidenceLevelTitle .subjectAreaName").html(i),$("#view-more-parent").hide(),$("#ppVideoFormat").val(1),getConfidenceLevel(),lateScore(),$("#page-loading-spinner").hide()}else{a=Handlebars.getTemplate("confidenceDashboard")(e);$("#practicePerfect-progressContainer").html(a);o=localStorage.getItem("firstName");$(".userClassNameStyles").html(o+"'s progress");i=localStorage.getItem("ppProductTitle");$(".pp-confidenceLevelTitle .subjectAreaName").html(i),getConfidenceLevel()}$(window).trigger("resize")}$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getConfidenceLevel(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_CONFIDENCE_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getConfidenceLevel",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status)if(e.ppConfidenceLevel){var t=142-142*Math.round(e.ppConfidenceLevel)/100;$(".confidenceChartProgress").css("stroke-dashoffset",t),$(".confidenceProgressPerc span").html(e.ppConfidenceLevel+"%"),$("#page-loading-spinner").hide()}else $(".confidenceChartProgress").css("stroke-dashoffset",142),$(".confidenceProgressPerc span").html("0%");$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getQuizCenterProgress(e){$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");var t=localStorage.getItem("schoolId"),a=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PROGRESS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:a[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,ppQuizResultVO:{perPage:5,page:e}};o.ppQuizResultVO.page=null!=e&&null!=e?e:"1",$.ajax({url:properties[properties.env]+"/managePP/getQuizCenterProgress",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(t){if("true"==t.status)if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,t.ppQuizResultVOList){"object"==$.type(t.ppQuizResultVOList)&&(t.ppQuizResultVOList=[t.ppQuizResultVOList]);for(var a=0;a<t.ppQuizResultVOList.length;a++)t.ppQuizResultVOList[a].ppSubTopicVOList&&"object"==$.type(t.ppQuizResultVOList[a].ppSubTopicVOList)&&(t.ppQuizResultVOList[a].ppSubTopicVOList=[t.ppQuizResultVOList[a].ppSubTopicVOList]);var o=Handlebars.getTemplate("quizCenterProgress")(t);if(null!=e&&null!=e)$("#practicePerfect-progressContainer").append(o);else{$("#practicePerfect-progressContainer").html(o),$("#hide-page-concept").html('<div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"><div class="practice-perfect-message">Your progress on all quizzes built in the Quiz Center</div><div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"></div></div><div class=" col-xs-4 col-md-4 col-sm-4 col-lg-4 no-padding pp-expandCollapseGroup pull-right"><a href="#/" onclick="expandAllPPProgress(true)"><span class="pp-expandAll" >Expand All</span></a> <span class="pp-pipeLine">|</span> <a href="#/" onclick="expandAllPPProgress(false)"><span class="pp-collapseAll">Collapse All</span></a></div>')}var i=localStorage.getItem("firstName");$(".userClassNameStyles").html(i+"'s progress"),$("#ppVideoFormat").val(2),$("#page-loading-spinner").hide(),parseInt(t.totalPages)>1?(null!=e&&null!=e||(e="1"),parseInt(e)<parseInt(t.totalPages)?($("#view-more-parent").show(),$("#view-more-parent button").attr("onclick","getQuizCenterProgress("+(parseInt(e)+1)+")")):$("#view-more-parent").hide()):$("#view-more-parent").hide(),$(window).trigger("resize")}else{i=localStorage.getItem("firstName");$(".userClassNameStyles").html(i+"'s progress"),$("#practicePerfect-progressContainer").html('You havent built any quizzes. Visit the <a href="#/" onclick="quizPage()">Quiz Center</a> to get started.'),$("#view-more-parent").hide(),$(".container-left-desktop-fix-pp").css("overflow","unset"),$("#ppVideoFormat").val(2),$(window).trigger("resize")}$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getVideoQuizProgress(e){$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");var t=JSON.parse(localStorage.getItem("ppProductVo")),a=localStorage.getItem("schoolId");$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_QUIZ_PROGRESS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getVideoQuizProgress",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){"true"===e.status&&(e.ppQuizResultVOList?("object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var t=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+t),$(".pp-holder-name .subjectAreaName").html(t),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var t=localStorage.getItem("firstName");$(".userClassNameStyles").html(t+"'s progress");var a=Handlebars.getTemplate("videoQuizProgress")(e);$("#practicePerfect-progressContainer").html(a),$("#view-more-parent").hide(),$("#ppVideoFormat").val(3),$(window).trigger("resize")})}),$("#page-loading-spinner").hide()):map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var e=localStorage.getItem("firstName");$(".userClassNameStyles").html(e+"'s progress"),$("#practicePerfect-progressContainer").html("There is no progress to see in your Video Quiz Progress"),$("#ppVideoFormat").val(3)})})),$(window).trigger("resize"),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function lateScore(){for(var e=$(".late-score"),t=0;t<e.length;t++){var a=$(e[t]).attr("data-parent");$("#"+a).removeClass("confi-progressBar").addClass("gradient-progressBar")}}function getFeaturedVideo(e){var t=localStorage.getItem("schoolId"),a=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:a[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:a[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getFeaturedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVO){var t=e.ppSubTopicVO;$("#featuredVideo").addClass("redbar-"+t.subTopictagId),$("#featuredVideo").attr("onclick","getAllVideoTracker('"+t.subTopictagId+"')"),$(".featuredVideoGroup .featured-video-title").html(t.customerFacingSubTopicName),$(".featuredVideoGroup .featured-video-title").attr("onclick","getAllVideoTracker('"+t.subTopictagId+"')"),$(".featuredVideoGroup #featuredVideo img.hidden-xs").attr("src",t.continuousPreviewPath),$(".featuredVideoGroup #featuredVideo img.visible-xs").attr("src",t.continuousThumbnailPath),t.totalQuestions&&(t.instanceId?t.incompleteQuizInstanceURL?($(".featuredVideoGroup .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t.incompleteQuizInstanceURL+'","pp","video","'+t.subTopictagId+'",event)'),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("instanceId",t.incompleteQuizInstanceId)):($(".featuredVideoGroup .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t.gradedQuizIdentifier+"','video',true,'"+t.subTopictagId+"',15,300)"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".featuredVideoGroup .take-review-quiz #reviewQuiz").attr("instanceid",t.instanceId),$(".featuredVideoGroup .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t.incompleteQuizInstanceURL?($(".featuredVideoGroup .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t.incompleteQuizInstanceURL+'","pp","video","'+t.subTopictagId+'",event)'),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("instanceId",t.incompleteQuizInstanceId)):($(".featuredVideoGroup .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t.subTopictagId+'","'+t.totalQuestions+'")'))),t.videoCompletionProgress?$("#featuredVideo .video-progressBar span").css("width",t.videoCompletionProgress+"%"):$("#featuredVideo .video-progressBar span").css("width","0%")}$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide(),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function getRecentlyWatchedVideo(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo")),a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getRecentlyWatchedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if($(".errormsg-empty").remove(),"true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVOList){var t=e.ppSubTopicVOList;"object"==$.type(t)&&(t=[t]),t.length>0&&(t[0]?($(".recentWatched1").show(),$(".recentWatched1").addClass("redbar-"+t[0].subTopictagId),$(".recentWatched1 .video-title").html(t[0].customerFacingSubTopicName),$(".recentWatched1 .video-title").attr("onclick","getAllVideoTracker('"+t[0].subTopictagId+"')"),$(".recentWatched1 img").attr("src",t[0].continuousThumbnailPath),$(".recentWatched1 .recently-watched").attr("onclick","getAllVideoTracker('"+t[0].subTopictagId+"')"),t[0].totalQuestions&&(t[0].instanceId?t[0].incompleteQuizInstanceURL?($(".recentWatched1 .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t[0].incompleteQuizInstanceURL+'","pp","video","'+t[0].subTopictagId+'",event)'),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("instanceId",t[0].incompleteQuizInstanceId)):($(".recentWatched1 .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t[0].gradedQuizIdentifier+"','video',true,'"+t[0].subTopictagId+"','"+t[0].totalQuestions+"',300)"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".recentWatched1 .take-review-quiz #reviewQuiz").attr("instanceid",t[0].instanceId),$(".recentWatched1 .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t[0].incompleteQuizInstanceURL?($(".recentWatched1 .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t[0].incompleteQuizInstanceURL+'","pp","video","'+t[0].subTopictagId+'",event)'),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("instanceId",t[0].incompleteQuizInstanceId)):($(".recentWatched1 .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t[0].subTopictagId+'","'+t[0].totalQuestions+'")'))),t[0].videoCompletionProgress?$(".recentWatched1 .recentlyWatchedVideo-progressBar span").css("width",t[0].videoCompletionProgress+"%"):$(".recentWatched1 .recentlyWatchedVideo-progressBar span").css("width","0%")):$(".recentWatched1").hide(),t[1]?($(".recentWatched2").show(),$(".recentWatched2").addClass("redbar-"+t[1].subTopictagId),$(".recentWatched2 .video-title").html(t[1].customerFacingSubTopicName),$(".recentWatched2 .video-title").attr("onclick","getAllVideoTracker('"+t[1].subTopictagId+"')"),$(".recentWatched2 img").attr("src",t[1].continuousThumbnailPath),$(".recentWatched2 .recently-watched").attr("onclick","getAllVideoTracker('"+t[1].subTopictagId+"')"),t[1].totalQuestions&&(t[1].instanceId?t[1].incompleteQuizInstanceURL?($(".recentWatched2 .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t[1].incompleteQuizInstanceURL+'","pp","video","'+t[1].subTopictagId+'",event)'),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("instanceId",t[1].incompleteQuizInstanceId)):($(".recentWatched2 .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t[1].gradedQuizIdentifier+"','video',true,'"+t[1].subTopictagId+"','"+t[1].totalQuestions+"',300)"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".recentWatched2 .take-review-quiz #reviewQuiz").attr("instanceid",t[1].instanceId),$(".recentWatched2 .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t[1].incompleteQuizInstanceURL?($(".recentWatched2 .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t[1].incompleteQuizInstanceURL+'","pp","video","'+t[1].subTopictagId+'",event)'),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("instanceId",t[1].incompleteQuizInstanceId)):($(".recentWatched2 .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t[1].subTopictagId+'","'+t[1].totalQuestions+'")'))),t[1].videoCompletionProgress?$(".recentWatched2 .recentlyWatchedVideo-progressBar span").css("width",t[1].videoCompletionProgress+"%"):$(".recentWatched2 .recentlyWatchedVideo-progressBar span").css("width","0%")):$(".recentWatched2").hide()),$("#recenthide").show()}else $("#recenthide").show(),$(".recentWatched2").hide(),$(".recentWatched1").hide(),$(".recently-watched-section").append("<div class='errormsg-empty display-inline-block col-lg-12 col-md-12 col-sm-4 col-xs-6' style='margin-top: 21px'>You havent watched any videos yet.</div>");$("#page-loading-spinner").hide()}else $("#recenthide").hide(),$("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getPPTopicsBySATagId(e){var t=localStorage.getItem("schoolId"),a=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:a[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:a[0].ppSubjectAreaTagId,ppProductVO:{productId:e}};$.ajax({url:properties[properties.env]+"/managePP/getPPTopicsBySATagId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppTopicVOList){var t=e.ppTopicVOList;"object"==$.type(t)&&(t=[t]),localStorage.setItem("ppTopicVOList",JSON.stringify(t));for(var a=0;a<t.length;a++)"object"==$.type(t[a].ppSubTopicVOList)&&(t[a].ppSubTopicVOList=[t[a].ppSubTopicVOList]);var o=Handlebars.getTemplate("pp-video-resluts")(e);$("#subVideoSection").html(o);var i=localStorage.getItem("latestSubTopicID"),r=localStorage.getItem("percentileVal");null!=i&&null!=i&&null!=r&&null!=r&&($(".redbar-"+i+" .vidProgressCalc span").css("width",r+"%"),$(".redbar-"+i+" .vidProgCalc-list").css("stroke-dasharray",r+",999"),localStorage.removeItem("latestSubTopicID"),localStorage.removeItem("percentileVal")),$(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".videosGroupContainer").show()}else $(".videosGroupContainer").hide(),localStorage.removeItem("ppTopicVOList");$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function selectViewDet(e){"grid-view"==e?($(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".thumbnail-View").show(),$(".pp-list-view").hide()):($(".list-view").css("border-bottom","1px solid #007AC3"),$(".grid-view").css("border-bottom",""),$(".thumbnail-View").hide(),$(".pp-list-view").show()),$(window).trigger("resize")}function getResultSummaryByInstanceId(e,t){$(e.currentTarget).attr("quizType"),$(e.currentTarget).attr("topicName"),$(e.currentTarget).html();var a=$(e.currentTarget).attr("instanceId"),o=localStorage.getItem("schoolId"),i=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var r={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:o,ppSubjectAreaTagId:i[0].ppSubjectAreaTagId,instanceId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppQuizResultVO:{instanceId:a}};$.ajax({url:properties[properties.env]+"/managePP/getResultSummaryByInstanceId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(r)}).then(function(e){if("true"===e.status){if(e.ppQuizResultVO){var a=e.ppQuizResultVO;"object"==$.type(a)&&(a=[a]);for(var o=0;o<a.length;o++)a[o].QPQuestionVOList&&"object"==$.type(a[o].QPQuestionVOList)&&(a[o].QPQuestionVOList=[a[o].QPQuestionVOList]);$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var o=Handlebars.getTemplate("progress-dashboardpage")(a);$("#practicePerfect-progressContainer").html(o),$("#view-more-parent").hide(),$("#practicePerfect-progressContainer").show(),$("#child-progress-container").hide();for(var i=0;i<a[0].QPQuestionVOList.length;i++){var r=a[0].QPQuestionVOList[i].questionIdentifier;if("false"==a[0].QPQuestionVOList[i].correct){var s="";if(a[0].QPQuestionVOList[i].choiceId){s=a[0].QPQuestionVOList[i].choiceId,$("#question"+r+" #"+s).removeClass("result-block").addClass("result-blockRemove");var n=$("#question"+r+" #"+s).html();$("#question"+r+" #"+s).html('<span class=" ppTickposition glyphicon glyphicon-remove"></span>'+n),$("#question"+r+" #"+s+" .ppindex").addClass("ppglyp")}}}if("video"==t?($(".backToVideoBtn").attr("onclick","getAllVideoTracker('"+a[0].ppSubTopicVO.subTopictagId+"')"),$(".backToVideoBtn").html("Back to Video"),$(".retakeBtnGroup").show(),$(".backRetakeGroup").css("float","left"),$(".yesRetakeBtn").attr("onclick","createInstanceforPPQuiz('"+a[0].quizIdentifier+"','video',true,'"+a[0].ppSubTopicVO.subTopictagId+"','"+a[0].ppSubTopicVO.totalQuestions+"',300)"),$(".retakeBtnGroup").show()):($(".backToVideoBtn").attr("onclick","quizPage()"),$(".backToVideoBtn").html("Back to Quiz Center"),$(".retakeBtnGroup").hide(),$(".backRetakeGroup").css("float","right")),e.ppVideoQuizResultVOList){"object"==$.type(e.ppVideoQuizResultVOList)&&(e.ppVideoQuizResultVOList=[e.ppVideoQuizResultVOList]);var d=$(".retakeBtnGroup button").attr("subtopictagid"),l=$(".retakeBtnGroup button").attr("totalquestions");for(i=0;i<e.ppVideoQuizResultVOList.length;i++)"true"==e.ppVideoQuizResultVOList[i].isGraded?"true"==e.ppVideoQuizResultVOList[i].isCompleted?($(".retakeBtnGroup button").html("Retake Graded Quiz"),$(".retakeBtnGroup button").attr("evtClick","createInstanceforPPQuiz('"+e.ppVideoQuizResultVOList[i].quizIdentifier+"','video',true,'"+d+"',"+l+",300)"),$(".retakeBtnGroup button").attr("onclick","retakeQuizFun(event)")):e.ppVideoQuizResultVOList[i].instanceURL?($(".retakeBtnGroup button").html("Continue Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","showQuizFrame('"+e.ppVideoQuizResultVOList[i].instanceURL+"','pp','video','"+d+"',event)"),$(".retakeBtnGroup button").attr("instanceId",e.ppVideoQuizResultVOList[i].instanceId)):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+d+"',"+l+")")):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+d+"',"+l+")"))}}),$("#page-loading-spinner").hide()}}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}var aoiTopicVoList="";function quizPage(){closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open"),$("#video").hide(),$("#video").addClass("remove"),$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId"));var e=document.getElementById("video");map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var t=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+t),$(".pp-holder-name .subjectAreaName").html(t),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("area-of-improvement.html?v17",function(){$("#pp-container-hide").after(e),getAreaOfImprovementTagId(),getAllSummativeQuizzes(),getActiveQuizzes(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show()})})}function checkParent(e){for(var t=$(e.currentTarget).attr("parentId"),a=$("."+t+"-subtopic"),o=0,i=0;i<a.length;i++)a[i].checked&&o++;o==a.length?$("#"+t).prop("checked",!0):$("#"+t).prop("checked",!1),calcMaxQues()}function selectAllSubTopic(e){e.currentTarget.checked?$("."+e.currentTarget.id+"-subtopic").prop("checked",!0):$("."+e.currentTarget.id+"-subtopic").prop("checked",!1),calcMaxQues()}function selectAllTopics(e){$("#practicePerfect-buildYourOwnQuizContainer input:checkbox").prop("checked",e),calcMaxQues()}function calcMaxQues(){for(var e=$(".subTopTagId:checked"),t=0,a=0;a<e.length;a++)t+=parseInt($(e[a]).attr("totqu"));t<60?($("#maxQues").html(t),$("#maxQues-parent").show()):0==t?$("#maxQues-parent").hide():($("#maxQues").html("60"),$("#maxQues-parent").show())}function loadTopicsVOlist(){var e=JSON.parse(localStorage.getItem("ppProductVo")),t={lastActivityCode:"PP_BUILD_YOUR_OWN_QUIZ_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:e[0].ppSubjectAreaTagId};Utility.saveLastActivity(t);var a={ppTopicVOList:JSON.parse(localStorage.getItem("ppTopicVOList"))};$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Build Your Own Quiz");var e=Handlebars.getTemplate("build-your-ownQuiz")(a);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".hidden-quizzes-progress").hide(),$("#maxQues-parent").hide(),null!=a.ppTopicVOList&&null!=a.ppTopicVOList||$(".selectDeselectClassText").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Build Your Own Quiz','true')"),$("#pp-container-hide").show(),$(window).trigger("resize")})}function getAreaOfImprovementTagId(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo")),a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:e,userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getAreaOfImprovements",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if(e.ppTopicVOList){var t=e.ppTopicVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].ppSubTopicVOList)&&(t[a].ppSubTopicVOList=[t[a].ppSubTopicVOList]);aoiTopicVoList=t}else aoiTopicVoList="",$("#areahide").hide();$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function navQuizBuilding(e){var t=JSON.parse(localStorage.getItem("ppProductVo")),a=localStorage.getItem("schoolId"),o=$(e.currentTarget).attr("id"),i=$("."+o+"-subtopic"),r=$(e.currentTarget).attr("totalQuestions"),s=$(e.currentTarget).find(".quiz-title").text(),n={lastActivityCode:"PP_SUMMATIVE_LANDING_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId,qpQuizIdentifier:o};Utility.saveLastActivity(n);for(var d="",l=$(e.currentTarget).find(".topicList").html(),c=0;c<i.length;c++)c!=i.length-1?d+=i[c].getAttribute("subtopicid")+",":d+=i[c].getAttribute("subtopicid");$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizName").html(s+": "+l);var e=Handlebars.getTemplate("build-your-ownQuiz")("");$("#practicePerfect-buildYourOwnQuizContainer").html(e),$("#hideSummativeA").hide(),$("#practicePerfect-buildYourOwnQuizContainer").show(),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+s+"','true','"+d+"',"+r+")"),$("#maxQues-parent").show(),$("#maxQues").html(r),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+s+"','true','"+d+"',"+r+")"),$(window).trigger("resize")})}function getAllSummativeQuizzes(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo")),a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:e,userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getAllSummativeQuizzes",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if("true"==e.hasPreviouslyWatchedVideos?$("#hidepreviouswatched").show():$("#hidepreviouswatched").hide(),e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]);for(var t=0;t<e.ppQuizResultVOList.length;t++)"object"==$.type(e.ppQuizResultVOList[t].ppSubTopicVOList)&&(e.ppQuizResultVOList[t].ppSubTopicVOList=[e.ppQuizResultVOList[t].ppSubTopicVOList]);var a=Handlebars.getTemplate("getsummativequizzez")(e);$("#practicePerfect-getsummativequizzezContainer").html(a),$("#practicePerfect-getsummativequizzezContainer").show(),$("#practicePerfect-areaofimprovementContainer").hide(),$("#practicePerfect-summativeContainer").hide(),$("#practicePerfect-getsummativequizzezContainer").show()}$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getActiveQuizzes(){var e=localStorage.getItem("schoolId"),t=JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:t[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:t[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getActiveQuizzes",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status)if(e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]),$("#activeQuiz-parent").show();var t=Handlebars.getTemplate("getActiveQuiz")(e);$("#activeQuiz").html(t),$("#practicePerfect-getsummativequizzezContainer").show(),$("#practicePerfect-areaofimprovementContainer").hide(),$("#practicePerfect-summativeContainer").hide(),$("#practicePerfect-getsummativequizzezContainer").show(),$("#page-loading-spinner").hide()}else $("#activeQuiz-parent").hide();$(window).trigger("resize"),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function previouslyWatched(){var e=JSON.parse(localStorage.getItem("ppProductVo")),t=localStorage.getItem("schoolId"),a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_PREVIOUSLY_WATCHED_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:e[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:e[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/getPreviouslyWatchedVideos",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppTopicVOList){"object"==$.type(e.ppTopicVOList)&&(e.ppTopicVOList=[e.ppTopicVOList]);for(var t=0;t<e.ppTopicVOList.length;t++)e.ppTopicVOList[t].ppSubTopicVOList&&"object"==$.type(e.ppTopicVOList[t].ppSubTopicVOList)&&(e.ppTopicVOList[t].ppSubTopicVOList=[e.ppTopicVOList[t].ppSubTopicVOList]);$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Previously Watched");var t=Handlebars.getTemplate("build-your-ownQuiz")(e);$("#practicePerfect-buildYourOwnQuizContainer").html(t),$(".hidden-quizzes-progress").hide(),$(".selectDeselectClassText").hide(),$("#maxQues-parent").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Previously Watched','true')")})}$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function loadAreaImprovements(){var e=JSON.parse(localStorage.getItem("ppProductVo")),t={lastActivityCode:"PP_AREA_OF_IMPROVEMENT_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:e[0].ppSubjectAreaTagId};Utility.saveLastActivity(t);var a={ppTopicVOList:aoiTopicVoList};$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Area for Improvement");var e=Handlebars.getTemplate("build-your-ownQuiz")(a);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#maxQues-parent").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Areas for Improvement','true')"),$(window).trigger("resize")})}function getTypeVal(e,t){if("object"==$.type(t)&&(t=[t]),"Areas for Improvement"==e){for(var a="",o=0;o<t.length;o++)o!=t.length-1?a+=t[o].id+",":a+=t[o].id;return a}e="Build Your Own Quiz"==e||"Previously Watched"==e?"video":"Summative A"==e?"summativeA":"Summative B"==e?"summativeB":"video"==e?"video":"cumulative";for(o=0;o<t.length;o++)if(e==t[o].name)return t[o].id}function createidentifierforPPQuiz(e,t,a,o){var i=JSON.parse(localStorage.getItem("ppProductVo")),r=$("#qcErrorMessage"),s=300,n=!1,d=!1;if($("#qcErrorMessage").html(""),$("#ques-box").click(function(){$("#ques-box").prop("checked",!0),$("#qcErrorMessage").show(),$("#ques-max").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#ques-max").click(function(){$("#ques-max").prop("checked",!0),$("#qcErrorMessage").show(),$("#ques-box").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#time-box").click(function(){$("#time-box").prop("checked",!0),$("#qcErrorMessage").show(),$("#time-max").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#time-max").click(function(){$("#time-max").prop("checked",!0),$("#qcErrorMessage").show(),$("#time-box").prop("checked",!1)&&$("#qcErrorMessage").hide()}),"Areas for Improvement"==e&&(n=!0),"video"==e)o=parseInt(o),d=!1;else{if("Summative A"!=e&&"Summative B"!=e&&"Cumulative"!=e){var l=$(".subTopTagId:checked");if($("#qcErrorMessage").show(),r.html(""),r.css("color","red"),!(l.length>0))return r.html("Please select at least one topic."),!0;a="";for(var c=0;c<l.length;c++)c!=l.length-1?a+=l[c].id+",":a+=l[c].id}var p=$(".numberOfQuesSection input:radio:checked"),u=$(".timeLimitSection input:radio:checked");if($("#qcErrorMessage").show(),r.html(""),r.css("color","red"),!(p.length>0))return r.html("Please select the number of questions"),$("#qcErrorMessage").show(),!0;if("ques-box"==(p=p.attr("id"))){if(""==$(".ques-box").val()||"0"==$(".ques-box").val())return $("#qcErrorMessage").show(),r.html("Please enter a valid number of questions."),!0;if("ques-box"!==p)r.html("");else{if(parseInt($(".ques-box").val())>parseInt($("#maxQues").html()))return $("#qcErrorMessage").show(),r.html("Please enter a valid number of questions."),!0;o=parseInt($(".ques-box").val()),r.html("")}}else o=parseInt($("#maxQues").html()),r.html("");if(!(u.length>0))return r.html("Please select the time limit section"),$("#qcErrorMessage").show(),!0;if(r.html(""),"time-box"==(u=u.attr("id"))){if(""==$(".time-box").val()||"0"==$(".time-box").val())return r.html("Please enter a time limit."),$("#qcErrorMessage").show(),!0;if(parseInt($(".time-box").val())>300)return $("#qcErrorMessage").show(),r.html("Please enter a time limit between 1 and 300 minutes."),!0;s=parseInt($(".time-box").val()),r.html(""),d=!0,r.html("")}else s=300,r.html("")}var g={id:i[0].qpParentMetadataIdentifier,metadataAssoc:a,additionalMetadataAssoc:[{id:i[0].qpQuestionTypeIdentifier,metadataAssoc:getTypeVal(e,i[0].qpQuestionType)}],title:"offshoreTest"+map.userId+$.now(),clientUserId:map.userId,quizTime:s,testMode:t,numberOfQuestions:o,newQuestions:!1,gotWrong:n,randomizeAnswer:!1,quizType:"C",additionalTestModeSettings:{showTestTitle:!1,showItemTimeLimit:!1,showItemTimeSpent:!1,showTestTimeLimit:d,showTestTimeSpent:!0,showItems:!0,showCorrect:!1,showIncorrect:!1,showUnanswered:!1,showAnswer:!t},testSummaryDisplaySettings:{displayOption:3,predefinedText:"Your quiz was submitted successfully. To see how you did, check out your quiz results."},testSettings:{randomizeAnswer:!1,randomizeItem:!0,navigationType:2}};if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("PPIdentifierCreation",e,t,a,o),!0;var m="/api/tests?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+m,{method:"POST",body:JSON.stringify(g),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(i){i?(i.log_reference?alertMessagesModal(exceptionMsg.systemError):createInstanceforPPQuiz(i.testIdentifier,e,t,a,o,s),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function createInstanceforPPQuiz(e,t,a,o,i,r){if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("PPinstanceCreation",e,t,a,o,i,r),!0;var s="/api/tests/identifier/"+e+"/instances?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+s,{method:"POST",body:JSON.stringify({showAnswer:!a,externalContext:{productType:"pp"}}),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(s){s?(s.log_reference?alertMessagesModal(exceptionMsg.systemError):(postInstancePPUrlToCC(s,e,t,a,o,i,r),showQuizFrame(s,"pp",t,o)),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function postInstancePPUrlToCC(e,t,a,o,i,r,s){var n=JSON.parse(localStorage.getItem("ppProductVo")),d={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,qpQuizInstanceURL:e,isGraded:o,quizType:a,subTopicTagId:i,totalQuestions:r,quizTiming:s},ppSubjectAreaTagId:n[0].ppSubjectAreaTagId};$.ajax({url:properties[properties.env]+"/managePP/postPPQuizInstance",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(d)}).then(function(e){"true"===e.status&&(e.ppQuizResultVO&&("video"==e.ppQuizResultVO.quizType?$(".userClassNameStyles").html(e.ppQuizResultVO.customerFacingSubTopicName):$(".userClassNameStyles").html(e.ppQuizResultVO.quizType+": Quiz "+e.ppQuizResultVO.quizAttempt),e.ppQuizResultVO.instanceId&&($(".ppDashBoardBtnSection #progressBtn").attr("instanceId",e.ppQuizResultVO.instanceId),$(".ppDashBoardBtnSection #progressBtn").show())),$("#page-loading-spinner").hide()),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function retakeQuizFun(e){$("#retakingModalSection").modal("show"),$("#yesRetakeBtn").attr("onclick",$(e.currentTarget).attr("evtclick"))}function updateLastWatchedVideo(e){var t=$("#ppVideoFormat").val(),a=localStorage.getItem("schoolId"),o=JSON.parse(localStorage.getItem("ppProductVo")),i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:o[0].ppSubjectAreaTagId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:o[0].ppSubjectAreaTagId,ppSubTopicVO:{subTopictagId:e,modeType:t}};$.ajax({url:properties[properties.env]+"/managePP/updateLastWatchedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(t){var a,o;"true"==t.status&&(localStorage.setItem("latestSubTopicID",e),t.ppSubTopicVO&&(t.ppSubTopicVO.continuousVideoPath?(a=t.ppSubTopicVO.continuousVideoPath,localStorage.setItem("continuousVideoPath",a)):a=null,t.ppSubTopicVO.interactiveVideoPath?(o=t.ppSubTopicVO.interactiveVideoPath,localStorage.setItem("interactiveVideoPath",o)):o=null),$("#page-loading-spinner").hide(),$(window).trigger("resize"))},function(e){})}function getSummaryStatus(e){var t=$(e.currentTarget).attr("instanceId"),a=localStorage.getItem("schoolId"),o=JSON.parse(localStorage.getItem("ppProductVo"));setTimeout(function(){$("#page-loading-spinner").show();var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:o[0].ppSubjectAreaTagId,instanceId:t},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppQuizResultVO:{instanceId:t}};$.ajax({url:properties[properties.env]+"/managePP/getPPQuizStatusByInstanceId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if("true"===e.status){if(e.ppQuizResultVO){if("true"==e.ppQuizResultVO.isCompleted){var i=e.ppQuizResultVO;"object"==$.type(i)&&(i=[i]);for(var r=0;r<i.length;r++)i[r].QPQuestionVOList&&"object"==$.type(i[r].QPQuestionVOList)&&(i[r].QPQuestionVOList=[i[r].QPQuestionVOList]);var s={lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:o[0].ppSubjectAreaTagId,instanceId:t};Utility.saveLastActivity(s),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var t=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+t),$(".pp-holder-name .subjectAreaName").html(t),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var t=Handlebars.getTemplate("progress-dashboardpage")(i);$("#practicePerfect-progressContainer").html(t),$("#view-more-parent").hide(),$("#practicePerfect-progressContainer").show(),$("#child-progress-container").hide();for(var a=0;a<i[0].QPQuestionVOList.length;a++){var o=i[0].QPQuestionVOList[a].questionIdentifier;if("false"==i[0].QPQuestionVOList[a].correct){var r="";if(i[0].QPQuestionVOList[a].choiceId){r=i[0].QPQuestionVOList[a].choiceId,$("#question"+o+" #"+r).removeClass("result-block").addClass("result-blockRemove");var s=$("#question"+o+" #"+r).html();$("#question"+o+" #"+r).html('<span class=" ppTickposition glyphicon glyphicon-remove"></span>'+s),$("#question"+o+" #"+r+" .ppindex").addClass("ppglyp")}}}if("video"==i[0].quizType?($(".backToVideoBtn").attr("onclick","getAllVideoTracker('"+i[0].ppSubTopicVO.subTopictagId+"')"),$(".backToVideoBtn").html("Back to Video"),$(".retakeBtnGroup").show(),$(".backRetakeGroup").css("float","left"),$(".yesRetakeBtn").attr("onclick","createInstanceforPPQuiz('"+i[0].quizIdentifier+"','video',true,'"+i[0].ppSubTopicVO.subTopictagId+"','"+i[0].ppSubTopicVO.totalQuestions+"',300)"),$(".retakeBtnGroup").show()):($(".backToVideoBtn").attr("onclick","quizPage()"),$(".backToVideoBtn").html("Back to Quiz Center"),$(".retakeBtnGroup").hide(),$(".backRetakeGroup").css("float","right")),e.ppVideoQuizResultVOList){"object"==$.type(e.ppVideoQuizResultVOList)&&(e.ppVideoQuizResultVOList=[e.ppVideoQuizResultVOList]);var n=$(".retakeBtnGroup button").attr("subtopictagid"),d=$(".retakeBtnGroup button").attr("totalquestions");for(a=0;a<e.ppVideoQuizResultVOList.length;a++)"true"==e.ppVideoQuizResultVOList[a].isGraded?"true"==e.ppVideoQuizResultVOList[a].isCompleted?($(".retakeBtnGroup button").html("Retake Graded Quiz"),$(".retakeBtnGroup button").attr("evtClick","createInstanceforPPQuiz('"+e.ppVideoQuizResultVOList[a].quizIdentifier+"','video',true,'"+n+"',"+d+",300)"),$(".retakeBtnGroup button").attr("onclick","retakeQuizFun(event)")):e.ppVideoQuizResultVOList[a].instanceURL?($(".retakeBtnGroup button").html("Continue Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","showQuizFrame('"+e.ppVideoQuizResultVOList[a].instanceURL+"','pp','video','"+n+"',event)"),$(".retakeBtnGroup button").attr("instanceId",e.ppVideoQuizResultVOList[a].instanceId)):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+n+"',"+d+")")):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+n+"',"+d+")"))}$(window).trigger("resize")})})}else $("#reviewResultsModalSection").modal("show");$("#page-loading-spinner").hide()}}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})},1e3)}function quizCenterProgressLazyLoad(){map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){getQuizCenterProgress()})})}function changeCQ(e,t){var a=$(e);if($("#profCQuiz-detailedResult-content-area .titleTab").removeClass("tab-selected active"),a.addClass("tab-selected active"),"preview"==t)$("#profCQuiz-detailedResult-content-area .preview-page").show(),$("#profCQuiz-detailedResult-content-area .view-progress-page").hide();else if("results"==t){var o=a.attr("quizIdentifier"),i=a.attr("classId"),r=a.attr("semId"),s=a.attr("qpId");loadProfResultSummary(o,i,r,s),getTopicResultsForClass(o,i,r,s),getAllStudentsScore(o,i,r,s),excelSheetReportServiceCQ(o,i,r,s),$("#profCQuiz-detailedResult-content-area .preview-page").hide(),$("#profCQuiz-detailedResult-content-area .view-progress-page").show()}}function cqquestionOrderdropdown(){var e=$("#cqquestionOrder").val();"topicView"==e?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide()):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide()),updateCQResultView(e)}function adminSuppressFunc(){"true"==CaseConnect.adminStudyFlag?$(".hide-study-page-class").show():($(".hide-study-page-class").hide(),$("#insights-study-center").parent().hide()),"true"==CaseConnect.adminOutlineFlag?$(".hide-outline-page-class").show():$(".hide-outline-page-class").hide(),"true"==CaseConnect.adminInsightsFlag?$(".hide-class-insights-class").show():$(".hide-class-insights-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()}function freeTrialcatalog(){$("#wk_content .freeTrial-home-page").load("freeTrailCatalog.html?v4",function(){$("#ft-cateloglandingPage").show(),$(window).trigger("resize")})}function freeTrialBookList(){$("#page-loading-spinner").show();$.ajax({url:properties[properties.env]+"/manageBookService/getFreeTrialBooksByTrialId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify({userVO:{userId:null,userRole:null,userActivityVO:{lastActivityCode:"",pageNavigatingFrom:"",pageNavigatingTo:""}},freeTrialId:1})}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!0,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!1,e.bookVOList){var t=e.bookVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].bookVOList)&&(t[a].bookVOList=[t[a].bookVOList]);var o=Handlebars.getTemplate("ft-book-list")(e);$("#ft-bookListBlock").html(o);new List("ft-cateloglandingPage",{valueNames:["ft-bookTitle","ft-bookAuthor","bookIsbn"],listClass:"search-freeTrail",searchClass:"bookListFilterSearch"});void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")&&getFreeTrialCount();var i=9;$("#ft-bookListBlock .columnBooks").slice(0,i).show(),$("#loadMoreBookListBtn").on("click",function(e){e.preventDefault(),i+=6,$("#ft-bookListBlock .columnBooks").slice(0,i).slideDown(),$(".columnBooks").length<=i&&$("#loadMoreBookListBtn").hide()}),$("#page-loading-spinner").hide()}$(window).trigger("resize")}},function(e){})}function generateFreeTrialCheck(e){var t=$(e.currentTarget);void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?validateFreeTrialProduct(t):generateFreeTrialAccessCodes(t)}function generateFreeTrialAccessCodes(e){var t=e.attr("bookType"),a=e.attr("bookIsbn"),o=e.attr("bookId"),i={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"ADMIN_GENERATE_IP_REPORT",pageNavigatingFrom:"IPReport",pageNavigatingTo:"IPReport"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userRole:"wkadmin"},bookAccessCodeVO:{accessCodeType:"STXT",isbn:a,bookId:o,noAccesscodeGenerate:"1",validityPeriod:"-111",expireDate:"05-31-2020 23:59:59",productType:t,isFreeTrial:!0},freeTrialId:1};$.ajax({url:properties[properties.env]+"/manageBookService/generateFreeTrialAccessCodes",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if("true"===e.status&&e.bookAccessCodeVOList)if(void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")){insideStaticPage=!1,insideBookshelf=!0,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideOutline=!1,insideGlobalSearchResult=!1,rssFeedSAList=null,rssFeedAllList=null;var t="";t="Professor"===map.userRole?"professorBookShelf.html?v2":"bookShelf.html?v2",map.wk_conatiner.load(t,function(){Utility.showSpinner(),localStorage.removeItem("classCodeAddSectionRefresh"),CaseConnect.bookTitle="",$(".bookshelflink").hide(),$(".tutoriallink").hide(),CaseConnect.resourceFlag=!1;Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf(),window.history.pushState({page:"bookshelf"},null,properties.ui_domain);var t={};t.url=properties[properties.env]+"/manageBookService/saveBookInBookshelf",t.data={bookAccessCode:e.bookAccessCodeVOList.bookAccessCode},Handler.addBook.request(t),t.method="POST",t.handler=Handler.addBook,Utility.fireRequest(t)})}else map.bookAccessCode=e.bookAccessCodeVOList.bookAccessCode,window.history.pushState({page:"createAccount"},null,properties.ui_domain),map.wk_conatiner.load("createAccount.html?v5",function(){loadCountryListOnRegister(),$(window).scrollTop(0),Utility.hideSpinner()});$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function validateFreeTrialProduct(e){var t=e.attr("bookType"),a=e.attr("bookIsbn"),o=e.attr("bookId"),i={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"ADMIN_GENERATE_IP_REPORT",pageNavigatingFrom:"IPReport",pageNavigatingTo:"IPReport"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userRole:"wkadmin"},bookAccessCodeVO:{isbn:a,bookId:o,productType:t,isFreeTrial:!0},freeTrialId:1};$.ajax({url:properties[properties.env]+"/manageBookService/validateFreeTrialProduct",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(t){"true"===t.status&&generateFreeTrialAccessCodes(e),$("#page-loading-spinner").hide(),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),"bus.exception.user.already.have.an.active.product"==e.responseJSON.wkErrorCode?$("#ftAlreadyExisting").modal("show"):"bus.exception.user.exceeded.free.trial.count"==e.responseJSON.wkErrorCode?$("#ftRedeemLimitModal").modal("show"):alertMessagesModal(e.responseJSON.errorMessg)})}function searchFreeTrial(){if($("#bookListFilterSearch").val().length>0)$("ul.search-freeTrail li.columnBooks").show(),$("#loadMoreBookListBtn").hide();else{$("#ft-bookListBlock .columnBooks").hide(),$("#ft-bookListBlock .columnBooks").slice(0,9).show(),$("#loadMoreBookListBtn").show()}}function getFreeTrialCount(){var e={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"ADMIN_GENERATE_IP_REPORT",pageNavigatingFrom:"IPReport",pageNavigatingTo:"IPReport"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userRole:"wkadmin"},freeTrialId:1};$.ajax({url:properties[properties.env]+"/manageBookService/getFreeTrialCount",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if("true"===e.status){var t=e.usedFreeTrials,a=e.freeTrialLimit;t>a?$("#ftRedeemLimitModal").modal("show"):$(".reddemedClass").html(`Redeemed: ${t}/${a}`)}},function(e){$("#page-loading-spinner").hide(),"bus.exception.user.exceeded.free.trial.count"==e.responseJSON.wkErrorCode?$("#ftRedeemLimitModal").modal("show"):alertMessagesModal(e.responseJSON.errorMessg)})}