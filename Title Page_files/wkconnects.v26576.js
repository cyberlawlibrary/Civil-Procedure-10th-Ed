var eulaValidationCheck="true",stopTimer,startCount;Handler.decorate=function(e){e.userVO.userActivityVO={lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"BOOKSHELF",pageNavigatingTo:"BOOKSHELF"},e.userVO.sessionVO=map.sessionVO};var stopTimers,dummyLoginData=null,emailMessage=null,adminPublishedNotification=!1,systemWarningNotification=!1,emailvalidNotification=!1,adminNotificationStatus=!1,emailNotificationStatus=!1,systemWarningNotificationStatus=!1,comingFromBookshelfToResource=!1,resourceIdFromBookshelf=null,insideResourcePage=!1,comingFromThanksForRegistration=!1,expirypopoverFlag=!1,expiredBookFlag=!1,insideResourcePagefromPermawithBookAssoc=!1,isPermaTab="",isPermaTabs="";function sessionTimeOut(){if("true"!==CaseConnect.keepMeLoggedInFlag){clearTimeout(stopTimer),clearTimeout(stopTimers),seSsionOut(),$("#login-session-message").modal("hide"),stopTimer=window.setTimeout(function(){$("#login-session-message").modal("show")},4314e4),stopTimers=setTimeout(function(){$("#login-session-message").modal("hide"),CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer);window.location.pathname.split("plink");document.cookie="sameSession=false;path=/;";var e=localStorage.getItem("keepLoggedIn");localStorage.clear(),clearTimeout(stopTimer),delete map.userId,e&&localStorage.setItem("keepLoggedIn","true"),removeBookshelfLinkTOLogo(),window.location=properties.ui_domain,clearTimeout(stopTimer)},432e5)}}function cancleAccountChanges(){$("#editmyaccount-firstName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-lastName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-userRole").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-schoolLocation").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-countryName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-schoolName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-otherSchoolName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-emailPreferences").removeClass("error-field-bg").next(".err").remove(),$("#my-account-view").show(),$("#my-account-edit").hide(),$(".registration-required-label").css("display","none"),document.getElementById("editUserdetails").reset(),$("#editmyaccount-userRole option:not(:first), #editmyaccount-countryName option:not(:first), #editmyaccount-schoolLocation option:not(:first), #editmyaccount-schoolName option:not(:first)").remove(),$("#editMyaccount").focus()}function loadCountryListOnRegister(){$.ajax({url:properties[properties.env]+"/manageUserService/getCountryList",type:"GET",async:!1}).then(function(e){var t=e.countryList,a=[];$(createAccountForm[10]).parent().hide(),$(createAccountForm[10]).hide();for(var s=0;s<t.length;s++)if("United States"==t[s]){var o=s;a[0]=t[s];break}for(var i=1;i<t.length;i++)a[i]=i>o?t[i]:t[i-1];for(var r=0;r<a.length;r++){var n=a[r],l=$('<option value="'+n+'">'+n+"</option>");$(createAccountForm[7]).append(l)}if("United States"===createAccountForm[7].value){$.ajax({url:properties[properties.env]+"/manageUserService/getLocationAndRoleList",type:"GET",async:!1}).then(function(e){if("true"===e.status){var t=e.locationVOList;for(s=0,i=t.length;s<i;s++)createAccountForm[8].options[s+1]=new Option(t[s].schoolLocation,t[s].schoolLocation);$(createAccountForm[8]).show()}sessionTimeOut()},function(t){$("#page-loading-spinner").hide(),sessionAuthFails(e),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})}sessionTimeOut()},function(e){$("#page-loading-spinner").hide(),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})}function fillPartialRegistrationDetails(){window.history.pushState({page:"createAccount"},null,properties.ui_domain),map.wk_conatiner.load("createAccount.html?v26576",function(){$(window).scrollTop(0),$("#cc-register-heading").html("Complete Your Account Set-up"),$("#reg_firstName").val(dummyLoginData.userVO.firstName),$("#reg_lastName").val(dummyLoginData.userVO.lastName),$("#reg_email").val(dummyLoginData.userVO.email).attr("disabled","disabled"),$("#reg_confirmEmail").val(dummyLoginData.userVO.email).attr("disabled","disabled");var e=dummyLoginData.userVO.country,t=dummyLoginData.userVO.schoolLocation,a=dummyLoginData.userVO.schoolName,s=(dummyLoginData.userVO.schoolId,dummyLoginData.userVO.schoolNotInListFlag);if("true"==s){var o=a;a="other"}var i=dummyLoginData.countryList,r=[];$(createAccountForm[10]).parent().hide(),$(createAccountForm[10]).hide();for(var n=0;n<i.length;n++)if("United States"==i[n]){var l=n;r[0]=i[n];break}for(var d=1;d<i.length;d++)r[d]=d>l?i[d]:i[d-1];for(var c=0;c<r.length;c++){var u=r[c],p=e&&e.toLowerCase()==u.toLowerCase()?' selected = "selected"':"",m=$('<option value="'+u+'"'+p+">"+u+"</option>");$(createAccountForm[7]).append(m)}if("United States"===createAccountForm[7].value&&"NA"!==t||"United States"===createAccountForm[7].value&&""!==t){$(createAccountForm[8]).parent().show(),$(createAccountForm[8]).show(),$(createAccountForm[9]).parent().show(),$(createAccountForm[9]).show(),$(createAccountForm[10]).parent().hide(),$(createAccountForm[10]).hide(),$(createAccountForm[8]).html('<option value="">Select</option>'),$(createAccountForm[9]).html('<option value="">Select</option>'),createAccountForm[8].selectedIndex=0,createAccountForm[9].selectedIndex=0;var h=dummyLoginData.locationVOList;for(n=0,d=h.length;n<d;n++){var g=h[n].schoolLocation;p=t&&t.toLowerCase()==g.toLowerCase()?' selected = "selected"':"",m=$('<option value="'+g+'"'+p+">"+g+"</option>");$(createAccountForm[8]).append(m)}$(createAccountForm[8]).show()}else"United States"!==createAccountForm[7].value&&(createAccountForm[8].selectedIndex=0,createAccountForm[9].selectedIndex=0,createAccountForm[9].value="-999",$(createAccountForm[8]).parent().hide(),$(createAccountForm[9]).parent().hide(),$(createAccountForm[10]).parent().show(),$(createAccountForm[10]).show(),$(".write-school-name").next(".error-label").remove());if("United States"===createAccountForm[7].value&&"NA"!==createAccountForm[8].value){var f={response:function(e,t){if("false"==e.status){if("bus.exception.session.authentication.fail"===e.wkErrorCode&&"ERS500"===e.genericParam){window.location.pathname.split("plink");document.cookie="sameSession=false;path=/",localStorage.clear(),delete map.userId,window.location=properties.ui_domain}}else{var i=e.schoolVOList;for($(createAccountForm[9]).html(""),n=0,d=i.length;n<d;n++){var r=i[n].schoolName,l=i[n].schoolId,c=a&&a.toLowerCase()==r.toLowerCase()?' selected = "selected"':"",u=$('<option value="'+l+'"'+c+">"+r+"</option>");$(createAccountForm[9]).append(u)}"true"==s&&($(createAccountForm[9]).removeAttr("disabled"),$(createAccountForm[9]).hide(),$(createAccountForm[9]).parent().hide(),$(createAccountForm[10]).show(),$(createAccountForm[10]).parent().show(),$(createAccountForm[10]).val(o),$(createAccountForm[10]).removeClass("empty-placeholder")),$("#page-loading-spinner").hide()}}},v={locationVO:{locationName:$(createAccountForm[8]).val()},userVO:{userActivityVO:{lastActivityCode:"MYACCOUNT_VIEW",pageNavigatingFrom:"",pageNavigatingTo:"myAccount"},sessionVO:map.sessionVO}},b={method:"POST",url:properties[properties.env]+"/schoolListPopulationService/getSchoolListFromCacheByLocation",data:v,handler:f,target:null};Utility.fireRequest(b)}else"true"==s&&($(createAccountForm[9]).removeAttr("disabled"),$(createAccountForm[10]).show(),$(createAccountForm[10]).parent().show(),$(createAccountForm[10]).val(o),$(createAccountForm[10]).removeClass("empty-placeholder")),$("#page-loading-spinner").hide();Utility.hideSpinner()}),Utility.trackGA("register")}function fillPartialRegistrationDetailsFirstUser(){window.history.pushState({page:"createAccount"},null,properties.ui_domain),map.wk_conatiner.load("createAccount.html?v26576",function(){$(window).scrollTop(0),$("#cc-register-heading").html("Complete Your Registration"),$("#reg_firstName").val(""),$("#reg_lastName").val(""),dummyLoginData.userVO?($("#reg_email").val(dummyLoginData.userVO.email).attr("disabled","disabled"),$("#reg_confirmEmail").val(dummyLoginData.userVO.email).attr("disabled","disabled"),CaseConnect.aspenCode=dummyLoginData.userVO.aspenCode):($("#reg_email").val(dummyLoginData.userVO.email).attr("disabled","disabled"),$("#reg_confirmEmail").val(dummyLoginData.userVO.email).attr("disabled","disabled"));var e=dummyLoginData.countryList,t=[];$(createAccountForm[10]).parent().hide(),$(createAccountForm[10]).hide();for(var a=0;a<e.length;a++)if("United States"==e[a]){var s=a;t[0]=e[a];break}for(var o=1;o<e.length;o++)t[o]=o>s?e[o]:e[o-1];for(var i=0;i<t.length;i++){var r=t[i],n="United States".toLowerCase()==r.toLowerCase()?' selected = "selected"':"",l=$('<option value="'+r+'"'+n+">"+r+"</option>");$(createAccountForm[7]).append(l)}if(createAccountForm[7].value,"United States"===createAccountForm[7].value){$(createAccountForm[8]).parent().show(),$(createAccountForm[8]).show(),$(createAccountForm[9]).parent().show(),$(createAccountForm[9]).show(),$(createAccountForm[10]).parent().hide(),$(createAccountForm[10]).hide(),$(createAccountForm[8]).html('<option value="">Select</option>'),$(createAccountForm[9]).html('<option value="">Select</option>'),createAccountForm[8].selectedIndex=0,createAccountForm[9].selectedIndex=0;var d=null;dummyLoginData.locationVOList&&(d=dummyLoginData.locationVOList),dummyLoginData.locationList&&(d=dummyLoginData.locationList);var c=d;for(a=0,o=c.length;a<o;a++){var u=c[a].schoolLocation;n="NA".toLowerCase()==u.toLowerCase()?' selected = "selected"':"",l=$('<option value="'+u+'"'+n+">"+u+"</option>");$(createAccountForm[8]).append(l)}$(createAccountForm[8]).show()}else"United States"!==createAccountForm[7].value&&(createAccountForm[8].selectedIndex=0,createAccountForm[9].selectedIndex=0,createAccountForm[9].value="-999",$(createAccountForm[8]).parent().hide(),$(createAccountForm[9]).parent().hide(),$(createAccountForm[10]).parent().show(),$(createAccountForm[10]).show(),$(".write-school-name").next(".error-label").remove());if("United States"===createAccountForm[7].value&&"NA"!==createAccountForm[8].value);else"true"==schoolNotInListStatus&&($(createAccountForm[9]).removeAttr("disabled"),$(createAccountForm[10]).show(),$(createAccountForm[10]).parent().show(),$(createAccountForm[10]).val(otherSchoolName),$(createAccountForm[10]).removeClass("empty-placeholder")),$("#page-loading-spinner").hide();Utility.hideSpinner()}),Utility.trackGA("register")}function whatsThisPopover(){document.forms[0]&&document.forms[0].reset(),$("#whats-this").popover({html:!0,placement:"bottom",container:"body",template:'<div class="popover whats-this-popover" id="whats-this-popover-home" aria-labelledby="popover-content" aria-describedby="popover-content" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow"></div><div class="popover-content home-info-text" id="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$("#popover-content-wrapper-what-this").html()}}),CaseConnect.whatsThisShow=!0,CaseConnect.whatsThisShow&&($("#whats-this-popover-home").attr("aria-hidden","false"),document.addEventListener("focus",function(e){var t=document.getElementById("whats-this-popover-home");null!==t&&(t.contains(e.target)||(e.stopPropagation(),t.focus()))},!0),document.addEventListener("keydown",function(e){13==e.keyCode&&map.overlay.fadeOut(200)},!0)),$("form").bind("keypress",function(e){if(13==e.keyCode)return!1})}function practicePackWhatsThisPopover(){document.forms[0]&&document.forms[0].reset(),$("#practice-packs-whats-this").popover({html:!0,placement:"bottom",container:"body",template:'<div class="popover whats-this-popover" id="whats-this-popover-home" aria-labelledby="popover-content" aria-describedby="popover-content" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow"></div><div class="popover-content home-info-text" id="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$("#practice-pack-popover-content-wrapper-what-this").html()}}),CaseConnect.whatsThisShow=!0,CaseConnect.whatsThisShow&&($("#whats-this-popover-home").attr("aria-hidden","false"),document.addEventListener("focus",function(e){var t=document.getElementById("whats-this-popover-home");null!==t&&(t.contains(e.target)||(e.stopPropagation(),t.focus()))},!0),document.addEventListener("keydown",function(e){13==e.keyCode&&map.overlay.fadeOut(200)},!0)),$("form").bind("keypress",function(e){if(13==e.keyCode)return!1})}function checkFirstTimeLogin(e){closeOverlayInMobile("generic-nav-menu-mobile"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#generic-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$(".common-book-menu-dropdown").attr("onclick","showAccountMenuFromHamburger('generic-nav-menu-mobile');"),$("div.common-book-info-modal-container .ereader-top-nav-cog").addClass("cc-header-account").removeClass("glyphicon glyphicon-remove"),$("div.common-book-info-modal-container .ereader-top-nav-cog").attr("onclick","showAccountMenuInMobile('generic-nav-menu-mobile')"),$(".modal-backdrop").remove(),"true"===localStorage.getItem("firstTimeLoginFlag")&&(window.location=properties.ui_domain,e.stopPropagation()),enableCopyPaste()}function addBookshelfLinkTOLogo(){$(".connections-logo").attr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").attr("data-method","POST"),$(".connections-logo").attr("data-handler","goToBookShelf"),$(".connections-logo").parent().attr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").parent().attr("data-method","POST"),$(".connections-logo").parent().attr("data-handler","goToBookShelf"),$("#bookshelf-nav-menu-mobile").modal("hide")}function removeBookshelfLinkTOLogo(){$(".connections-logo").removeAttr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").removeAttr("data-method","POST"),$(".connections-logo").removeAttr("data-handler","goToBookShelf"),$(".connections-logo").parent().removeAttr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").parent().removeAttr("data-method","POST"),$(".connections-logo").parent().removeAttr("data-handler","goToBookShelf"),$(".connections-logo").attr("data-handler","click.returnHome"),$(".connections-logo").parent().attr("data-handler","click.returnHome")}function showFacultyCarousel(){$(".carousel").carousel(0),$(".carousel").carousel("pause"),$("#faculty-overlay-tutorial").modal("show"),$("#facultyDone").hide(),$("#facultyNext").show(),$(".carousel").off("slid.bs.carousel"),$(".carousel").on("slid.bs.carousel",function(){showFacultyOverlayIndicator()}),$("#faculty-overlay-tutorial").off("hide.bs.modal"),$("#faculty-overlay-tutorial").on("hide.bs.modal",function(){CaseConnect.firstTimeLoginFlag="false",localStorage.setItem("firstTimeLoginFlag","false")}),$("#btnCarouselCancel").off(),$("#btnCarouselCancel").on("click",function(){CaseConnect.firstTimeLoginFlag="false",localStorage.setItem("firstTimeLoginFlag","false")})}function showStudentCarousel(){$(".carousel").carousel(0),$(".carousel").carousel("pause"),$("#student-overlay-tutorial").modal("show"),$("#done").hide(),$("#next").show(),$(".carousel").off("slid.bs.carousel"),$(".carousel").on("slid.bs.carousel",function(){showOverlayIndicator()}),$("#student-overlay-tutorial").off("hide.bs.modal"),$("#student-overlay-tutorial").on("hide.bs.modal",function(){CaseConnect.firstTimeLoginFlag="false",localStorage.setItem("firstTimeLoginFlag","false")}),$("#btnCarouselCancel").off(),$("#btnCarouselCancel").on("click",function(){CaseConnect.firstTimeLoginFlag="false",localStorage.setItem("firstTimeLoginFlag","false")})}function previousOverlaySlide(){"true"!==$("#carousel-example-captions .carousel-inner .active").attr("data-start")&&$(".carousel").carousel("prev")}function nextOverlaySlide(){$(".carousel").carousel("next")}function showOverlayIndicator(){overlaySlideIndex=$("div .active").index("div.item"),$("ol li.active").removeClass("active"),$('ol.carousel-indicators li[data-slide-to="'+overlaySlideIndex+'"]').addClass("active"),5===overlaySlideIndex?($("#done").show(),$("#next").hide()):($("#done").hide(),$("#next").show())}function showFacultyOverlayIndicator(){overlaySlideIndex=$("div .active").index("div.item"),$("ol li.active").removeClass("active"),$('ol.carousel-indicators li[data-slide-to="'+overlaySlideIndex+'"]').addClass("active"),5===overlaySlideIndex?($("#facultyDone").show(),$("#facultyNext").hide()):($("#facultyDone").hide(),$("#facultyNext").show())}function retriveLocalTimeFromUTC(e){return moment.utc(e).toDate().toString()}function displayTooltipContent(){$("#class-code-info-button-faculty").popover({html:!0,placement:"right",container:"body",template:'<div class="popover go-to-popover ebook-custom-popover" id=""><div class="arrow menuArrow"></div><div id="ereader-menu-popover-content" class="popover-content ereader-menu-popover"></div></div>',content:function(){return $("#class-code-popover-content").html()}})}function showHideGlobalSearch(){var e=["wk.cc.student@aol.com","wk.cc.stg.prof1@aol.com","sonali.rai@tcs.com","sonali.rai@wolterskluwer.com","s.pradhan2@tcs.com","tofugolem@gmail.com","sherrimeek@gmail.com","sherri.meek@wolterskluwer.com","maureen.kenealy@gmail.com","maureen.kenealy@wolterskluwer.com","devakumar.pv@tcs.com","devakumar.pv@wolterskluwer.com","inthumathi_2004@yahoo.com","subhashree.pradhan@wolterskluwer.com","inthumathi@wolterskluwer.com","i.narayanavadivu@wolterskluwer.com","sonali491@gmail.com"],t=["wk.cc.prof4@aol.com","wk.cc.student6@aol.com","sonali.rai@tcs.com","sonali.rai@wolterskluwer.com","s.pradhan2@tcs.com","team.gernowski@gmail.com","sherrimeek@gmail.com","sherri.meek@wolterskluwer.com","maureen.kenealy@gmail.com","maureen.kenealy@wolterskluwer.com","devakumar.pv@tcs.com","devakumar.pv@wolterskluwer.com","inthumathi_2004@yahoo.com","subhashree.pradhan@wolterskluwer.com","inthumathi@wolterskluwer.com","i.narayanavadivu@wolterskluwer.com","sonali491@gmail.com"],a=map.email;if("staging"===properties.env)for(var s=0;s<e.length;s++){if(a===e[s])return void $("#global-search-box-wrap").css("display","block");$("#global-search-box-wrap").css("display","none")}else if("prod"===properties.env)for(s=0;s<t.length;s++){if(a===t[s])return void $("#global-search-box-wrap").css("display","block");$("#global-search-box-wrap").css("display","none")}else $("#global-search-box-wrap").css("display","block")}function hideShowListofBooks(){var e=$("#my-search-box").val(),t="";t="Student"===localStorage.getItem("userRole")?"student-book-elements":"faculty-book-elements",e.length>0&&($("ul#"+t+" li").addClass("show-books"),$("ul#"+t+" li").removeClass("hide-books"),$(".view-more-less-link").hide())}function checkIndex(e){return"ConnectedQuiz"==e.bookType}function checkIndexPP(e){return"PracticePerfect"==e.bookType}Handler.click={login:function(e){null!==localStorage.getItem("userId")?alertMessagesModal("You are already logged into CasebookConnect."):(window.history.pushState({page:"login"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain+"login"),void 0!==map.bookAccessCode&&delete map.bookAccessCode,void 0!==localStorage.bookAccessCode&&localStorage.removeItem("bookAccessCode"),$("#drop-nav-navigation-cog").hide(),map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),$(".login-remember-label").show()}),$("#generic-nav-menu-logout-mobile").modal("hide"))},outline:function(e){$("#ereader-nav-menu-mobile").modal("hide"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$(".modal-backdrop").remove(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),$("#page-loading-spinner").show(),map.wk_conatiner.load("outline-editing-tool.html?v19893",function(){Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle(),addBookshelfLinkTOLogo(),enableCopyPaste(),insideOutline=!0,insideNewsFeed=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideStaticPage=!1,insideBookshelf=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideGlobalSearchResult=!1,$(window).trigger("resize"),insideCustomOutline=!1,navigatingFromClassInsightsToOutline=!0,nonEditableChapterOutline=!0,initializeOutlineOnLoad(),$(window).scrollTop(0),$("body").removeClass("modal-open")})},resource:function(e){$("#ereader-nav-menu-mobile").modal("hide"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$(".modal-backdrop").remove(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),insideEreader=!1,$("#page-loading-spinner").show(),map.wk_conatiner.load("view-resource.html?v19893",function(){CaseConnect.resourceFlag="true",insideResourcePage=!0,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideCasesPage=!1,insideOutline=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideGlobalSearchResult=!1,showPreviewInNewPage(),$("#page-loading-spinner").show(),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),CaseConnect.resourceFlag="true","true"==CaseConnect.resourceFlag&&$(".resource-heading-pipes").hide(),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()),adminSuppressFunc(),null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount()}),Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle(),$(window).trigger("resize"),adminSuppressFunc()},comingFromBookshelfToResource:function(e){comingFromBookshelfToResource=!0,$("#ereader-nav-menu-mobile").modal("hide"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$(".modal-backdrop").remove(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),$("#page-loading-spinner").show(),map.wk_conatiner.load("view-resource.html?v19893",function(){CaseConnect.resourceFlag="true",CaseConnect.bookType="",insideResourcePage=!0,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideCasesPage=!1,insideOutline=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideGlobalSearchResult=!1,goToResourceFromBookshelf()}),Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle()},resetPassword:function(e){window.history.pushState({page:"resetpassword"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain),map.wk_conatiner.load("resetPass.html?v3",function(){$(".loginLink").show(),$("#reset-pass-btn").show(),$("#complete-reg-btn").hide(),$(".reset-additional-info").show(),$("#reset-password-heading h1").html("Reset Password?")})},firstTimeUser:function(e){window.history.pushState({page:""},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain),map.wk_conatiner.load("resetPass.html?v3",function(){$(".loginLink").show(),$("#reset-pass-btn").hide(),$("#complete-reg-btn").show(),$(".reset-additional-info").hide(),$("#reset-password-heading h1").html("First Time User?"),$("#reset-pass-btn").remove()})},logout:function(e){CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer),$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"LOGOUT_USER",pageNavigatingFrom:"",pageNavigatingTo:"",lastReadBookId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,pageNumber:CaseConnect.currentPageNumber}};$.ajax({url:properties[properties.env]+"/manageUserService/logout",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){window.location.pathname.split("plink");document.cookie="sameSession=false;path=/;";var t=localStorage.getItem("keepLoggedIn");localStorage.clear(),clearTimeout(stopTimer),delete map.userId,t&&localStorage.setItem("keepLoggedIn","true"),removeBookshelfLinkTOLogo(),window.location=properties.ui_domain,clearTimeout(stopTimer)},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain;window.location.pathname.split("plink");document.cookie="sameSession=false;path=/;";var t=localStorage.getItem("keepLoggedIn");localStorage.clear(),clearTimeout(stopTimer),delete map.userId,t&&localStorage.setItem("keepLoggedIn","true"),removeBookshelfLinkTOLogo(),window.location=properties.ui_domain,clearTimeout(stopTimer)})},cancel:function(){"cancelRegistration"==this.id&&(window.location=properties.ui_domain),"reset-pass-cancel"==this.id&&(void 0!==map.bookAccessCode&&(localStorage.bookAccessCode=map.bookAccessCode),map.isIE9?(localStorage.setItem("requestedPage","continueLogin.html?v26576"),window.location=properties.ui_domain):(window.history.pushState({page:"login"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain+"login"),map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),$(".login-remember-label").show()})))},validateChangePassword:function(e,t){$(".change-password-heading").next(".error-label ").remove(),$(".current-password").removeClass("error-field-bg").next(".error-label ").remove(),$(".create-new-password").removeClass("error-field-bg").next(".error-label ").remove(),$(".confirm-new-password").removeClass("error-field-bg").next(".error-label ").remove();var a=t.form[0].value,s=t.form[1].value,o=t.form[2].value;""===a&&""===s&&""===o?($(".change-password-heading").addClass("").after("<span class='error-text error-label display-this' tabindex='0'>All fields required.</span>"),e.stopPropagation()):""===a?($(".current-password").addClass("error-field-bg").after("<span class='error-label error-text' tabindex='0'>Current Password is required.</span>"),e.stopPropagation()):""===s?($(".create-new-password").addClass("error-field-bg").after("<span class='error-label error-text' tabindex='0'>New Password is required.</span>"),e.stopPropagation()):""===o?($(".confirm-new-password").addClass("error-field-bg").after("<span class='error-label error-text' tabindex='0'>Confirmed Password is required.</span>"),e.stopPropagation()):s.length<8||s.length>20?($(".create-new-password").addClass("error-field-bg").after("<span class='error-label error-text' tabindex='0'>Password must be 8 to 20 characters.</span>"),e.stopPropagation()):s!=o&&($(".confirm-new-password").addClass("error-field-bg").after("<span class='error-label error-text' tabindex='0'>Passwords must match.</span>"),e.stopPropagation())},validateForceResetPassword:function(e,t){$(".error-label").remove(),$("#resetPasswordNew").removeClass("error-field-bg").next(".error-label").remove(),$("#resetPasswordCnf").removeClass("error-field-bg").next(".error-label").remove();var a=$("#resetPasswordNew").val(),s=$("#resetPasswordCnf").val();""===a&&""===s?($(".newPasswordClass").addClass("").after("<span class='col-xs-12 error-text error-label display-this' tabindex='0' style='position: relative;top: 6px;'><sup>*</sup>All fields required.</span>"),e.stopPropagation()):""===a?($(".newPasswordClass").addClass("").after("<span class='col-xs-12 error-label error-text' tabindex='0' style='position: relative;top: 6px;'><sup>*</sup>New Password is required.</span>"),e.stopPropagation()):""===s?($(".newPasswordClass").addClass("").after("<span class='col-xs-12 error-label error-text' tabindex='0' style='position: relative;top: 6px;'><sup>*</sup>Confirmed Password is required.</span>"),e.stopPropagation()):a.length<8||a.length>20?($(".newPasswordClass").addClass("").after("<span class='col-xs-12 error-label error-text' tabindex='0' style='position: relative;top: 6px;'><sup>*</sup>Password does not meet requirements.</span>"),e.stopPropagation()):a!=s&&($(".newPasswordClass").addClass("").after("<span class='col-xs-12 error-label error-text' tabindex='0' style='position: relative;top: 6px;'><sup>*</sup>Passwords do not match.</span>"),e.stopPropagation())},validateMyAccount:function(e,t){$(".editUserdetails-err-msg-top").html(""),$("#editmyaccount-firstName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-lastName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-userRole").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-schoolLocation").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-countryName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-schoolName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-otherSchoolName").removeClass("error-field-bg").next(".err").remove(),$("#editmyaccount-emailPreferences").removeClass("error-field-bg").next(".err").remove();var a=$("#editmyaccount-firstName").val().trim(),s=$("#editmyaccount-lastName").val().trim(),o=$("#editmyaccount-userRole").val(),i=$("#editmyaccount-countryName").val(),r=$("#editmyaccount-schoolLocation").val(),n=t.form[6].value,l=$("#editmyaccount-emailPreferences")[0].checked,d=$("#editmyaccount-schoolName").val();"-999"===n&&(n=t.form.other.value.trim()),null==d&&(n=t.form.other.value.trim()),""==a?($("#editmyaccount-firstName").addClass("error-field-bg").after("<span class='err col-xs-12 error-label error-text' tabindex='0'>Required</span>"),e.stopPropagation()):a.length>100?($("#editmyaccount-firstName").addClass("error-field-bg").after("<span class='err col-xs-12 error-label error-text' tabindex='0'>First Name must be maximum 100 characters.</span>"),e.stopPropagation()):""==s?($("#editmyaccount-lastName").addClass("error-field-bg").after("<span class='err col-xs-12 error-label error-text' tabindex='0'>Required</span>"),e.stopPropagation()):s.length>100?($("#editmyaccount-lastName").addClass("error-field-bg").after("<span class='err col-xs-12 error-label error-text' tabindex='0'>Last Name must be maximum 100 characters.</span>"),e.stopPropagation()):"0"==o?($("#editmyaccount-userRole").addClass("error-field-bg").after("<span class='err  col-xs-12 error-label error-text' tabindex='0'> Required</span>"),e.stopPropagation()):"0"==i?($("#editmyaccount-countryName").addClass("error-field-bg").after("<span class='err  col-xs-12 error-label error-text' tabindex='0'> Required </span>"),e.stopPropagation()):"0"==r?($("#editmyaccount-schoolLocation").addClass("error-field-bg").after("<span class='err col-xs-12 error-label error-text' tabindex='0'> Required</span>"),e.stopPropagation()):"0"==d?($("#editmyaccount-schoolName").addClass("error-field-bg").after("<span class='err  col-xs-12 error-label error-text' tabindex='0'>Required. If your school is not listed, select \"Other‚Äù.</span>"),e.stopPropagation()):"-999"==d&&""==n||null==d&&""==n?($("#editmyaccount-otherSchoolName").addClass("error-field-bg").after("<span class='err  col-xs-12 error-label error-text' tabindex='0'> Required</span>"),e.stopPropagation()):n.length>100?($("#editmyaccount-otherSchoolName").addClass("error-field-bg").after("<span class='err  col-xs-12 error-label error-text' tabindex='0'>School Name must be of maximum 100 characters</span>"),e.stopPropagation()):l?$("#editmyaccount-emailPreferences:checkbox").val("0"):l||$("#editmyaccount-emailPreferences:checkbox").val("1")},validateCreatePassword:function(e,t){$(".account-validation-msg").css("display","none"),$(".create-new-password-text").next(".error-label").remove(),$(".create-new-password").next(".err").remove(),$(".confirm-new-password").next(".err").remove();var a=t.form[0].value,s=t.form[1].value;""===a&&""===s?($(".create-new-password").addClass("").after("<span class='err col-sm-3'><i class='password-err-label' tabindex='0'>All fields are required.</i></span>"),e.stopPropagation()):""===a&&""!==s?($(".create-new-password").addClass("").after("<span class='err col-sm-3'><i class='password-err-label' tabindex='0'>Password is required.</i></span>"),e.stopPropagation()):""!==a&&""===s?($(".confirm-new-password").addClass("").after("<span class='err col-sm-3'><i class='password-err-label' tabindex='0'>Confirm Password is required.</i></span>"),e.stopPropagation()):a.length<8||a.length>20?($(".create-new-password").addClass("").after("<span class='err col-sm-3'><i class='password-err-label' tabindex='0'>Password must be 8 to 20 characters.</i></span>"),e.stopPropagation()):a!=s&&($(".confirm-new-password").addClass("").after("<span class='err col-sm-3'><i class='password-err-label' tabindex='0'>Passwords must match.</i></span>"),e.stopPropagation())},closePop:function(e,t){if("addBook"===t&&comingFromAddProductPopover){comingFromAddProductPopover=!1;var a=$("#addProductToBookshelf").clone(!0);$("#add-product-to-bookshelf").html(""),$("#add-product-to-bookshelf").append(a.html())}else $("."+t).popover("hide"),map.overlay.fadeOut(200),e.stopPropagation();CaseConnect.whatsThisShow&&$("#whats-this").on("hidden.bs.popover",function(e){CaseConnect.whatsThisShow&&($("#whats-this").focus(),CaseConnect.whatsThisShow=!1)})},returnHome:function(e){var t=localStorage.getItem("rememberMe"),a=null!=localStorage.getItem("userId");"true"==t||a||(window.location=properties.ui_domain,disableLoginRegister())},userDetailsInfo:function(e,t){var a=$("span#reg2-user-role").text();country=t.form.country.value.trim(),schoolLocation=t.form.schoolLocation.value.trim(),schoolId=t.form.schoolId.value.trim();var s=!1;"United States"==country?"-999"===schoolId&&(schoolId=t.form.other.value.trim(),s=!0):"United States"!==country&&(schoolId="-999",schoolLocation="NA","-999"===schoolId&&(schoolId=t.form.other.value.trim(),s=!0)),$(".almost-there-text").next(".almost-there-error-msg").remove(),$(".first-time-login-role").next(".error-label").remove(),$(".first-time-login-country").next(".error-label").remove(),$(".first-time-login-country").next(".error-field-bg").remove(),$(".first-time-login-location").next(".error-label").remove(),$(".first-time-login-location").next(".error-field-bg").remove(),$(".first-time-login-school ").next(".error-label").remove(),$(".first-time-login-school ").next(".error-field-bg").remove(),$(".write-school-name").next(".error-label").remove(),$(".write-school-name").next(".error-field-bg").remove(),""===a&&""===country&&""===schoolId&&($(".almost-there-text").addClass("").after("<span class='almost-there-error-msg error-label'>All fields are required.</span>"),e.stopPropagation()),"United States"==country?""===a?($(".first-time-login-role").addClass("").after("<span class='error-label'>Required</span>"),e.stopPropagation()):""===country||0==country?($(".first-time-login-country").addClass("").after("<span class='error-label'> Required</span>"),e.stopPropagation()):""===schoolLocation||0==schoolLocation?($(".first-time-login-location").addClass("").after("<span class='error-label'> Required</span>"),e.stopPropagation()):""!==schoolId&&0!=schoolId||0!=s?""!==schoolId&&0!=schoolId||1!=s?"Enter your school name here"===schoolId&&($(".write-school-name ").addClass("").after("<span class='error-label'>Required.</span>"),e.stopPropagation()):($(".write-school-name ").addClass("").after("<span class='error-label'> Required. If your school is not listed, select \"Other\"</span>"),e.stopPropagation()):($(".first-time-login-school ").addClass("").after("<span class='error-label'> Required. If your school is not listed, select \"Other\"</span>"),e.stopPropagation()):"United States"!==country&&(schoolId="-999","-999"===schoolId&&(schoolId=t.form.other.value.trim()),""===a?($(".first-time-login-role").addClass("").after("<span class='error-label'>Required</span>"),e.stopPropagation()):""===country||0==country?($(".first-time-login-country").addClass("").after("<span class='error-label'> Required</span>"),e.stopPropagation()):""===schoolId||0==schoolId?($(".write-school-name").addClass("").after("<span class='error-label'> Required.</span>"),e.stopPropagation()):"Enter your school name here"===schoolId&&($(".write-school-name").addClass("").after("<span class='error-label'> Required.</span>"),e.stopPropagation()))},validateLogin:function(e,t){$(".forgot-password-label").next(".error-label").remove(),$(".login-validation-msg").css("display","none");var a=$("#login_email").val().trim(),s=$("#login_password").val().trim();$(".login-email-class").next(".reset-error-fields").remove(),$(".heading-label").next(".error-label").remove(),$(".login-email-class").next(".err").remove(),$(".login-password-class").next(".err").remove(),""===a&&""===s?($(".login-email-class").addClass("").after("<span class='reset-error-fields error-label'>All fields are required.</span>"),e.stopPropagation()):""===a&&""!==s?($(".login-password-class").next(".err").remove(),$(".login-email-class").addClass("").after("<span class='err col-sm-3'><span class='password-err-label'>Email is required.</span></span>"),e.stopPropagation()):""===a||/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)?""!==a&&""===s?($(".login-email-class").next(".err").remove(),$(".login-password-class").addClass("").after("<span class='err col-sm-3'><span class='password-err-label'>Password is required.</span>"),e.stopPropagation()):grecaptcha.execute():($(".login-email-class").addClass("").after("<span class='err col-sm-3'><span class='login-err-label loginErrMsg'>Email address not recognized. Please correct your email address or create a new account.</span></span>"),e.stopPropagation())},validateResetPassword:function(e,t){$(".reset-email").next(".err").remove(),$("#recaptchaLogin").next(".err").remove(),$("#recaptchaLogin").next(".error-label").remove(),$(".reset-pass-img").next(".error-label").remove(),$("#error_msg").html("");var a=$(".reset-email").val().trim();""==a?($("#error_msg").html("<span class='err col-sm-3' style='margin-left:0px;'><i class='password-err-label'>Email is required.</i></span>"),e.stopPropagation()):""===a||/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)||($("#error_msg").html("<span class='err col-sm-3' style='margin-left:0px;'><i class='password-err-label'>Email address not recognized. </i></span>"),e.stopPropagation())},createAccount:function(e,t){var a=t.form.firstName.value.trim(),s=t.form.lastName.value.trim(),o=t.form.email.value.trim(),i=t.form.confirmEmail.value.trim(),r=t.form.password.value.trim(),n=t.form.confirmPassword.value.trim(),l=t.form.country.value,d=t.form.schoolLocation.value,c=t.form.schoolId.value,u=t.form.other.value.trim(),p=(map.bookAccessCode,$("#readTerms").is(":checked"));if(comingFromThanksForRegistration=!0,$(".create-account-text").next(".registration-err-field-required").remove(),$("#registration-heading").next(".error-label ").remove(),$(".check-terms-class").next(".err").remove(),!1===p)$(".check-terms-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>You must accept the Terms of Use and Privacy Policy.</i></span>"),e.stopPropagation();else{var m=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=r.length;$("#registration-heading").next(".error-label").remove(),$(".fname-class").next(".err").remove(),$(".lname-class").next(".err").remove(),$(".email-class").next(".err").remove(),$(".cnfEmail-class").next(".err").remove(),$(".pwd-class").next(".err").remove(),$(".cnfPwd-class").next(".err").remove(),$(".first-time-login-school").next(".error-label").remove(),$(".write-school-name").next(".error-label").remove(),$(".write-school-name").next(".error-field-bg").remove(),$("#email-field").css("background-color","#fafafa"),$("#email-confirm-field").css("background-color","#fafafa"),$("#password-field").css("background-color","#fafafa"),$("#password-confirm-field").css("background-color","#fafafa"),$(".check-terms-class").next(".registration-err-field-required").remove(),""!=a||a.trim()?""!=s||s.trim()?""!=o||o.trim()?""!=i||i.trim()?""!=r||r.trim()?""!=n||n.trim()?!m.test(o)&&i!==o&&n!==r&&(h<8||h>20)?($(".email-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Email format is invalid.</i></span>"),$("#email-field").css("background-color","#fceff1"),$(".cnfEmail-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Emails must match.</i></span>"),$("#email-confirm-field").css("background-color","#fceff1"),$(".pwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Password must be 8 to 20 characters.</i></span>"),$("#password-field").css("background-color","#fceff1"),$(".cnfPwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Passwords must match.</i></span>"),$("#password-confirm-field").css("background-color","#fceff1"),e.stopPropagation()):m.test(o)?i!==o?($(".cnfEmail-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Emails must match.</i></span>"),$("#email-confirm-field").css("background-color","#fceff1"),e.stopPropagation()):h<8||h>20?($(".pwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Password must be 8 to 20 characters.</i></span>"),$("#password-field").css("background-color","#fceff1"),e.stopPropagation()):n!==r?($(".cnfPwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Passwords must match.</i></span>"),$("#password-confirm-field").css("background-color","#fceff1"),e.stopPropagation()):""===l?($(".first-time-login-country").next(".error-label").remove(),$(".first-time-login-country ").addClass("").after(""),$(".first-time-login-country").next(".error-field-bg").remove(),e.stopPropagation()):""!==l&&"United States"===l&&""===d?($(".first-time-login-location").next(".error-label").remove(),$(".first-time-login-location").next(".error-field-bg").remove(),$(".first-time-login-location").addClass("").after('<span class="err error-field-bg col-sm-3 col-xs-12"><i class="password-err-label"> Required </i></span>'),e.stopPropagation()):""!==l&&"United States"===l&&""===c?($(".first-time-login-school").next(".error-label").remove(),$(".first-time-login-school").next(".error-field-bg").remove(),$(".first-time-login-school ").addClass("").after('<span class="err error-field-bg col-sm-3 col-xs-12"><i class="password-err-label"> Required. If your school is not listed, select "Other" </i></span>'),e.stopPropagation()):""===l||"United States"!==l||"-999"!==c||"Enter your school name here"!==u&&""!==u?""!==l&&"United States"!==l&&""===u||""!==l&&"United States"!==l&&"Enter your school name here"===u?($(".write-school-name").next(".error-label").remove(),$(".write-school-name").next(".error-field-bg").remove(),$(".write-school-name").addClass("").after('<span class="err error-field-bg col-sm-3 col-xs-12"><i class="password-err-label"> Required </i></span>'),e.stopPropagation()):grecaptcha.execute():($(".write-school-name").next(".error-label").remove(),$(".write-school-name").next(".error-field-bg").remove(),$(".write-school-name").addClass("").after('<span class="err error-field-bg col-sm-3 col-xs-12"><i class="password-err-label"> Required </i></span>'),e.stopPropagation()):($(".email-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Not a valid Email.</i></span>"),$("#email-field").css("background-color","#fceff1"),e.stopPropagation()):($(".cnfPwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Confirm password can't be blank spaces.</i></span>"),e.stopPropagation()):($(".pwd-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Password can't be blank spaces.</i></span>"),e.stopPropagation()):($(".cnfEmail-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Required.</i></span>"),e.stopPropagation()):($(".email-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Required.</i></span>"),e.stopPropagation()):($(".lname-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Last Name can't be blank spaces.</i></span>"),e.stopPropagation()):($(".fname-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>First Name can't be blank spaces.</i></span>"),e.stopPropagation())}},faculty:function(e,t){void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?($("#myaccount-span").show(),$(".myAccount").show(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#header-wrapper").show()):($(".loginLink").show(),$(".statusBar").hide()),window.scrollTo(0,0),window.history.pushState({page:"faculty"},"Faculty | Casebook Connect from Wolters Kluwer",properties.ui_domain+"faculty"),map.wk_conatiner.load("faculty.html",function(){"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",window.location.pathname])})},learnmore:function(e,t){window.location="learnmore",$("#header-wrapper").show()},catalog:function(data){$("#catalog-page-loading-spinner").show();var handler="goToCatalogPage",request={},data={};request.url="/bookShelfRetrivalService/getBookCatalogDataSubjectAreaWise",request.url=properties[properties.env]+request.url,request.method="GET",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request),$("#catalog-page-loading-spinner").show()},about:function(e,t){void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?($("#myaccount-span").show(),$(".myAccount").show(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#header-wrapper").show()):($(".loginLink").show(),$(".statusBar").hide()),window.scrollTo(0,0),window.history.pushState({page:"about"},"End User License Agreement | Casebook Connect | Wolters Kluwer Legal Education",properties.ui_domain+"about"),map.wk_conatiner.load("about.html",function(){"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",window.location.pathname])})},termsofuse:function(e,t){void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?($("#myaccount-span").show(),$(".myAccount").show(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#header-wrapper").show()):($(".loginLink").show(),$(".statusBar").hide()),window.scrollTo(0,0),window.history.pushState({page:"terms"},"End User License Agreement | Casebook Connect | Wolters Kluwer Legal Education",properties.ui_domain+"terms"),map.wk_conatiner.load("terms.html",function(){"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",window.location.pathname])})},privacypolicy:function(e,t){void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?($("#myaccount-span").show(),$(".myAccount").show(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#header-wrapper").show()):($(".loginLink").show(),$(".statusBar").hide()),window.scrollTo(0,0),window.history.pushState({page:"privacy"},"Privacy Policy | Casebook Connect | Wolters Kluwer Legal Education",properties.ui_domain+"privacy"),map.wk_conatiner.load("privacy.html",function(){"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",window.location.pathname])})},pressroom:function(e,t){void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId")?($("#myaccount-span").show(),$(".myAccount").show(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#header-wrapper").show()):($(".loginLink").show(),$(".statusBar").hide()),window.scrollTo(0,0),window.history.pushState({page:"press"},"End User License Agreement | Casebook Connect | Wolters Kluwer Legal Education",properties.ui_domain+"press"),map.wk_conatiner.load("press.html",function(){"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",window.location.pathname])})},facultyCreateClass:function(event,target){var facultyClassName=target.form.facultyCreateClassName.value,facultySemester=target.form.facultySemesterYear.value,facultySection=target.form.facultySectionName.value,facultyMeeting=target.form.facultyMeetingTimes.value,facultyDescription=target.form.facultyClassDescription.value;CaseConnect.currentClassName=facultyClassName,CaseConnect.currentClassDescription=facultyDescription,CaseConnect.currentSemesterYear=facultySemester,CaseConnect.currentSectionInfo=facultySection,CaseConnect.currentMeetingTime=facultyMeeting,""===facultyClassName||facultyClassName.trim()||($(".fname-class").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>Class Name can't be blank spaces.</i></span>"),event.stopPropagation());var handler="facultyCreateClass",request={},reqData={};request.url="/manageClassWebService/addClass",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request)},createFileUploadPlugin:function(e,t){var a={autoSubmit:!1,returnType:"json",fileName:"file",showCancel:!1,showAbort:!1,showDone:!1,multiple:!1,showFileCounter:!1,dynamicFormData:function(){return{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,appType:map.sessionVO.appType,deviceType:map.sessionVO.deviceType,deviceOS:map.sessionVO.deviceOS,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken"),classId:CaseConnect.currentClassId,fileUploadPurpose:"CLASS_SYLLABUS_FILE"}}},s=$.extend({},a,t);return e.uploadFile(s)},downloadFacultyDocumet:function(e){var t=map.sessionVO;$("#userId").val(map.userId),$("#userRole").val(map.userRole),$("#userRoleId").val(map.userRoleId),$("#appType").val(t.appType),$("#deviceType").val(t.deviceType),$("#deviceOS").val(t.deviceOS);var a=e.currentTarget.getAttribute("fileId");$("#fileId").val(a),t.sessionAuthenticationToken||localStorage.getItem("sessionAuthenticationToken")&&(map.sessionVO.sessionAuthenticationToken=localStorage.getItem("sessionAuthenticationToken")),$("#sessionAuthenticationToken").val(localStorage.getItem("sessionAuthenticationToken")),document.getElementById("downloadForm").action=properties[properties.env]+"/manageClassWebService/downloadClassFile",$("#downloadForm").submit()},validateContinueLogin:function(e,t){var a=$.trim($("#login_email").val());$(".login-validation-msg").css("display","none");$(".top-error-msg").html(""),$(".login-email-class").next(".err").remove(),""===a?($(".login-email-class").next(".err").remove(),$(".login-email-class").addClass("").after("<span class='err login col-sm-3'><span class='password-err-label login'>Email is required.</span></span>"),e.stopPropagation()):""===a||/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)||($(".login-email-class").next(".err").remove(),$(".login-email-class").addClass("").after("<span class='err login col-sm-3'><span class='login-err-label login'>Email address not recognized. Please correct your email address or create a new account.</span></span>"),e.stopPropagation())}},Handler.continueLogin={request:function(e){var t=$.trim($("#login_email").val());map.email=e.data.email,e.data={userVO:{email:t,streamContentRequiredFlag:!1,userRole:"",userRoleId:"",userActivityVO:{lastActivityCode:"NORMAL_LOGIN_WITHOUT_BOOKACCEESCODE",pageNavigatingFrom:"LOGIN",pageNavigatingTo:""},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}},Utility.showSpinner()},response:function(e){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),comingFromThanksForRegistration=!1,void 0!==e.userVO&&void 0!==e.userVO.sessionVO&&void 0!==e.userVO.sessionVO.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.userVO.sessionVO.sessionAuthenticationToken),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"false"===e.status)sessionAuthFails(e),"bus.exception.user.not.exists"===e.wkErrorCode?($(".heading-label").next(".error-label").remove(),$("#error_msg").append(e.errorMessg)):"bus.exception.this.is.not.an.activated.account"===e.wkErrorCode||"bus.exception.this.is.not.an.activated.aspenAccount"===e.wkErrorCode?$(".login-validation-msg").css("display","block"):$("#error_msg").append(e.errorMessg),Utility.hideSpinner();else if(dummyLoginData=e,CaseConnect.aspenCode=e.userVO.aspenCode,"login"==e.redirectStatus){var t=e.userVO.email;window.history.pushState({page:"continueLogin"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain+"continueLogin"),map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(t),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),"1"===e.userVO.suspendedFlag?$(".login-remember-label").hide():(e.userVO.suspendedFlag,$(".login-remember-label").show())})}else"register"==e.redirectStatus&&fillPartialRegistrationDetails()}},Handler.firstTimeUser={request:function(e){var t=$.trim($("#reset-password-email-field").val());map.email=e.data.email,e.data={userVO:{email:t,streamContentRequiredFlag:!1,userRole:"",userRoleId:"",userActivityVO:{lastActivityCode:"NORMAL_LOGIN_WITHOUT_BOOKACCEESCODE",pageNavigatingFrom:"LOGIN",pageNavigatingTo:""},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}},Utility.showSpinner()},response:function(e){$("#error_msg").html(""),comingFromThanksForRegistration=!1,void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"false"===e.status?(sessionAuthFails(e),"bus.exception.user.not.exists"===e.wkErrorCode?($(".heading-label").next(".error-label").remove(),$("#error_msg").append("No account is associated with that email address."),$("#reset-password-email-field").val("")):"bus.exception.this.is.not.an.activated.account"===e.wkErrorCode||"bus.exception.this.is.not.an.activated.aspenAccount"===e.wkErrorCode?($(".login-validation-msg").css("display","block"),$("#reset-password-email-field").val("")):($("#error_msg").append(e.errorMessg),$("#reset-password-email-field").val("")),Utility.hideSpinner()):"login"==e.redirectStatus?($(".heading-label").next(".error-label").remove(),$("#error_msg").append("You have already registered your account - please return to the <a id='index-automation-log-in' href='login'>Log In page</a>."),Utility.hideSpinner()):(dummyLoginData=e,fillPartialRegistrationDetailsFirstUser())}},Handler.facultyCreateClass={request:function(e){e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_ADD_CLASS",pageNavigatingFrom:"ClassInsight",pageNavigatingTo:"ClassInsight",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"chap01",lastReadSectionId:"sec01",lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:2},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceOS,deviceOS:CaseConnect.deviceMacId,deviceMacId:CaseConnect.deviceType,ipAddress:localStorage.getItem("ipAddress"),sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{className:CaseConnect.currentClassName,classDescription:CaseConnect.currentClassDescription,semesterYear:CaseConnect.currentSemesterYear,section:CaseConnect.currentSectionInfo,meetingTime:CaseConnect.currentMeetingTime,bookId:CaseConnect.currentBookId}},$("#page-loading-spinner").show()},response:function(data,status){if(void 0!==data.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",data.sessionAuthenticationToken),void 0!==localStorage.bookAccessCode&&localStorage.removeItem("bookAccessCode"),"false"===data.status)"You already have a class with this name in your account. Try another.."===data.errorMessg&&($(".faculty-class-name-text").addClass("error-field-bg").after("<span class='error-label error-text'>You already have a class with this name in your account. Try another.</span>"),document.getElementById("faculty-class-name").value="",$("#page-loading-spinner").hide()),sessionAuthFails(data),Utility.handleSessionAuthentication(data.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(data.responseJSON.errorMessg)):window.location=properties.ui_domain,$(window).trigger("resize");else if(data.classVO){if(!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf)for(var bookData=CaseConnect.navigatingAwayFromNewBookshelf,count=0;count<bookData.length;++count)if(bookData[count].bookId==CaseConnect.currentBookId){CaseConnect.currentClassId=lastVisitedClassId,CaseConnect.currentBookId=bookData[count].bookId;break}if(localStorage.setItem("InsideClasInsights",!0),localStorage.setItem("InsideClasInsightsClassDetailCreatedBy",data.classVO.createdBy),localStorage.setItem("InsideClasInsightsCurrentClassId",data.classVO.classId),localStorage.setItem("InsideClasInsightsCurrentBookId",data.classVO.bookId),bookIdWithClassCode=data.classVO.bookId,document.getElementById("faculty-class-name").value=data.classVO.className,document.getElementById("faculty-semester-year").value=data.classVO.semesterYear,document.getElementById("faculty-section-name").value=data.classVO.section,document.getElementById("faculty-meeting-times").value=data.classVO.meetingTime,document.getElementById("faculty-description-detail").value=data.classVO.classDescription,document.getElementById("facultyClassCode").innerHTML=data.classVO.classCode,classDetailCreatedBy=data.classVO.createdBy,CaseConnect.currentClassId=data.classVO.classId,lastVisitedClassId=data.classVO.classId,currentClassCreatedDate=data.classVO.createdDate,classSuccessfullyCreated=!0,$("#faculty-create-class-message").modal("show"),$(".class-insights-header").html("Class Insights"),$("#faculty-save-cancel-buttons").css("display","none"),$("#faculty-save-cancel-buttons-mobile").css("display","none"),$("#after-class-id-generated").show(),$(".faculty-class-insights-code-info-btn").attr("title","This unique Class Code was generated for this class. Share this class code with your students for easy enrollment in your class. Students registered from your school will also be able to browse for your class if you choose not to share the Class Code."),$("#class-insights-heading").text("Class Insights"),$(".class-insights-right-header-wrap").css("display","inline-block"),$("#class-insights-right-header").css("display","inline-block"),$("#right-header-bookTitle").html($(".bookshelf-book-title")[0].innerHTML),$("#right-header-bookTitle").attr("title",$(".bookshelf-book-title")[0].innerHTML),facultyClassNameData=data.classVO.className,facultyFacultyNameData=data.classVO.semesterYear,facultySectionNameData=data.classVO.section,facultyMeetingNameData=data.classVO.meetingTime,facultyDescNameData=data.classVO.classDescription,$(".content-top-menu").show(),$("#faculty-copy-button").attr({"class-description":data.classVO.classDescription,"class-name":"Copy of "+data.classVO.className,"thumbnail-image-path":$(".thumbnail-image")[0].getAttribute("src"),"current-book-title":$(".bookshelf-book-title")[0].innerHTML,copyClassButtonClicked:!0}),$("#registration-create-user-btn").hide(),$("#faculty-updated-class-save").show(),data.classVO){!data.classVO.length>0&&(data.classVO=[data.classVO]);var compiledTemplate1=Handlebars.getTemplate("ereader-classList"),html1=compiledTemplate1(data);$("#class-insights-right-header").append(html1)}var handler="getStudyDashBoardForProfessor",request={},reqData={};request.url="/manageClassWebService/getStudyDashBoardForProfessorOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}$("#page-loading-spinner").hide(),$(window).trigger("resize")}},Handler.validateAccessCode={request:function(e){e.data.bookAccessCode=e.data.bookAccessCode.replace(/ /g,""),map.bookAccessCode=e.data.bookAccessCode,localStorage.bookAccessCode=map.bookAccessCode,e.data={bookVO:e.data,userVO:{userActivityVO:{lastActivityCode:"HOMEPAGE_VALIDATE_BOOKACCEESCODE",pageNavigatingFrom:"Home",pageNavigatingTo:"",lastReadBookId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""}}}},response:function(e,t){if("false"===e.status)sessionAuthFails(e),this.form.find(".access-code-error").html(e.errorMessg),$(".button-cover-home").css("display","inline-block"),$("#buttonLogin").css("display","none"),$("#buttonRegister").css("display","none"),Utility.hideSpinner();else{if(void 0!==e.transactionStatusVO&&"false"==e.transactionStatusVO.validFlag)return"expired"==e.transactionStatusVO.errorMessage?(this.form.find(".access-code-error").html("This access code has already expired and cannot be redeemed."),$(".button-cover-home").css("display","inline-block"),$("#buttonLogin").css("display","none"),$("#buttonRegister").css("display","none"),void Utility.hideSpinner()):(this.form.find(".access-code-error").html("Invalid code."),$(".button-cover-home").css("display","inline-block"),$("#buttonLogin").css("display","none"),$("#buttonRegister").css("display","none"),void Utility.hideSpinner());this.form.find(".access-code-error").html(""),"buttonRegister"==this.attr("id")?(window.history.pushState({page:"createAccount"},null,properties.ui_domain),map.wk_conatiner.load("createAccount.html?v26576",function(){loadCountryListOnRegister(),$(window).scrollTop(0),Utility.hideSpinner()})):(window.history.pushState({page:"login"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain+"login"),map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),$(".login-remember-label").show(),Utility.hideSpinner()}),Utility.trackGA("login"))}}},Handler.createAccount={request:function(e){e.data.userActivityVO={lastActivityCode:"NORMAL_REGISTRATION",pageNavigatingFrom:"REGISTRATION",pageNavigatingTo:""},e.data.sessionVO=map.sessionVO,e.data.email||(e.data.email=$("#reg_email").val(),e.data.confirmEmail=$("#reg_confirmEmail").val());var t=$("select#user-country-name").val();if("United States"===t)"-999"==(a=$("#user-school-name").val())?(e.data.schoolName=$("#user-other-school-name").val(),e.data.schoolId=a,e.data.schoolNotInListFlag="true"):(e.data.schoolName=$("#user-school-name option:selected").text(),e.data.schoolId=$("#user-school-name").val()),delete e.data.other;else if("United States"!==t){var a="-999";e.data.schoolName=$("#user-other-school-name").val(),e.data.schoolId=a,e.data.schoolLocation="NA",e.data.schoolNotInListFlag="true"}""==CaseConnect.aspenCode||"1"!==CaseConnect.aspenCode?(e.data.aspenCode="0",e.data.message="CCuser"):(e.data.aspenCode=CaseConnect.aspenCode,e.data.message="updateuser"),e.data={userVO:e.data,bookVO:{bookAccessCode:map.bookAccessCode}}},response:function(e,t){$("#registration-heading").next(".error-label").remove(),"false"===e.status?(sessionAuthFails(e),e.captchaVO?($(".heading-label").next(".error-label").remove(),$(".heading-label").addClass("").after("<div class='error-label'>Verification failed. Please try again.</div>")):$("#registration-heading").addClass("").after("<div class='error-label'>"+e.errorMessg+"</div>"),Utility.hideSpinner(),grecaptcha.reset()):(map.wk_conatiner.load("thankRegistration.html?v19893",Utility.hideSpinner),map.email=e.userVO.email,map.password=e.userVO.password,e.sessionAuthenticationToken,delete map.bookAccessCode,void 0!==localStorage.bookAccessCode&&localStorage.removeItem("bookAccessCode"))}},Handler.activateUser={request:function(e){e.data.userActivityVO={lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"CREATE_ACCOUNT",pageNavigatingTo:"ACTIVATE_ACCOUNT"},e.data.sessionVO=map.sessionVO,e.data={userVO:e.data}},response:function(e,t){e.status?map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),$(".login-remember-label").show(),Utility.hideSpinner()}):(alert("this is unable to authenticase the user this time. Please try again later"),map.wk_conatiner.load("casebook.html",function(){Utility.hideSpinner(),whatsThisPopover(),practicePackWhatsThisPopover()}))}},Handler.userRegistrationPart2={request:function(e){e.data.userId=map.userId,e.data.userRole=map.userRole,e.data.userRoleId=map.userRoleId,e.data.email=map.email;var t=this.form[0][2],a=this.form[0][0].value;if("United States"===a)"-999"==t.options[t.selectedIndex].value?(e.data.schoolName=e.data.other,e.data.schoolNotInListFlag="true"):e.data.schoolName=t.options[t.selectedIndex].text,delete e.data.other;else if("United States"!==a){e.data.schoolName=e.data.other,e.data.schoolLocation="NA",e.data.schoolNotInListFlag="true"}e.data.userRole=$("span#reg2-user-role").text(),e.data={userVO:e.data},e.data.userVO.userActivityVO={lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"REGISTRATION-PART2",pageNavigatingTo:"BOOKSHELF"},e.data.userVO.sessionVO=map.sessionVO,null!=map.bookAccessCode&&(e.data.bookVO={bookAccessCode:map.bookAccessCode})},response:function(e,t){"false"===e.status?(sessionAuthFails(e),$(".first-time-login-location").next(".error-label").remove(),$(".first-time-login-school ").next(".error-label").remove(),"bus.exception.school.location.is.missing"==e.wkErrorCode?$(".first-time-login-location").addClass("").after("<span class='error-label'> Required</span>"):"bus.exception.schoolid.is.missing"==e.wkErrorCode?$(".first-time-login-school ").addClass("").after("<span class='error-label'> Required. If your school is not listed, select \"Other\"</span>"):"bus.exception.enter.your.school.name.is.not.a.valid.school.name"==e.wkErrorCode&&$(".first-time-login-school ").addClass("").after("<span class='error-label'>Required.</span>"),Utility.hideSpinner()):(e.userVO={userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId},e.userActivityVO={},e.userActivityVO.bookVOList=e.bookVOList,e.regpart2="true",Handler.login.response(e,t))}},Handler.activationEmail={request:function(e){void 0!==this.attr("data-userId")?e.data={userVO:{userId:this.attr("data-userId")}}:e.data={userVO:{email:map.email}},Handler.decorate(e.data)},response:function(e,t){"false"===e.status?(sessionAuthFails(e),Utility.hideSpinner()):(Utility.hideSpinner(),alertMessagesModal("Email sent. Please check your inbox or SPAM folder and follow the instructions."))}},Handler.getBookList={response:function(e,t){if("false"===e.status)sessionAuthFails(e),Utility.hideSpinner();else{localStorage.setItem("getBookList",JSON.stringify(e)),e.userActivityVO=e,e.regpart2="true",e.skipLS=!0;Utility.saveLastActivity({lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"HOME",pageNavigatingTo:"BOOKSHELF"}),void 0===e.userVO&&(e.userVO={}),e.userVO.sessionVO=map.sessionVO,Handler.login.response(e,t)}},processBooks:function(e){e.userActivityVO=e,e.regpart2="true",e.skipLS=!0,Handler.login.response(e)}},Handler.refresh={request:function(e){Utility.showSpinner(),e.data.userVO={userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userAuthenticationWithBookAccessCodeFlag:"false"},e.data.userVO.userActivityVO={lastActivityCode:"NORMAL_LOGIN_WITHOUT_BOOKACCEESCODE",pageNavigatingFrom:"HOME",pageNavigatingTo:""},e.data.userVO.sessionVO=map.sessionVO,"true"==CaseConnect.permalinkOrigin?(e.data.userVO.resLink=permalinkUrl,e.data.userVO.linkFlag=!0):e.data.userVO.linkFlag=!1,null!==localStorage.getItem("currentProductId")&&(e.data.userVO.enableComparison="true",e.data.userVO.productId=localStorage.getItem("currentProductId"))},response:function(data,textStatus){if("false"===data.status)sessionAuthFails(data),Utility.hideSpinner();else if(CaseConnect.freeTrialFlag=localStorage.getItem("freeTrialFlag"),CaseConnect.adminStudyFlag=localStorage.getItem("adminStudyFlag"),CaseConnect.adminOutlineFlag=localStorage.getItem("adminOutlineFlag"),CaseConnect.adminInsightsFlag=localStorage.getItem("adminInsightsFlag"),CaseConnect.adminNewsFlag=localStorage.getItem("adminNewsFlag"),null!=localStorage.getItem("resetFlag")&&null!=localStorage.getItem("resetFlag")&&"true"==localStorage.getItem("resetFlag"))map.wk_conatiner.load("continueLogin.html?v26576",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").hide(),$(".reset-login-blk").show(),$(".static-page-bar").hide(),$(".footer-link").hide(),$(".login-remember-label").show(),Utility.hideSpinner()});else if(null!=localStorage.getItem("themisAdminlanding")&&null!=localStorage.getItem("themisAdminlanding")&&("true"==localStorage.getItem("themisAdminlanding")?themisAdminlanding=!0:themisAdminlanding=!1),data.userActivityVO){null!=data.userActivityVO.errorMsg&&null!=data.userActivityVO.errorMsg&&("NoResource"==data.userActivityVO.errorMsg?alertMessagesModal("You don't have access for this link"):"InvalidLink"==data.userActivityVO.errorMsg&&alertMessagesModal("Invalid Link"));var lastActivityCode=data.userActivityVO.lastActivityCode;if(lastActivityCode.indexOf("REGISTRATION-PART2")>=0)Utility.showSpinner(),Handler.login.loadAlmostThere(data.userActivityVO.userResponseVO);else if(lastActivityCode.indexOf("BOOKSHELF")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),"Professor"===map.userRole?Handler.login.loadProfessorBookshelf(data):Handler.login.loadBookshelf(data);else if(lastActivityCode.indexOf("EREADER")>=0)addBookshelfLinkTOLogo(),data.userActivityVO.bookVOList&&(CaseConnect.currentBookId=data.userActivityVO.bookVOList.bookId),expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("STUDY_CENTER")>=0)addBookshelfLinkTOLogo(),CaseConnect.currentBookId=data.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookId,expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("MYACCOUNT_VIEW")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.loadMyAccount(data.userActivityVO);else if(lastActivityCode.indexOf("OUTLINE")>=0)CaseConnect.currentBookId=data.userActivityVO.lastReadBookId,$("body").removeClass("modal-open"),addBookshelfLinkTOLogo(),expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("RESOURCE")>=0)addBookshelfLinkTOLogo(),void 0!==data.userActivityVO.bookVO&&(CaseConnect.currentBookId=data.userActivityVO.bookVO.bookId),expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("CASE_")>=0)addBookshelfLinkTOLogo(),data.userActivityVO.bookVO&&(CaseConnect.currentBookId=data.userActivityVO.bookVO.bookId),expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("MANAGE_CONNECTION_PAGE")>=0)$("#page-loading-spinner").show(),addBookshelfLinkTOLogo(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),Handler.login.updateStatusBar(),$(".bookshelflink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),loadManageConnectionFromCOGLogin(data),Utility.trackGA("cases");else if(lastActivityCode.indexOf("NEWS_PAGE")>=0)addBookshelfLinkTOLogo(),data.userActivityVO.bookVO&&(CaseConnect.bookData=data.userActivityVO.bookVO,CaseConnect.bookTitle=data.userActivityVO.bookVO.bookTitle,CaseConnect.currentBookId=data.userActivityVO.bookVO.bookId,CaseConnect.bookType=data.userActivityVO.bookVO.bookType),expiryDateForLoginandRefresh(data);else if(lastActivityCode.indexOf("CLASS_INSIGHT_GET_CLASS")>=0)classInsightsRefresh=!0,Utility.showSpinner(),addBookshelfLinkTOLogo(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide");else if(lastActivityCode.indexOf("CLASS_INSIGHT_GET_STUDY_DASHBOARD")>=0)classInsightsRefresh=!0,Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.getClassDetails.processClassDetails(data.userActivityVO);else if(lastActivityCode.indexOf("CLASS_INSIGHT_ENROLL_STUDENT_IN_CLASS")>=0||lastActivityCode.indexOf("CLASS_INSIGHT_GET_PROFESSORS_AND_CLASSES_FOR_ENROLL_STUDENT")>=0){var handler="goToBookShelf",request={},data={};request.url="/bookShelfRetrivalService/getBookList",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}else if(lastActivityCode.indexOf("GLOBAL_SEARCH")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),globalSearchKeyword=localStorage.getItem("globalSearchKeyword"),loadGlobalSearchResult(globalSearchKeyword);else if(lastActivityCode.indexOf("THEMIS_PRODUCT_LANDING_PAGE")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),loadThemisBarProduct(data),adjustLeftNavHeight();else if(lastActivityCode.indexOf("THEMIS_ADMIN")>=0){CaseConnect.currentProductId=localStorage.getItem("currentProductId"),Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar();var startDate="",endDate="";data.userActivityVO.themisProductVO&&(startDate=separateDateTimeZon(data.userActivityVO.themisProductVO.startDateInDateFormat),endDate=separateDateTimeZon(data.userActivityVO.themisProductVO.endDateInDateFormat)),map.wk_conatiner.load("themis-admin-landing.html?v5",function(){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideBarCheck=!0,themisLandingPage=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideThemis=!1,insideThemisAdmin=!0,insideCQuizzing=!1,insidePracticePerfect=!1,CaseConnect.themisSubjectAreaId="",CaseConnect.themisCurrentSubjectAreaTitle="",navBarAdmin(),coursesPage(),quizzesPage(),$(".ereader-main-header-title").html(""),$(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),$(".navbar-ipad-section").children().removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().children().removeClass("border-bottom-blue"),null!=localStorage.getItem("mbeAdminSchoolName")&&null!=localStorage.getItem("mbeAdminSchoolName")&&($(".nav-ipad-saTitleName.institution-name").html(localStorage.getItem("mbeAdminSchoolName")),$(".nav-ipad-saTitleName.institution-name").attr("title",localStorage.getItem("mbeAdminSchoolName"))),"THEMIS_ADMIN_COURSE_LANDING_PAGE"==lastActivityCode){if(data.userActivityVO.dateFilterValidationStatus&&("Both_active_and_expired_users"!=data.userActivityVO.dateFilterValidationStatus&&"All_Active_users"!=data.userActivityVO.dateFilterValidationStatus?($("#themis-course-admin-progress").html($(".no-data-present-students")[0].outerHTML),$("#themis-course-admin-progress .no-data-present-students").show(),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts.")):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate),$(".themis-course-name").html(localStorage.getItem("CurrentSubjectAreaTitle"))),data.userActivityVO.themisResultVOList){"object"==$.type(data.userActivityVO.themisResultVOList)&&(data.userActivityVO.themisResultVOList=[data.userActivityVO.themisResultVOList]),themisStudentCourseProgressReport=data.userActivityVO.themisResultVOList;var e=Handlebars.getTemplate("themis-bar-landing-courses")(data.userActivityVO);$("#themis-course-admin-progress").html(e),CaseConnect.themisSubjectAreaId=localStorage.getItem("themisSaId"),CaseConnect.themisCurrentSubjectAreaTitle=localStorage.getItem("CurrentSubjectAreaTitle"),skillSetCalc(data.userActivityVO.themisResultVOList,"course"),$(".themis-course-name").html(localStorage.getItem("CurrentSubjectAreaTitle")),$(".themis-admin-quiz-btn").attr("satitle",localStorage.getItem("CurrentSubjectAreaTitle")),$(".themis-admin-quiz-btn").attr("themisSaId",localStorage.getItem("themisSaId")),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),generalList=data.userActivityVO,highestPerformance=data.userActivityVO.themisResultVOList,lowestPerformance=data.userActivityVO.themisResultVOList,alphabetical=data.userActivityVO.themisResultVOList,mostComplete=data.userActivityVO.themisResultVOList,leastComplete=data.userActivityVO.themisResultVOList,lowestPerformance=lowestPerformanceFunc(lowestPerformance),mostComplete=mostCompleteFunc(mostComplete),leastComplete=leastCompleteFunc(leastComplete),alphabetical=alphabeticalLastNameFunc(alphabetical),highestPerformance=exactJsonCourses(highestPerformance),lowestPerformance=exactJsonCourses(lowestPerformance),mostComplete=exactJsonCourses(mostComplete),leastComplete=exactJsonCourses(leastComplete),alphabetical=exactJsonCourses(alphabetical),quartileJsonPreparation("course")}else themisStudentCourseProgressReport=[];$(".navbar-ipad.courses").addClass("border-bottom-blue")}else if("THEMIS_ADMIN_STUDENT_LANDING_PAGE"==lastActivityCode){if(data.userActivityVO.dateFilterValidationStatus&&("Both_active_and_expired_users"!=data.userActivityVO.dateFilterValidationStatus&&"All_Active_users"!=data.userActivityVO.dateFilterValidationStatus?($("#themis-course-admin-progress").html($(".no-data-present-students")[0].outerHTML),$("#themis-course-admin-progress .no-data-present-students").show(),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts.")):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate)),data.userActivityVO.themisResultVOList){"object"==$.type(data.userActivityVO.themisResultVOList)&&(data.userActivityVO.themisResultVOList=[data.userActivityVO.themisResultVOList]),themisStudentDynamicReport=data.userActivityVO.themisResultVOList;e=Handlebars.getTemplate("themis-bar-landing-students")(data.userActivityVO);$("#themis-course-admin-progress").html(e),skillSetCalc(data.userActivityVO.themisResultVOList,"student"),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate),$(window).trigger("resize"),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),generalList=data.userActivityVO,highestPerformance=data.userActivityVO.themisResultVOList,lowestPerformance=data.userActivityVO.themisResultVOList,alphabetical=data.userActivityVO.themisResultVOList,mostComplete=data.userActivityVO.themisResultVOList,leastComplete=data.userActivityVO.themisResultVOList,lowestPerformance=lowestPerformanceFunc(lowestPerformance),mostComplete=mostCompleteFunc(mostComplete),leastComplete=leastCompleteFunc(leastComplete),alphabetical=alphabeticalLastNameFunc(alphabetical),highestPerformance=exactJsonStudent(highestPerformance),lowestPerformance=exactJsonStudent(lowestPerformance),mostComplete=exactJsonStudent(mostComplete),leastComplete=exactJsonStudent(leastComplete),alphabetical=exactJsonStudent(alphabetical),quartileJsonPreparation("student")}else themisStudentDynamicReport=[];$(".navbar-ipad.students").addClass("border-bottom-blue")}else if("THEMIS_ADMIN_INSTITUTION_LANDING_PAGE"==lastActivityCode){data.userActivityVO.dateFilterValidationStatus&&("Both_active_and_expired_users"!=data.userActivityVO.dateFilterValidationStatus&&"All_Active_users"!=data.userActivityVO.dateFilterValidationStatus?($("#themis-course-admin-progress").html($(".no-data-present-students")[0].outerHTML),$("#themis-course-admin-progress .no-data-present-students").show(),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts.")):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate));var t=[];data.userActivityVO.themisSubjectAreaVOList?(t=data.userActivityVO.themisSubjectAreaVOList,"object"==$.type(t)&&(t=[t])):(t=JSON.parse(localStorage.getItem("themisSubjectAreaVOList")),data.userActivityVO.themisSubjectAreaVOList=t),themisSubjectAreaVOListForReport=t;var a=Handlebars.getTemplate("themis-bar-landing-institution")(data.userActivityVO);$("#themis-course-admin-progress").html(a),$(".navbar-ipad-section").children().removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().children().removeClass("border-bottom-blue"),$(".navbar-ipad.institution").addClass("border-bottom-blue"),$("#themisAdminCourses-popover li a").removeClass("border-bottom-blue"),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate),loadThemisBarInstitution(),"No_exam_data_available"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No exam data available for specified date range."):"No_active_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No active users for specified date range."):"All_expired_users"==data.userActivityVO.dateFilterValidationStatus?$(".courses-filter-results.themis-message p").html("No enrolled students for specified date range."):"Both_active_and_expired_users"==data.userActivityVO.dateFilterValidationStatus&&$(".courses-filter-results.themis-message p").html("Date range includes data from users with expired accounts."),generalList=data.userActivityVO,highestPerformance=t,lowestPerformance=t,alphabetical=t,mostComplete=t,leastComplete=t,lowestPerformance=lowestPerformanceFunc(lowestPerformance),mostComplete=mostComplete.slice().sort(function(e,t){return z1=parseFloat(e.averageAnsweredQuestions),z2=parseFloat(t.averageAnsweredQuestions),(null===z1)-(null===z2)||-(z1>z2)||+(z1<z2)}),leastComplete=leastComplete.slice().sort(function(e,t){return z1=parseFloat(e.averageAnsweredQuestions),z2=parseFloat(t.averageAnsweredQuestions),(null===z1)-(null===z2)||+(z1>z2)||-(z1<z2)}),alphabetical=alphabetical.slice().sort(function(e,t){return c1=e.subjectAreaName.toLowerCase(),c2=t.subjectAreaName.toLowerCase(),c1<c2?-1:c1>c2?1:0}),highestPerformance=exactJsonInstitution(highestPerformance),lowestPerformance=exactJsonInstitution(lowestPerformance),mostComplete=exactJsonInstitution(mostComplete),leastComplete=exactJsonInstitution(leastComplete),alphabetical=exactJsonInstitution(alphabetical),$(window).trigger("resize")}else if("THEMIS_ADMIN_STUDENT_PROFILE_PAGE"==lastActivityCode){t=data.userActivityVO.themisSubjectAreaVOList;if("object"==$.type(t)&&(t=[t]),CaseConnect.themisSubjectAreaVOList=t,localStorage.setItem("saVOList",JSON.stringify(CaseConnect.themisSubjectAreaVOList)),$("#page-loading-spinner").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#generic-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideBarCheck=!1,themisLandingPage=!1,insideThemis=!1,insideThemisAdmin=!0,insideCQuizzing=!1,insidePracticePerfect=!1,insideThemisStudProfile=!0,insideAdminQuiz=!1,CaseConnect.newsFeedFlag=!1,CaseConnect.resourceFlag=!1,$(".ereader-main-header-title").html(""),$(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),"true"===comingFromThemis)return void getCheckPointsByThemisSA();a=Handlebars.getTemplate("themis-bar-landing-studProfile")(data.userActivityVO);if($("#themis-course-admin-progress").html(a),$(".studName").html(localStorage.getItem("studName")),studName=localStorage.getItem("studName"),null!=startDate&&""!=startDate&&null!=startDate&&$("#startFilter").val(startDate),null!=endDate&&""!=endDate&&null!=endDate&&$("#endFilter").val(endDate),void 0!==data.userActivityVO.themisSubjectAreaVOList){t=data.userActivityVO.themisSubjectAreaVOList;"object"==$.type(t)&&(t=[t]);for(var s=0;s<t.length;s++)if(void 0!==t[s].themisResultVOList){var o=t[s].themisResultVOList;"object"==$.type(o)&&(o=[o]);for(var i=0,r=0;r<o.length;r++)"In Progress"===o[r].quizStatus&&i++;i===o.length&&$(".themis-sa-radio-selector button[subjectAreaId='"+t[s].subjectAreaId+"']").hide()}}$(".navbar-ipad-section").children().removeClass("border-bottom-blue"),getStudentBarOMeter(localStorage.getItem("searchedUserId"))}$(window).trigger("resize"),adjustLeftNavHeight()}),Utility.hideSpinner()}else if(lastActivityCode.indexOf("THEMIS_CHECKPOINT_PAGE")>=0){Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),CaseConnect.themisSubjectAreaId=data.userActivityVO.themisSubjectAreaId,CaseConnect.currentProductId=data.userActivityVO.themisProductId,localStorage.setItem("currentProductId",CaseConnect.currentProductId);var contentData=data.userActivityVO;themisAdminlanding?map.wk_conatiner.load("themis-admin-landing.html?v5",function(){insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!0,insideCQuizzing=!1,insidePracticePerfect=!1,insideThemisStudProfile=!1,insideAdminQuiz=!0,navBarAdmin(),coursesPage(),quizzesPage(),$(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),null!=localStorage.getItem("mbeAdminSchoolName")&&null!=localStorage.getItem("mbeAdminSchoolName")&&($(".nav-ipad-saTitleName.institution-name").html(localStorage.getItem("mbeAdminSchoolName")),$(".nav-ipad-saTitleName.institution-name").attr("title",localStorage.getItem("mbeAdminSchoolName"))),loadCheckPointsByThemisSA(contentData)}):map.wk_conatiner.load("themis-landing.html?v1",function(){insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!0,themisStudentQuizzesPage(),$(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),CaseConnect.themisSubjectAreaVOList=JSON.parse(localStorage.getItem("saVOList"));for(var e=CaseConnect.themisSubjectAreaVOList,t=0;t<e.length;t++)if(e[t].themisSubjectAreaId===CaseConnect.themisSubjectAreaId){CaseConnect.bookType=e[t].bookType,CaseConnect.currentBookId=e[t].bookId,CaseConnect.resourceFlag=e[t].resourceFlag,CaseConnect.casesFlag=e[t].casesFlag,CaseConnect.newsFeedFlag=e[t].newsFeedFlag;break}loadCheckPointsByThemisSA(contentData)})}else if(lastActivityCode.indexOf("CQ_PROFESSOR_RESULT_SUMMARY_PAGE")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),$("#myModalStart").modal("hide"),$(".modal-backdrop").remove(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){$("#cQuiz-landing-content-area").remove(),$(".cquizHeaderContainer").after('<div id="res-prof-sam" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"></div>'),$("#res-prof-sam").load("professor-QuizDetailedResult-landing.html?v26576",function(){if(data.userActivityVO.cqClassVO&&($(".backToQuiz a").attr("onclick","connectQuizProfLanding(null,"+data.userActivityVO.cqClassVO.semesterId+")"),getSemesterBySchoolId(data.userActivityVO.cqClassVO.semesterId)),$(".proff-ResultClassName-header").html(localStorage.getItem("quizNameString")),$(".breadCrumbSection .studSemesterNames").html(localStorage.getItem("classNameString")),$(".breadCrumbSection.startEnd").html(localStorage.getItem("startDateEndDate")),$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML=localStorage.getItem("btn-sec"),$(".completedBtn").text(localStorage.getItem("progresString")),"C"==localStorage.getItem("progresString")[0]?$(".completedBtnGroup").css("background","#dadada"):$(".completedBtnGroup").css("background","#A6D1EB"),previewQuestionPrint(data.userActivityVO.qpQuizIdentifier,data.userActivityVO.cqClassId,data.userActivityVO.cqClassVO.semesterId,data.userActivityVO.cqClassVO.qpProductId),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("quizIdentifier",data.userActivityVO.qpQuizIdentifier),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("classId",data.userActivityVO.cqClassId),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("semId",localStorage.getItem("semId")),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("qpId",data.userActivityVO.cqClassVO.qpProductId),data.userActivityVO.cqResultVO){var e=Handlebars.getTemplate("professor-quizDetailedResults")(data.userActivityVO.cqResultVO);$("#profCQuiz-detailedResult-progress").html(e)}var t=$(".btn-sec button");t=t.length>1?t[1]:t[0],$(t).hasClass("assigned")?($("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide()):$(t).hasClass("completed")?($("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide()):$(t).hasClass("futureAssign")?$(".preview-page").show():($(".preview-page").show(),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide()),adjustLeftNavHeight(),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show(),$(window).trigger("resize")})});else if(lastActivityCode.indexOf("CQ_PROFESSOR_DASHBOARD")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,data.userActivityVO.cqClassVOList){var cqClassVOList=data.userActivityVO.cqClassVOList;"object"==$.type(cqClassVOList)&&(cqClassVOList=[cqClassVOList]);for(var i=0;i<cqClassVOList.length;i++)"object"==$.type(cqClassVOList[i].classQuizVOList)&&(cqClassVOList[i].classQuizVOList=[cqClassVOList[i].classQuizVOList]);map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){getSemesterBySchoolId(cqClassVOList[0].semesterId);var e=Handlebars.getTemplate("connect-Quiz-landing")(cqClassVOList);$("#cQuiz-course-admin-progress").html(e),$(".contactAssessmentSpecialistId").show(),adjustLeftNavHeight(),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show(),$(window).trigger("resize")})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("CQ_STUDENT_DASHBOARD_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,data.userActivityVO.cqClassVOList){var cqClassVOList=data.userActivityVO.cqClassVOList;"object"==$.type(cqClassVOList)&&(cqClassVOList=[cqClassVOList]);for(var i=0;i<cqClassVOList.length;i++)cqClassVOList[i].qpQuizVOList&&"object"==$.type(cqClassVOList[i].qpQuizVOList)&&(cqClassVOList[i].qpQuizVOList=[cqClassVOList[i].qpQuizVOList]);map.wk_conatiner.load("connectQuizStudent-landing.html?v4",function(){var e=Handlebars.getTemplate("student-connect-Quiz-landing")(cqClassVOList);$("#studCQuiz-course-admin-progress").html(e),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),$(".timeLeftShow").each(function(){"Not Submitted"==$(this).html()&&($(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn ").addClass("studQuizCompleteBtn"),$(this).prev(".btn-primary").attr("quizStatus","ended"))}),ConnectQuizSetSection(),adjustLeftNavHeight(),$(window).trigger("resize");var t=localStorage.getItem("classCodeAddSectionRefresh");null!=t&&null!=t&&"undefined"!=t&&($(".classCodeAddSectionHeaderpart").html(t),$(".add-classCode").attr("onclick",'redeemClassCode(event,"CQ_STUDENT_DASHBOARD_PAGE")'))})}else map.wk_conatiner.load("connectQuizStudent-landing.html?v4",function(){var e=localStorage.getItem("classCodeAddSectionRefresh");null!=e&&null!=e&&"undefined"!=e&&($(".classCodeAddSectionHeaderpart").html(e),$(".add-classCode").attr("onclick",'redeemClassCode(event,"CQ_STUDENT_DASHBOARD_PAGE")')),ConnectQuizSetSection(),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),adjustLeftNavHeight()});$("#page-loading-spinner").hide()}else if(lastActivityCode.indexOf("CQ_STUDENT_RESULT_SUMMARY_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,data.userActivityVO.qpQuizVO){var qpQuizVO=data.userActivityVO.qpQuizVO,semSection=localStorage.getItem("classNameString"),quizName=localStorage.getItem("quizNameString"),submittedDate=localStorage.getItem("submittedDate"),dueDate=localStorage.getItem("dueDate");map.wk_conatiner.load("student-QuizDetailedResult-landing.html?v2",function(){var e=Handlebars.getTemplate("student-quizDetailedResults")(qpQuizVO);$("#studCQuiz-detailedResult-progress").html(e),$(".stud-ResultClassName-header").html(quizName),$(".breadCrumbSection").html(semSection),$(".submittedBtnGroup").html(submittedDate),$(".detailedResultsDueDate").html(dueDate),getStudentResultSummary(data.userActivityVO.qpQuizIdentifier,data.userActivityVO.instanceId,data.userActivityVO.cqClassId),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),adjustLeftNavHeight(),$(window).trigger("resize")})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_VIDEO_DASHBOARD_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppTopicVOList){"object"==$.type(data.userActivityVO.ppTopicVOList)&&(data.userActivityVO.ppTopicVOList=[data.userActivityVO.ppTopicVOList]);for(var i=0;i<data.userActivityVO.ppTopicVOList.length;i++)"object"==$.type(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList=[data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").show(),$(".searchInput").val("");var t=Handlebars.getTemplate("pp-video-resluts")(data.userActivityVO);$("#subVideoSection").html(t),getRecentlyWatchedVideo(),getFeaturedVideo(),$(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".videosGroupContainer").show(),adjustLeftNavHeight(),$(window).trigger("resize")})}else $(".videosGroupContainer").hide(),localStorage.removeItem("ppTopicVOList");Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_SEARCH_RESULTS_PAGE")>=0)Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").show(),$(".searchInput").val(localStorage.getItem("ppSearch")),searchPP(),adjustLeftNavHeight(),$(window).trigger("resize")}),Utility.hideSpinner();else if(lastActivityCode.indexOf("PP_QUIZ_CENTER_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppQuizResultVOList){"object"==$.type(data.userActivityVO.ppQuizResultVOList)&&(data.userActivityVO.ppQuizResultVOList=[data.userActivityVO.ppQuizResultVOList]);for(var i=0;i<data.userActivityVO.ppQuizResultVOList.length;i++)"object"==$.type(data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList=[data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("area-of-improvement.html?v17",function(){var e=Handlebars.getTemplate("getsummativequizzez")(data.userActivityVO);$("#practicePerfect-getsummativequizzezContainer").html(e),$("#practicePerfect-getsummativequizzezContainer").show(),$("#practicePerfect-areaofimprovementContainer").hide(),$("#practicePerfect-summativeContainer").hide(),$("#practicePerfect-getsummativequizzezContainer").show(),"true"==data.userActivityVO.hasPreviouslyWatchedVideos?$("#hidepreviouswatched").show():$("#hidepreviouswatched").hide(),getActiveQuizzes(),getAreaOfImprovementTagId(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$(window).trigger("resize")})})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_PREVIOUSLY_WATCHED_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppTopicVOList){"object"==$.type(data.userActivityVO.ppTopicVOList)&&(data.userActivityVO.ppTopicVOList=[data.userActivityVO.ppTopicVOList]);for(var i=0;i<data.userActivityVO.ppTopicVOList.length;i++)data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList&&"object"==$.type(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList=[data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Previously Watched");var e=Handlebars.getTemplate("build-your-ownQuiz")(data.userActivityVO);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".hidden-quizzes-progress").hide(),$(".selectDeselectClassText").hide(),$("#maxQues-parent").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Previously Watched','true')"),$(window).trigger("resize")})})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_BUILD_YOUR_OWN_QUIZ_PAGE")>=0){Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0;var ppTopic=JSON.parse(localStorage.getItem("ppTopicVOList")),data={ppTopicVOList:ppTopic};map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Build Your Own Quiz");var e=Handlebars.getTemplate("build-your-ownQuiz")(data);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".hidden-quizzes-progress").hide(),$("#maxQues-parent").hide(),null!=data.ppTopicVOList&&null!=data.ppTopicVOList||$(".selectDeselectClassText").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Build Your Own Quiz','true')"),$("#pp-container-hide").show(),$(window).trigger("resize")})}),Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_SUMMATIVE_LANDING_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppQuizResultVO){"object"==$.type(data.userActivityVO.ppQuizResultVO)&&(data.userActivityVO.ppQuizResultVO=[data.userActivityVO.ppQuizResultVO]);for(var i=0;i<data.userActivityVO.ppQuizResultVO.length;i++)data.userActivityVO.ppQuizResultVO[i].ppSubTopicVOList&&"object"==$.type(data.userActivityVO.ppQuizResultVO[i].ppSubTopicVOList)&&(data.userActivityVO.ppQuizResultVO[i].ppSubTopicVOList=[data.userActivityVO.ppQuizResultVO[i].ppSubTopicVOList]);var seleId=data.userActivityVO.ppQuizResultVO[0].quizIdentifier,subtopicList=data.userActivityVO.ppQuizResultVO[0].ppSubTopicVOList,totalQues=data.userActivityVO.ppQuizResultVO[0].totalQuestions,quizType=data.userActivityVO.ppQuizResultVO[0].quizType,subTopicId="",subTopicName=data.userActivityVO.ppQuizResultVO[0].ppTopicNames,data="";"string"==$.type(subTopicName)&&(subTopicName=[subTopicName]),subTopicName=subTopicName.join(", ");for(var i=0;i<subtopicList.length;i++)i!=subtopicList.length-1?subTopicId+=subtopicList[i].subTopictagId+",":subTopicId+=subtopicList[i].subTopictagId;map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizName").html(quizType+": "+subTopicName);var e=Handlebars.getTemplate("build-your-ownQuiz")(data);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$("#hideSummativeA").hide(),$("#practicePerfect-buildYourOwnQuizContainer").show(),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+quizType+"','true','"+subTopicId+"',"+totalQues+")"),$("#maxQues-parent").show(),$("#maxQues").html(totalQues),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+quizType+"','true','"+subTopicId+"',"+totalQues+")"),$(window).trigger("resize")})})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_AREA_OF_IMPROVEMENT_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppTopicVOList){"object"==$.type(data.userActivityVO.ppTopicVOList)&&(data.userActivityVO.ppTopicVOList=[data.userActivityVO.ppTopicVOList]);for(var i=0;i<data.userActivityVO.ppTopicVOList.length;i++)data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList&&"object"==$.type(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList=[data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Area for Improvement");var e=Handlebars.getTemplate("build-your-ownQuiz");aoiTopicVoList=data.userActivityVO.ppTopicVOList;var t=e(data.userActivityVO);$("#practicePerfect-buildYourOwnQuizContainer").html(t),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#maxQues-parent").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Areas for Improvement','true')"),$(window).trigger("resize")})})}else aoiTopicVoList="";Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_RESULT_SUMMARY_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppQuizResultVO){var ppQuizResultVO=data.userActivityVO.ppQuizResultVO;"object"==$.type(ppQuizResultVO)&&(ppQuizResultVO=[ppQuizResultVO]);for(var i=0;i<ppQuizResultVO.length;i++)ppQuizResultVO[i].QPQuestionVOList&&"object"==$.type(ppQuizResultVO[i].QPQuestionVOList)&&(ppQuizResultVO[i].QPQuestionVOList=[ppQuizResultVO[i].QPQuestionVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var e=Handlebars.getTemplate("progress-dashboardpage")(ppQuizResultVO);if($("#practicePerfect-progressContainer").html(e),$("#view-more-parent").hide(),$("#practicePerfect-progressContainer").show(),$("#child-progress-container").hide(),"video"==ppQuizResultVO[0].quizType?($(".backToVideoBtn").attr("onclick","getAllVideoTracker('"+ppQuizResultVO[0].ppSubTopicVO.subTopictagId+"')"),$(".backToVideoBtn").html("Back to Video"),$(".retakeBtnGroup").show(),$(".backRetakeGroup").css("float","left"),$(".yesRetakeBtn").attr("onclick","createInstanceforPPQuiz('"+ppQuizResultVO[0].quizIdentifier+"','video',true,'"+ppQuizResultVO[0].ppSubTopicVO.subTopictagId+"','"+ppQuizResultVO[0].ppSubTopicVO.totalQuestions+"',300)")):($(".backToVideoBtn").attr("onclick","quizPage()"),$(".backToVideoBtn").html("Back to Quiz Center"),$(".retakeBtnGroup").hide(),$(".backRetakeGroup").css("float","right")),data.userActivityVO.ppVideoQuizResultVOList){"object"==$.type(data.userActivityVO.ppVideoQuizResultVOList)&&(data.userActivityVO.ppVideoQuizResultVOList=[data.userActivityVO.ppVideoQuizResultVOList]);for(var t=$(".retakeBtnGroup button").attr("subtopictagid"),a=$(".retakeBtnGroup button").attr("totalquestions"),s=0;s<data.userActivityVO.ppVideoQuizResultVOList.length;s++)"true"==data.userActivityVO.ppVideoQuizResultVOList[s].isGraded?"true"==data.userActivityVO.ppVideoQuizResultVOList[s].isCompleted?($(".retakeBtnGroup button").html("Retake Graded Quiz"),$(".retakeBtnGroup button").attr("evtClick","createInstanceforPPQuiz('"+data.userActivityVO.ppVideoQuizResultVOList[s].quizIdentifier+"','video',true,'"+t+"',"+a+",300)"),$(".retakeBtnGroup button").attr("onclick","retakeQuizFun(event)")):data.userActivityVO.ppVideoQuizResultVOList[s].instanceURL?($(".retakeBtnGroup button").html("Continue Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","showQuizFrame('"+data.userActivityVO.ppVideoQuizResultVOList[s].instanceURL+"','pp','video','"+t+"',event)"),$(".retakeBtnGroup button").attr("instanceId",data.userActivityVO.ppVideoQuizResultVOList[s].instanceId)):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+t+"',"+a+")")):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+t+"',"+a+")"))}for(s=0;s<ppQuizResultVO[0].QPQuestionVOList.length;s++){var o=ppQuizResultVO[0].QPQuestionVOList[s].questionIdentifier;if("false"==ppQuizResultVO[0].QPQuestionVOList[s].correct){var i="";if(ppQuizResultVO[0].QPQuestionVOList[s].choiceId){i=ppQuizResultVO[0].QPQuestionVOList[s].choiceId,$("#question"+o+" #"+i).removeClass("result-block").addClass("result-blockRemove");var r=$("#question"+o+" #"+i).html();$("#question"+o+" #"+i).html('<span class=" ppTickposition glyphicon glyphicon-remove"></span>'+r),$("#question"+o+" #"+i+" .ppindex").addClass("ppglyp")}}}$(window).trigger("resize")})}),$("#page-loading-spinner").hide()}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_VIDEO_LANDING_PAGE")>=0){var subTopictagId,totalQues,modeType,continuousVideoPath,interactiveVideoPath;if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppSubTopicVO)data.userActivityVO.ppSubTopicVO.continuousVideoPath?(continuousVideoPath=data.userActivityVO.ppSubTopicVO.continuousVideoPath,localStorage.setItem("continuousVideoPath",continuousVideoPath)):continuousVideoPath=null,data.userActivityVO.ppSubTopicVO.interactiveVideoPath?(interactiveVideoPath=data.userActivityVO.ppSubTopicVO.interactiveVideoPath,localStorage.setItem("interactiveVideoPath",interactiveVideoPath)):interactiveVideoPath=null,subTopictagId=data.userActivityVO.ppSubTopicVO.subTopictagId,totalQues=data.userActivityVO.ppSubTopicVO.totalQuestions?data.userActivityVO.ppSubTopicVO.totalQuestions:void 0,map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("pp-videoPage.html?v25",function(){data.userActivityVO.ppSubTopicVO.modeType?"interactive"==(modeType=data.userActivityVO.ppSubTopicVO.modeType)?null==interactiveVideoPath||null==interactiveVideoPath?($("#videoPlayed iframe").attr("src",continuousVideoPath),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()):($("#videoPlayed iframe").attr("src",interactiveVideoPath),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",continuousVideoPath),$("#ppVideoFormat").val("continuous"),null!=interactiveVideoPath&&null!=interactiveVideoPath||($("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove())):interactiveVideoPath?($("#videoPlayed iframe").attr("src",interactiveVideoPath),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",continuousVideoPath),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()),data.userActivityVO.ppSubTopicVO.customerFacingSubTopicName&&($(".userClassNameStyles").html(data.userActivityVO.ppSubTopicVO.customerFacingSubTopicName),$(".userClassNameStyles").attr("subTopictagId",data.userActivityVO.ppSubTopicVO.subTopictagId)),totalQues?($("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+subTopictagId+'","'+totalQues+'")'),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+subTopictagId+'","'+totalQues+'")')):$(".vidSecContiner").html('<div class="display-inline-block col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"><div class="display-inline-block no-quiz">There is no quiz for this video.</div></div>'),$(".practiceResultLink").hide(),$(".gradedResultLink").hide();var e=localStorage.getItem("ppProductTitle");if($(".ereader-main-header-title").html("PracticePerfect: "+e),$("#pp-container-hide").show(),data.userActivityVO.ppQuizResultVOList){"object"==$.type(data.userActivityVO.ppQuizResultVOList)&&(data.userActivityVO.ppQuizResultVOList=[data.userActivityVO.ppQuizResultVOList]);for(var t=0;t<data.userActivityVO.ppQuizResultVOList.length;t++)"true"==data.userActivityVO.ppQuizResultVOList[t].isGraded?"true"==data.userActivityVO.ppQuizResultVOList[t].isCompleted?($(".gradedResultLink").show(),$(".gradedResultLink").attr("instanceid",data.userActivityVO.ppQuizResultVOList[t].instanceId),$(".gradedResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#gradedMode").attr("evtClick",'createInstanceforPPQuiz("'+data.userActivityVO.ppQuizResultVOList[t].quizIdentifier+'","video",true,"'+subTopictagId+'","'+totalQues+'",300)'),$("#gradedMode").attr("onclick","retakeQuizFun(event)"),$("#gradedMode").html("Retake Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn")):($(".gradedResultLink").hide(),data.userActivityVO.ppQuizResultVOList[t].instanceURL?($("#gradedMode").html("Continue Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn"),$("#gradedMode").attr("onclick",'showQuizFrame("'+data.userActivityVO.ppQuizResultVOList[t].instanceURL+'","pp","video","'+subTopictagId+'",event)'),$("#gradedMode").attr("instanceId",data.userActivityVO.ppQuizResultVOList[t].instanceId)):($("#gradedMode").html("Graded Mode"),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+subTopictagId+'","'+totalQues+'")'))):"true"==data.userActivityVO.ppQuizResultVOList[t].isCompleted?($(".practiceResultLink").show(),$(".practiceResultLink").attr("instanceid",data.userActivityVO.ppQuizResultVOList[t].instanceId),$(".practiceResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#practiceMode").attr("evtClick",'createInstanceforPPQuiz("'+data.userActivityVO.ppQuizResultVOList[t].quizIdentifier+'","video",false,"'+subTopictagId+'","'+totalQues+'",300)'),$("#practiceMode").attr("onclick","retakeQuizFun(event)"),$("#practiceMode").html("Retake Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn")):($(".practiceResultLink").hide(),data.userActivityVO.ppQuizResultVOList[t].instanceURL?($("#practiceMode").html("Continue Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn"),$("#practiceMode").attr("onclick",'showQuizFrame("'+data.userActivityVO.ppQuizResultVOList[t].instanceURL+'","pp","video","'+subTopictagId+'",event)'),$("#practiceMode").attr("instanceId",data.userActivityVO.ppQuizResultVOList[t].instanceId)):($("#practiceMode").html("Practice Mode"),$("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+subTopictagId+'","'+totalQues+'")')))}$(window).trigger("resize")})});$(window).trigger("resize"),Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_CONFIDENCE_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppTopicVOList){"object"==$.type(data.userActivityVO.ppTopicVOList)&&(data.userActivityVO.ppTopicVOList=[data.userActivityVO.ppTopicVOList]);for(var i=0;i<data.userActivityVO.ppTopicVOList.length;i++)data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList&&"object"==$.type(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList=[data.userActivityVO.ppTopicVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val("");var t=localStorage.getItem("firstName");$("#video").hide(),$("#video").addClass("remove"),$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId"));var a=document.getElementById("video");$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){$("#pp-container-hide").after(a),$(".userClassNameStyles").html(t+"'s progress"),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show();var e=Handlebars.getTemplate("confidenceDashboard")(data.userActivityVO);$("#practicePerfect-progressContainer").html(e);var s=localStorage.getItem("ppProductTitle");$(".pp-confidenceLevelTitle .subjectAreaName").html(s),getConfidenceLevel(),lateScore(),$("#view-more-parent").hide(),$("#ppVideoFormat").val("1"),$(window).trigger("resize")})})}Utility.hideSpinner()}else if(lastActivityCode.indexOf("PP_QUIZ_CENTER_PROGRESS_PAGE")>=0){if(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppQuizResultVOList){"object"==$.type(data.userActivityVO.ppQuizResultVOList)&&(data.userActivityVO.ppQuizResultVOList=[data.userActivityVO.ppQuizResultVOList]);for(var i=0;i<data.userActivityVO.ppQuizResultVOList.length;i++)data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList&&"object"==$.type(data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList)&&(data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList=[data.userActivityVO.ppQuizResultVOList[i].ppSubTopicVOList]);map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e);var t=localStorage.getItem("firstName");$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){$(".userClassNameStyles").html(t+"'s progress");var e=Handlebars.getTemplate("quizCenterProgress")(data.userActivityVO);$("#ppVideoFormat").val("2");$("#practicePerfect-progressContainer").html(e),$("#hide-page-concept").html('<div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"><div class="practice-perfect-message">Your progress on all quizzes built in the Quiz Center</div><div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"></div></div><div class=" col-xs-4 col-md-4 col-sm-4 col-lg-4 no-padding pp-expandCollapseGroup pull-right"><a href="#/" onclick="expandAllPPProgress(true)"><span class="pp-expandAll" >Expand All</span></a> <span class="pp-pipeLine">|</span> <a href="#/" onclick="expandAllPPProgress(false)"><span class="pp-collapseAll">Collapse All</span></a></div>'),$("#page-loading-spinner").hide(),parseInt(data.totalPages)>1?(null!=valchk&&null!=valchk||(valchk="1"),parseInt(valchk)<parseInt(data.totalPages)?($("#view-more-parent").show(),$("#view-more-parent button").attr("onclick","getQuizCenterProgress("+(parseInt(valchk)+1)+")")):$("#view-more-parent").hide()):$("#view-more-parent").hide(),$("#ppVideoFormat").val(2),$(window).trigger("resize")})})}else map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var e=localStorage.getItem("firstName");$(".userClassNameStyles").html(e+"'s progress"),$("#practicePerfect-progressContainer").html('You haven‚Äôt built any quizzes. Visit the <a href="#/" onclick="quizPage()">Quiz Center</a> to get started.'),$("#ppVideoFormat").val(2),$("#view-more-parent").hide(),$(".container-left-desktop-fix-pp").css("overflow","unset"),$("#ppVideoFormat").val(2),$(window).trigger("resize")})});Utility.hideSpinner()}else lastActivityCode.indexOf("PP_VIDEO_QUIZ_PROGRESS_PAGE")>=0&&(Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar(),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,data.userActivityVO.ppQuizResultVOList?("object"==$.type(data.userActivityVO.ppQuizResultVOList)&&(data.userActivityVO.ppQuizResultVOList=[data.userActivityVO.ppQuizResultVOList]),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect: "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var e=localStorage.getItem("firstName");$(".userClassNameStyles").html(e+"'s progress");var t=Handlebars.getTemplate("videoQuizProgress")(data.userActivityVO);$("#practicePerfect-progressContainer").html(t),$("#view-more-parent").hide(),$("#ppVideoFormat").val("3"),$(window).trigger("resize")})})):($("#practicePerfect-progressContainer").html("There is no progress to see in your Video Quiz Progress"),$(window).trigger("resize")),Utility.hideSpinner());"1"==CaseConnect.userSuspendedFlag||"1"==localStorage.getItem("userSuspendedFlag")?adminNotificationTab():(CaseConnect.userSuspendedFlag=localStorage.getItem("userSuspendedFlag"),adminNotificationTab())}}},Handler.login={request:function(e){"remember"==e.data.rememberMe&&localStorage.setItem("rememberMe","true"),e.data.email=e.data.email.trim(),map.email=e.data.email,e.data.streamContentRequiredFlag=map.isIE9,e.data.userActivityVO={lastActivityCode:"NORMAL_LOGIN_WITHOUT_BOOKACCEESCODE",pageNavigatingFrom:"LOGIN",pageNavigatingTo:""},localStorage.getItem("sessionVO")?e.data.sessionVO=map.sessionVO:(Utility.getSessionVO(),e.data.sessionVO=map.sessionVO),e.data={userVO:e.data},"true"==CaseConnect.permalinkOrigin?(e.data.userVO.resLink=permalinkUrl,e.data.userVO.linkFlag=!0):e.data.userVO.linkFlag=!1,void 0===localStorage.lenOfPassword&&localStorage.setItem("lenOfPassword",e.data.userVO.password.length)},response:function(data,textStatus){if(window.history.pushState(null,"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain),$(".login-email-class").next(".reset-error-fields").remove(),$(".heading-label").next(".error-label").remove(),"false"===data.status)sessionAuthFails(data),data.wkErrorCode&&("bus.exception.user.not.exists"===data.wkErrorCode?($(".heading-label").next(".error-label").remove(),$(".heading-label").addClass("").after("<div class='error-label'>"+data.errorMessg+"</div>")):"bus.exception.username.and.password.did.not.match"===data.wkErrorCode?($(".heading-label").next(".error-label").remove(),$(".heading-label").addClass("").after("<div class='error-label'>Email and password combination is incorrect.</div>")):"bus.exception.this.is.not.an.activated.account"===data.wkErrorCode||"bus.exception.this.is.not.an.activated.aspenAccount"===data.wkErrorCode?($(".heading-label").next(".error-label").remove(),$(".login-validation-msg").css("display","block")):($(".heading-label").next(".error-label").remove(),$(".heading-label").addClass("").after("<div class='error-label'>"+data.errorMessg+"</div>"))),data.captchaVO&&($(".heading-label").next(".error-label").remove(),$(".heading-label").addClass("").after("<div class='error-label'>Verification failed. Please try again.</div>")),$("#login_email").val(""),$("#login_password").val(""),Utility.hideSpinner(),grecaptcha.reset();else{void 0!==data.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",data.sessionAuthenticationToken),data.userVO&&data.userVO.schoolName&&localStorage.setItem("schoolName",data.userVO.schoolName),dummyLoginData=data,CaseConnect.aspenCode=data.userVO.aspenCode,map.userId=data.userVO.userId,map.firstName=data.userVO.firstName,map.lastName=data.userVO.lastName,map.userRole=data.userVO.userRole,map.userRoleId=data.userVO.userRoleId,data.userVO.schoolId&&localStorage.setItem("schoolId",data.userVO.schoolId),Utility.saveLoginState(data);var resetPasswordFlag="";resetPasswordFlag=null==data.userVO.resetPasswordFlag&&null==data.userVO.resetPasswordFlag?"false":"false"==data.userVO.resetPasswordFlag?"false":"true";var freeTrialLogin=localStorage.getItem("freeTrialLogin");if(freeTrialLogin=null==freeTrialLogin&&null==freeTrialLogin?"false":"false"==freeTrialLogin?"false":"true","register"==data.redirectStatus)fillPartialRegistrationDetails(),localStorage.removeItem("userId");else if(resetPasswordFlag)if("true"==resetPasswordFlag)$(".login-blk").hide(),$(".reset-login-blk").show(),$(".static-page-bar").hide(),$(".footer-link").hide(),localStorage.setItem("resetFlag",resetPasswordFlag),Utility.hideSpinner();else if("true"==freeTrialLogin)localStorage.setItem("freeTrialLogin","false"),$("#wk_content").html('<div class="static-page-container no-padding freeTrial-home-page"></div>'),$("#wk_content .freeTrial-home-page").load("freeTrailCatalog.html?v4",function(){$("#ft-cateloglandingPage").show(),$("#ft-cateloglandingPage .columnBooks").show(),Handler.login.updateStatusBar(),window.history.pushState({page:""},null,properties.ui_domain+"free"),addBookshelfLinkTOLogo(),$(window).trigger("resize")});else{if(localStorage.setItem("resetFlag",resetPasswordFlag),"true"==data.mbeAdminFlag?(themisAdminlanding=!0,localStorage.setItem("themisAdminlanding",themisAdminlanding),localStorage.setItem("mbeAdminSchoolId",data.mbeAdminSchoolId),null!=data.mbeSchoolName&&null!=data.mbeSchoolName&&localStorage.setItem("mbeAdminSchoolName",data.mbeSchoolName)):(themisAdminlanding=!1,localStorage.removeItem("themisAdminlanding",themisAdminlanding)),localStorage.setItem("manageConnectionEmailOriginQA","true"),"1"==data.userVO.suspendedFlag?(localStorage.setItem("userSuspendedFlag",data.userVO.suspendedFlag),CaseConnect.userSuspendedFlag=data.userVO.suspendedFlag,emailvalidNotification=!0,adminNotificationTab()):(CaseConnect.userSuspendedFlag=data.userVO.suspendedFlag,adminNotificationTab()),data.userActivityVO&&null!=data.userActivityVO.errorMsg&&null!=data.userActivityVO.errorMsg&&("NoResource"==data.userActivityVO.errorMsg?alertMessagesModal("You don't have access for this link"):"InvalidLink"==data.userActivityVO.errorMsg&&alertMessagesModal("Invalid Link")),Handler.login.updateStatusBar(),void 0!==localStorage.bookAccessCode&&localStorage.removeItem("bookAccessCode"),data.userVO&&"true"==data.userVO.firstTimeLoginFlag)$(".bookshelflink").hide(),$(".tutoriallink").hide(),Handler.login.loadAlmostThere(data),Utility.trackGA("register");else if("true"===comingFromThemis){CaseConnect.themisSubjectAreaId=CaseConnect.themisAttributes.themisSAId,CaseConnect.currentProductId=CaseConnect.themisAttributes.themisProductId,localStorage.setItem("currentProductId",CaseConnect.currentProductId),Utility.showSpinner(),addBookshelfLinkTOLogo(),Handler.login.updateStatusBar();var handler="themisBarProduct",request={url:"/manageThemis/getThemisSAByProductId"};request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request),adjustLeftNavHeight()}else if("true"==CaseConnect.briefShareEmailOrigin)loadManageConnectionFromEmailLogin();else if(void 0!==map.bookAccessCode)delete map.bookAccessCode,"Professor"===map.userRole?Handler.login.loadProfessorBookshelf(data):Handler.login.loadBookshelf(data);else{window.history.pushState({page:"bookshelf"},null,properties.ui_domain),addBookshelfLinkTOLogo();var handler="goToBookShelf",request={},reqData={};request.url="/bookShelfRetrivalService/getBookList",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request),Utility.trackGA("bookshelf")}getMyRequestNoftificationCount()}getQpAuthenticationToken()}},updateStatusBar:function(){$(".loginLink").hide(),$(".hr-rule-div").hide(),Handler.login.checkTopBottomBarsForLogin(),$(".main-container").css("min-width","768px"),$(".statusBar").show(),$(".ereader-hidden").hide(),$(".ereader-visible").show()},removeUnderlineStyle:function(){$(".faculty a").css("text-decoration","none"),$(".learnmore a").css("text-decoration","none"),$(".catalog a").css("text-decoration","none"),$("#catalog").css("text-decoration","none"),$(".bookshelf-static-page-link").css("display","inline-block !important"),$(".logoutLink-static-page-link").css("display","inline-block !important"),$(".myaccount-span-static-page-link").css("display","inline-block !important"),$(".myAccount-static-page-link").css("display","inline-block !important")},checkTopBottomBarsForLogin:function(){$(".top-nav-collapse-light").addClass("top-nav-collapse-dark"),$(".login-status-bar").addClass("login-status-bar-loggedin"),$(".static-page-bar").addClass("static-page-bar-loggedin"),$(".footer-wrapper").addClass("footer-wrapper-status-bar-loggedin"),$(".caseconnect-logo-bar").addClass("caseconnect-logo-bar-loggedin"),insideStaticPage&&("1"==CaseConnect.userSuspendedFlag||localStorage.getItem("userSuspendedFlag"))},loadAlmostThere:function(e){Handler.login.updateStatusBar(),map.wk_conatiner.load("almostThere.html?v19893",function(){insideStaticPage=!0,insideBookshelf=!1,$("#reg2-user-role").text(map.userRole),$(almostThere[3]).parent().hide(),$(almostThere[3]).hide();var t=e.countryList;for(i=0,j=t.length;i<j;i++)"United States"==t[i]?almostThere[0].options[0]=new Option(t[i],t[i]):almostThere[0].options[i+1]=new Option(t[i],t[i]);for(almostThere[0].selectedIndex=0,i=0,j=almostThere[0].options.length;i<j;i++)void 0!==almostThere[0].options[i]&&""==almostThere[0].options[i].value&&almostThere[0].options[i].remove();var a=e.locationVOList||e.locationList;for(i=0,j=a.length;i<j;i++)almostThere[1].options[i+1]=new Option(a[i].schoolLocation,a[i].schoolLocation);Utility.hideSpinner()})},loadBookshelf:function(e){Handler.login.updateStatusBar(),$(".ereader-main-header-title").html(""),$(".read-modal-book-title").html(""),$(".myAccount").show(),enableCopyPaste(),localStorage.setItem("currentProductId",""),$("#news-feed-nav-mobile").modal("hide"),insideStaticPage=!1,insideBookshelf=!0,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideOutline=!1,insideGlobalSearchResult=!1,rssFeedSAList=null,rssFeedAllList=null,CaseConnect.currentClassId="",CaseConnect.resourceFlag=!1,$(".modal-backdrop").remove(),CaseConnect.preSetBriefLabelList="",$(window).trigger("resize"),addBookshelfLinkTOLogo(),CaseConnect.newsFeedTimer&&clearTimeout(CaseConnect.newsFeedTimer),CaseConnect.expiryDateTimer&&clearTimeout(CaseConnect.expiryDateTimer),getApplicationOverlayTutorialMessage(),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#generic-nav-menu-logout-mobile").modal("hide"),$("body").removeClass("modal-open"),map.wk_conatiner.load("bookShelf.html?v19894",function(){Utility.showSpinner(),localStorage.removeItem("classCodeAddSectionRefresh"),CaseConnect.bookTitle="",$(".bookshelflink").hide(),$(".tutoriallink").hide(),CaseConnect.resourceFlag=!1;var t=e.userActivityVO;Array.isArray(t.bookVOList)||(t.bookVOList=[t.bookVOList]);var a=t.bookVOList;CaseConnect.navigatingAwayFromNewBookshelf=a;for(var s=0;s<a.length;++s)if(null!=a[s]&&null!=a[s]){if(a[s].classVOList&&"object"==$.type(a[s].classVOList)&&(a[s].classVOList=[a[s].classVOList]),a[s].classVOList)for(var o=[],i="",r=0;r<a[s].classVOList.length;r++){if(a[s].classVOList[r].classVOListLength=a[s].classVOList.length,"object"==$.type(a[s].classVOList[r].coProfessorList)&&(a[s].classVOList[r].coProfessorList=[a[s].classVOList[r].coProfessorList]),o=a[s].classVOList[r].coProfessorList){for(var n=0;n<o.length;n++)i+=o[n].firstName+" "+o[n].lastName+", ";i=i.substring(0,i.lastIndexOf(",")),a[s].classVOList[r].coProfessorList=i}a[s].classVOList[r].classCode&&(a[s].classVOList[r].classCode=a[s].classVOList[r].classCode.toUpperCase())}}else alertMessagesModal("You don't have any book in your bookshelf."),Utility.hideSpinner();if(null!=t&&null!=t.bookVOList&&null!=t.bookVOList[0]){for(n=0,j=t.bookVOList.length;n<j;n++){var l=(y=t.bookVOList[n]).bookTitle?y.bookTitle:t.lastReadBookTitle;if(l.length>30)var d=l.slice(0,30)+"...";else d=l;var c=new Date(y.bookPublishDate),u=c.getMonth()+1;u<10&&(u="0"+u);var p=c.getDate();p<10&&(p="0"+p);var m=u+"/"+p+"/"+c.getFullYear();y.truncatedBookName=d,y.formatedDate=m}var h=t.bookVOList.findIndex(checkIndex);null!=h&&null!=h&&-1!=h&&"object"==$.type(t.bookVOList[h].cqProductVOList)&&(t.bookVOList[h].cqProductVOList=[t.bookVOList[h].cqProductVOList]);var g=t.bookVOList.findIndex(checkIndexPP);null!=g&&null!=g&&-1!=g&&("object"==$.type(t.bookVOList[g].ppProductVO)&&(t.bookVOList[g].ppProductVO=[t.bookVOList[g].ppProductVO]),localStorage.setItem("ppProductTitle",t.bookVOList[g].bookTitle),"object"==$.type(t.bookVOList[g].ppProductVO.qpQuestionType)&&(t.bookVOList[g].ppProductVO.qpQuestionType=[t.bookVOList[g].ppProductVO.qpQuestionType]),localStorage.setItem("ppProductVo",JSON.stringify(t.bookVOList[g].ppProductVO)));var f=Handlebars.getTemplate("bookshelf-grid")(t),v=$(this).find("#books-grid-view").html(f),b=$(".student-book-author");for(n=0;n<b.length;n++)b[n].innerHTML=b[n].innerHTML.replace(/&nbsp;/g," ");var C=$(".student-book-title");for(n=0;n<C.length;n++)C[n].innerHTML=C[n].innerHTML.replace(/&amp;/g,"&");for(v.find(".books-thumbnail").popover({placement:"right",template:'<div class="popover book-info-popover" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow info-arrow-right"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$(this.parentNode).find("#book-info-content").html()}}),n=0;n<t.bookVOList.length;n++){var y;"Resource"!==(y=t.bookVOList[n]).bookType&&"studyaid"!==y.bookType&&"practicepack"!==y.bookType&&"oer"!==y.bookType&&"Themis"!==y.bookType||$(" [bookId='"+y.bookId+"']").addClass("center-button")}CaseConnect.bookListForUser=t;new List("books-grid-view",{valueNames:["student-book-title","student-book-author","popover-isbn"],listClass:"to-search-booklist",searchClass:"my-search"});loadPromoSpotlightDashboard(this),$("#bookshelf-username").html(localStorage.getItem("firstName")),$(window).trigger("resize"),e.skipLS||localStorage.setItem("getBookList",JSON.stringify(t))}else alertMessagesModal("You don't have any book in your bookshelf."),Utility.hideSpinner();Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf()})},loadProfessorBookshelf:function(e){Handler.login.updateStatusBar(),$(".ereader-main-header-title").html(""),$(".read-modal-book-title").html(""),$(".myAccount").show(),enableCopyPaste(),localStorage.setItem("currentProductId",""),$("#news-feed-nav-mobile").modal("hide"),insideStaticPage=!1,insideBookshelf=!0,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideOutline=!1,insideGlobalSearchResult=!1,rssFeedSAList=null,rssFeedAllList=null,CaseConnect.currentClassId="",insideNewsFeed=!1,$(".modal-backdrop").remove(),CaseConnect.preSetBriefLabelList="",CaseConnect.newsFeedTimer&&clearTimeout(CaseConnect.newsFeedTimer),CaseConnect.expiryDateTimer&&clearTimeout(CaseConnect.expiryDateTimer),$(window).trigger("resize"),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#generic-nav-menu-logout-mobile").modal("hide"),$("body").removeClass("modal-open"),getApplicationOverlayTutorialMessage(),map.wk_conatiner.load("professorBookShelf.html?v19894",function(){Utility.showSpinner(),CaseConnect.bookTitle="",$(".bookshelflink").hide(),$(".tutoriallink").hide(),CaseConnect.resourceFlag=!1;var t=e.userActivityVO;if(Array.isArray(t.bookVOList)||(t.bookVOList=[t.bookVOList]),CaseConnect.navigatingAwayFromNewBookshelf=t.bookVOList,null!=t&&null!=t.bookVOList&&null!=t.bookVOList[0]){for(p=0;p<t.bookVOList.length;p++){var a=t.bookVOList[p],s=new Date(a.bookPublishDate),o=s.getMonth()+1;o<10&&(o="0"+o);var i=s.getDate();i<10&&(i="0"+i);var r=o+"/"+i+"/"+s.getFullYear();t.bookVOList[p].bookPublishDate=r}var n=t.bookVOList.findIndex(checkIndex);null!=n&&null!=n&&-1!=n&&"object"==$.type(t.bookVOList[n].cqProductVOList)&&(t.bookVOList[n].cqProductVOList=[t.bookVOList[n].cqProductVOList]);var l=t.bookVOList.findIndex(checkIndexPP);null!=l&&null!=l&&-1!=l&&("object"==$.type(t.bookVOList[l].ppProductVO)&&(t.bookVOList[l].ppProductVO=[t.bookVOList[l].ppProductVO]),localStorage.setItem("ppProductTitle",t.bookVOList[l].bookTitle),"object"==$.type(t.bookVOList[l].ppProductVO.qpQuestionType)&&(t.bookVOList[l].ppProductVO.qpQuestionType=[t.bookVOList[l].ppProductVO.qpQuestionType]),localStorage.setItem("ppProductVo",JSON.stringify(t.bookVOList[l].ppProductVO)));for(var d=Handlebars.getTemplate("professor-bookshlelf-page")(t),c=$(this).find("#professor-bookshelf-page").html(d),u=$(".faculty-book-author"),p=0;p<u.length;p++)u[p].innerHTML=u[p].innerHTML.replace(/&nbsp;/g," ");var m=$(".faculty-book-title");for(p=0;p<m.length;p++)m[p].innerHTML=m[p].innerHTML.replace(/&amp;/g,"&");CaseConnect.bookListForUser=t;new List("professor-bookshelf-page",{valueNames:["faculty-book-title","faculty-book-author","popover-isbn"],listClass:"to-search-booklist",searchClass:"my-search"}),t.bookVOList.length;for(lastVisitedClassId="",c.find(".books-thumbnail").popover({placement:"right",template:'<div class="popover book-info-popover" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow info-arrow-right"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$(this.parentNode).find("#prof-book-info-content").html()}}),p=0;p<t.bookVOList.length;p++){"Resource"!==(a=t.bookVOList[p]).bookType&&"studyaid"!==a.bookType&&"practicepack"!==a.bookType&&"oer"!==a.bookType&&"Themis"!==a.bookType||$("[bookId='"+a.bookId+"']").addClass("center-button")}loadPromoSpotlightDashboard(this),CaseConnect.bookListForUser=t,$("#bookshelf-username").html(localStorage.getItem("firstName")),$(window).trigger("resize"),e.skipLS||localStorage.setItem("getBookList",JSON.stringify(t))}else alertMessagesModal("You don't have any book in your bookshelf."),Utility.hideSpinner();Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf()})},generateAddBookPopover:function(){$(".add-books").popover({placement:function(){$("#bookshelf-menuber").offset(),$(".bookshelf-menu-mobile").css("display");return $(window).width(),"bottom"},template:'<div class="popover bottom"><div class="arrow" id="add-book-arrow"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$("#addBook").html()}}),$(".add-books").on("shown.bs.popover",function(){$("#add-book-arrow").removeAttr("style"),$(".add-book-new-book").css("display","none"),$(".button-cover").css("display","inline-block"),$(".popover-book-access-code").trigger("focus")})},generateAddProdToBookShelf:function(){$(".add-product").popover({placement:function(){return $(window).width()<767?"left":"bottom"},template:'<div class="popover bottom"><div class="arrow" id="add-book-arrow"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$("#addProductToBookshelf").html()}}),$(".add-product").on("shown.bs.popover",function(){$(".add-book-new-book").css("display","none"),$(".button-cover").css("display","inline-block")})},loadMyAccount:function(e){Handler.login.updateStatusBar(),insideStaticPage=!0,insideBookshelf=!1,addBookshelfLinkTOLogo(),$(".bookshelflink").show(),$(".tutoriallink").show(),map.firstName=e.userVO.firstName,map.lastName=e.userVO.lastName,map.email=e.userVO.email,map.userRoleId=e.userVO.userRoleId,map.schoolName=e.userVO.schoolName,map.schoolLocation=e.userVO.schoolLocation,map.countryName=e.userVO.country,map.schoolNotInListFlag=e.userVO.schoolNotInListFlag,map.subscribeStatus=e.userVO.subscriptionFlag,map.wk_conatiner.load("myAccount.html?v17115",function(){$("#myaccount-firstName").text(e.userVO.firstName),$("#myaccount-lastName").text(e.userVO.lastName),$("#myaccount-email").text(e.userVO.email),$("#myaccount-role").text(e.userVO.userRole),$("#myaccount-countryName").text(e.userVO.country),"NA"!==e.userVO.schoolLocation?$("#myaccount-schoolLocation").text(e.userVO.schoolLocation):$("#myaccount-schoolLocation").parent().hide(),$("#myaccount-schoolName").text(e.userVO.schoolName),insideStaticPage=!0,insideBookshelf=!1,$(window).trigger("resize");var t=e.userVO.subscriptionFlag;"1"===t?$("#myaccount-emailPreferences").text("Subscribed"):"0"===t&&$("#myaccount-emailPreferences").text("Unsubscribed");var a=localStorage.getItem("lenOfPassword"),s="********************";s=s.substr(0,a),"true"==e.userVO.facebookFlag?$("#change-password").hide():($("#change-password").show(),$("#encrypt-password").html(s)),Utility.hideSpinner(),$(window).width()>768&&fixLeftAndHeaderInDesktop(),Utility.trackGA("profile")})}},Handler.forceResetpwd={request:function(e){"remember"==e.data.rememberMe&&localStorage.setItem("rememberMe","true"),e.data.streamContentRequiredFlag=map.isIE9,e.data.userActivityVO={lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"BOOKSHELF"},localStorage.getItem("sessionVO")?e.data.sessionVO=map.sessionVO:(Utility.getSessionVO(),e.data.sessionVO=map.sessionVO),e.data={userVO:e.data},""!==$("#resetPasswordCnf").val()&&(e.data.userVO.passwordNew=e.data.userVO.resetPasswordNew),delete e.data.userVO.resetPasswordCnf,delete e.data.userVO.resetPasswordNew,e.data.userVO.userId=map.userId,e.data.userVO.userRole=map.userRole,e.data.userVO.userRoleId=map.userRoleId},response:function(data,textStatus){if(window.history.pushState(null,"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain),$(".login-email-class").next(".reset-error-fields").remove(),$(".heading-label").next(".error-label").remove(),"false"===data.status)sessionAuthFails(data),"bus.exception.this.is.not.an.activated.account"===data.wkErrorCode?$(".login-validation-msg").css("display","block"):"bus.exception.enforce.change.password"===data.wkErrorCode?$(".heading-label").addClass("").after("<div class='error-label'>Please use a different password.</div>"):$(".heading-label").addClass("").after("<div class='error-label'>"+data.errorMessg+"</div>"),Utility.hideSpinner();else{$("#pwdModal").modal("show"),setTimeout(function(){$("#pwdModal").modal("hide")},1e3),$(".footer-link").show();var handler="goToBookShelf",request={},reqData={};request.url="/bookShelfRetrivalService/getBookList",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request),localStorage.setItem("resetFlag","false")}}},Handler.addBook={request:function(e){e.data.bookAccessCode=e.data.bookAccessCode.replace(/ /g,""),e.data.userActivityVO={lastActivityCode:"BOOKSHELF_ADD_BOOKACCEESCODE",pageNavigatingFrom:"BOOKSHELF",pageNavigatingTo:"BOOKSHELF"},e.data.sessionVO=map.sessionVO,e.data.userId=map.userId,e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookAccessCode:e.data.bookAccessCode}}},response:function(e,t){if("false"===e.status){if($(".tutoriallink").hide(),"bus.exception.user.already.have.all.books.with.life.time.access"===e.wkErrorCode){var a="You already have lifetime access to this product.";this.form.find("#addBookError").html(a)}else if("bus.exception.you.have.longer.validity.period.than.the.used.access.code"===e.wkErrorCode){a="Code cannot be redeemed because it expires before current product expiration date.";this.form.find("#addBookError").html(a)}else if("bus.exception.accesscode.has.expired"===e.wkErrorCode){a="This access code has already expired and cannot be redeemed.";this.form.find("#addBookError").html(a)}else if("bus.exception.you.already.have.lifetime.access.to.this.product"===e.wkErrorCode){a="You already have lifetime access to this product.";this.form.find("#addBookError").html(a)}else if("bus.exception.only.student.can.redeem.cq.code"===e.wkErrorCode){a="It looks like you're trying to redeem a student access code with a professor account. To get set up with Connected Quizzing, contact the Quiz Concierge at <a href='mailto:concierge@wolterskluwer.com'>concierge@wolterskluwer.com</a>.";this.form.find("#addBookError").html(a)}else if("bus.exception.access.code.already.been.used"===e.wkErrorCode){a="This access code has already been redeemed. Please try a different access code.";this.form.find("#addBookError").html(a)}else if("bus.exception.accessCode.is.null"===e.wkErrorCode){a="Invalid code.";this.form.find("#addBookError").html(a)}else"bus.exception.valid.cq.class.code"==$.trim(e.wkErrorCode)?($(".popover").hide(),map.overlay.fadeOut(),$("#error-message-dialogue").modal("show")):this.form.find("#addBookError").html(e.errorMessg);sessionAuthFails(e),Utility.hideSpinner()}else{void 0!==e.userSettingsVO?void 0!==e.userSettingsVO.applicationOverlayTutorialDisplayMessageFlag&&"true"===e.userSettingsVO.applicationOverlayTutorialDisplayMessageFlag&&(CaseConnect.applicationOverlayTutorialDisplayMessageFlag=e.userSettingsVO.applicationOverlayTutorialDisplayMessageFlag,tutorialApplicationBookType=e.userSettingsVO.bookType,welcomeTutorial()):($("#new-bookshelf-modal-faculty").modal("hide"),$("#practisepack-tutorial-faculty").modal("hide"),$("#studyaid-tutorial-faculty").modal("hide"),caseBookTutorial=!1,practicePackTutorial=!1,studyAidTutorial=!1,slideIndex=1),map.overlay.hide(),$(".tutoriallink").hide(),$(".ereader-main-header-title").html(""),$(".read-modal-book-title").html(""),$(".myAccount").show(),enableCopyPaste(),insideStaticPage=!1,insideBookshelf=!0,$(window).trigger("resize"),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide");var s=e;if(Array.isArray(s.bookVOList)||(s.bookVOList=[s.bookVOList]),null!=s&&null!=s.bookVOList&&null!=s.bookVOList[0]){for(i=0,j=s.bookVOList.length;i<j;i++){var o=s.bookVOList[i],r=o.bookTitle;if(r.length>30)var n=r.slice(0,30)+"...";else n=r;var l=new Date(o.bookPublishDate),d=l.getMonth()+1;d<10&&(d="0"+d);var c=l.getDate();c<10&&(c="0"+c);var u=d+"/"+c+"/"+l.getFullYear();o.truncatedBookName=n,o.formatedDate=u}"Professor"===map.userRole?map.wk_conatiner.load("professorBookShelf.html?v19894",function(){Utility.showSpinner(),CaseConnect.bookTitle="",CaseConnect.resourceFlag=!1;for(c=0;c<s.bookVOList.length;c++){var t=s.bookVOList[c],a=new Date(t.bookPublishDate),o=a.getMonth()+1;o<10&&(o="0"+o);var i=a.getDate();i<10&&(i="0"+i);var r=o+"/"+i+"/"+a.getFullYear();s.bookVOList[c].bookPublishDate=r}if(null!=s&&null!=s.bookVOList&&null!=s.bookVOList[0]){for(var n=Handlebars.getTemplate("professor-bookshlelf-page")(s),l=$(this).find("#professor-bookshelf-page").html(n),d=$(".faculty-book-author"),c=0;c<d.length;c++)d[c].innerHTML=d[c].innerHTML.replace(/&nbsp;/g," ");var u=$(".faculty-book-title");for(c=0;c<u.length;c++)u[c].innerHTML=u[c].innerHTML.replace(/&amp;/g,"&");s.bookVOList.length;for(CaseConnect.navigatingAwayFromNewBookshelf=s.bookVOList,lastVisitedClassId="",l.find(".books-thumbnail").popover({placement:"right",template:'<div class="popover book-info-popover" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow info-arrow-right"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$(this.parentNode).find("#prof-book-info-content").html()}}),c=0;c<s.bookVOList.length;c++){"Resource"!==(t=s.bookVOList[c]).bookType&&"studyaid"!==t.bookType&&"practicepack"!==t.bookType&&"oer"!==t.bookType&&"Themis"!==t.bookType||$("[bookId='"+t.bookId+"']").addClass("center-button")}loadPromoSpotlightDashboard(this);new List("professor-bookshelf-page",{valueNames:["faculty-book-title","faculty-book-author","popover-isbn"],listClass:"to-search-booklist",searchClass:"my-search"});CaseConnect.bookListForUser=s,$("#bookshelf-username").html(localStorage.getItem("firstName")),$(window).trigger("resize"),e.skipLS||localStorage.setItem("getBookList",JSON.stringify(s))}else alertMessagesModal("You don't have any book in your bookshelf.");Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf(),localStorage.setItem("getBookList",JSON.stringify(s))}):map.wk_conatiner.load("bookShelf.html?v19894",function(){Utility.showSpinner(),localStorage.removeItem("classCodeAddSectionRefresh"),CaseConnect.bookTitle="",CaseConnect.resourceFlag=!1;var t=s.bookVOList;CaseConnect.navigatingAwayFromNewBookshelf=s.bookVOList;for(var a=0;a<t.length;++a)if(null!=t[a]&&null!=t[a]){if(t[a].classVOList&&"object"==$.type(t[a].classVOList)&&(t[a].classVOList=[t[a].classVOList]),t[a].classVOList)for(var o=0;o<t[a].classVOList.length;o++)t[a].classVOList[o].classVOListLength=t[a].classVOList.length}else alertMessagesModal("You don't have any book in your bookshelf.");if(null!=s&&null!=s.bookVOList&&null!=s.bookVOList[0]){for(var i=Handlebars.getTemplate("bookshelf-grid")(s),r=$(this).find("#books-grid-view").html(i),n=$(".student-book-author"),l=0;l<n.length;l++)n[l].innerHTML=n[l].innerHTML.replace(/&nbsp;/g," ");var d=$(".student-book-title");for(l=0;l<d.length;l++)d[l].innerHTML=d[l].innerHTML.replace(/&amp;/g,"&");for(r.find(".books-thumbnail").popover({placement:"right",template:'<div class="popover book-info-popover" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow info-arrow-right"></div><div class="popover-content"></div></div>',content:function(){return map.overlay.fadeIn(200),$(this.parentNode).find("#book-info-content").html()}}),l=0;l<s.bookVOList.length;l++){var c=s.bookVOList[l];"Resource"!==c.bookType&&"studyaid"!==c.bookType&&"practicepack"!==c.bookType&&"oer"!==c.bookType&&"Themis"!==c.bookType||$("[bookId='"+c.bookId+"']").addClass("center-button")}new List("books-grid-view",{valueNames:["student-book-title","student-book-author","popover-isbn"],listClass:"to-search-booklist",searchClass:"my-search"});CaseConnect.bookListForUser=s,loadPromoSpotlightDashboard(this),$("#bookshelf-username").html(localStorage.getItem("firstName")),$(window).trigger("resize"),e.skipLS||localStorage.setItem("getBookList",JSON.stringify(s))}else alertMessagesModal("You don't have any book in your bookshelf.");if(Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf(),s.cqAccessCodeCredits){n="";n="1"==s.cqAccessCodeCredits?"Thank you for purchasing Connected Quizzing! Your access code allows you to redeem 1 additional class code.":"Thank you for purchasing Connected Quizzing! Your access code allows you to redeem "+s.cqAccessCodeCredits+" additional class codes.",$("#redeemCq .modal-thankYouCQPopoverHeader").html(n),$("#redeemCq").modal("show")}});var p=s.bookVOList.findIndex(checkIndex);null!=p&&null!=p&&-1!=p&&"object"==$.type(s.bookVOList[p].cqProductVOList)&&(s.bookVOList[p].cqProductVOList=[s.bookVOList[p].cqProductVOList]);var m=s.bookVOList.findIndex(checkIndexPP);null!=m&&null!=m&&-1!=m&&("object"==$.type(s.bookVOList[m].ppProductVO)&&(s.bookVOList[m].ppProductVO=[s.bookVOList[m].ppProductVO]),localStorage.setItem("ppProductTitle",s.bookVOList[m].bookTitle),"object"==$.type(s.bookVOList[m].ppProductVO.qpQuestionType)&&(s.bookVOList[m].ppProductVO.qpQuestionType=[s.bookVOList[m].ppProductVO.qpQuestionType]),localStorage.setItem("ppProductVo",JSON.stringify(s.bookVOList[m].ppProductVO)))}}}},Handler.resetPassword={request:function(e){e.data={userVO:e.data},Handler.decorate(e.data)},response:function(e,t){$("#error_msg").html(""),"false"===e.status?($(".reset-email").next(".err").remove(),$(".reset-email").addClass("").after("<span class='err col-sm-3'><i class='password-err-label'>"+e.errorMessg+"</i></span>"),sessionAuthFails(e),Utility.hideSpinner()):e.redirectStatus&&"register"==e.redirectStatus?((dummyLoginData=e.userResponseVO).userVO={email:$("#reset-password-email-field").val()},dummyLoginData.userVO.aspenCode="1",fillPartialRegistrationDetailsFirstUser(),Utility.hideSpinner()):map.wk_conatiner.load("success.html?v19893",function(){Utility.hideSpinner(),localStorage.getItem("userId")||Utility.getAnonymousSessionAuthToken()})}},Handler.myAccount={request:function(e){CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer),e.data.userVO={userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"MYACCOUNT_VIEW",pageNavigatingFrom:"",pageNavigatingTo:"myAccount"}},e.data.userVO.sessionVO=map.sessionVO,Utility.showSpinner()},response:function(e,t){(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),insideResourcePagefromPermawithBookAssoc=!1,$("#bookshelf-nav-menu-mobile").modal("hide"),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#generic-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$(".common-book-menu-dropdown").attr("onclick","showAccountMenuFromHamburger('generic-nav-menu-mobile');"),$("div.common-book-info-modal-container .ereader-top-nav-cog").addClass("cc-header-account").removeClass("glyphicon glyphicon-remove"),$("div.common-book-info-modal-container .ereader-top-nav-cog").attr("onclick","showAccountMenuInMobile('generic-nav-menu-mobile')"),"false"===e.status?(sessionAuthFails(e),Utility.hideSpinner()):(insideManageConnection=!1,window.history.pushState({page:"myAccount"},null,properties.ui_domain),$(".bookshelflink").show(),$(".tutoriallink").hide(),enableCopyPaste(),insideStaticPage=!0,insideBookshelf=!1,insideCasesPage=!1,insideEreader=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideClassInsightsPage=!1,insideResourcePage=!1,insideOutline=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$("#bookshelf-nav-menu-mobile").modal("hide"),Handler.login.removeUnderlineStyle(),map.firstName=e.userVO.firstName,map.lastName=e.userVO.lastName,map.email=e.userVO.email,map.userRoleId=e.userVO.userRoleId,map.userRole=e.userVO.userRole,map.schoolName=e.userVO.schoolName,map.schoolLocation=e.userVO.schoolLocation,map.countryName=e.userVO.country,map.schoolNotInListFlag=e.userVO.schoolNotInListFlag,map.subscribeStatus=e.userVO.subscriptionFlag,map.wk_conatiner.load("myAccount.html?v11617",function(){$(window).trigger("resize"),$("#myaccount-firstName").text(e.userVO.firstName),$("#myaccount-lastName").text(e.userVO.lastName),$("#myaccount-email").text(e.userVO.email),$("#myaccount-role").text(e.userVO.userRole),$("#myaccount-countryName").text(e.userVO.country),"NA"!==e.userVO.schoolLocation?$("#myaccount-schoolLocation").text(e.userVO.schoolLocation):$("#myaccount-schoolLocation").parent().hide(),$("#myaccount-schoolName").text(e.userVO.schoolName);var t=e.userVO.subscriptionFlag;"1"===t?$("#myaccount-emailPreferences").text("Subscribed"):"0"===t&&$("#myaccount-emailPreferences").text("Unsubscribed");var a=localStorage.getItem("lenOfPassword"),s="********************";if(s=s.substr(0,a),"true"==e.userVO.facebookFlag?$("#change-password").hide():($("#change-password").show(),$("#encrypt-password").html(s)),Utility.hideSpinner(),void 0!==map.myAccountPageUpdated&&"editProfile"==map.myAccountPageUpdated){alertMessagesModal("Your changes have been saved.");var o=map.updatedUserName;map.firstName=o,localStorage.setItem("firstName",o),o.length>30&&(o=o.substring(0,30)+" ..."),$(".welcome").html("Welcome "+o)}else void 0!==map.myAccountPageUpdated&&"changePassword"==map.myAccountPageUpdated&&(alertMessagesModal("Your new password has been saved."),$("#changePassword")[0].reset());delete map.myAccountPageUpdated,$(window).width()>768&&fixLeftAndHeaderInDesktop()}),insideManageConnection=!1)}},Handler.editMyaccount={request:function(e){},response:function(e,t){if("false"===e.status)$("#page-loading-spinner").hide(),sessionAuthFails(e);else{var a=document.documentElement;a.setAttribute("data-useragent",navigator.userAgent),a.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".my-account-select").css({position:"static","background-image":"none"}),$("#editmyaccount-otherSchoolName").hide(),$("#editmyaccount-firstName").attr("value",map.firstName),$("#editmyaccount-lastName").attr("value",map.lastName),$("#editmyaccount-email").attr("value",map.email),$("#editmyaccount-emailPreferences").attr("value",map.subscribeStatus),"1"===map.subscribeStatus?$("#editmyaccount-emailPreferences").prop("checked",!1):"0"===map.subscribeStatus&&$("#editmyaccount-emailPreferences").prop("checked",!0);map.userRoleId;var s=map.userRole,o=map.schoolLocation,i=map.countryName,r=map.schoolName;$("#userRoleName").html(s);var n=e.countryList,l=[];$(editUserdetails[4]).html("");for(var d=0;d<n.length;d++)if("United States"==n[d]){var c=d;l[0]=n[d];break}for(var u=1;u<n.length;u++)l[u]=u>c?n[u]:n[u-1];for(var p=0;p<l.length;p++){var m=l[p],h=i&&i.toLowerCase()==m.toLowerCase()?' selected = "selected"':"",g=$('<option value="'+m+'"'+h+">"+m+"</option>");$(editUserdetails[4]).append(g)}if("United States"===map.countryName&&"NA"!==map.schoolLocation){(function(t){$.ajax({url:properties[properties.env]+t,type:"GET",async:!1}).then(function(e){if("true"===e.status){var t=e.locationVOList;for($(editUserdetails[5]).html(""),d=0;d<t.length;d++){var a=t[d].schoolLocation,s=o&&o.toLowerCase()==a.toLowerCase()?' selected = "selected"':"",i=$('<option value="'+a+'"'+s+">"+a+"</option>");$(editUserdetails[5]).append(i)}$(editUserdetails[5]).show(),$(editUserdetails[5]).parent().show(),$(editUserdetails[6]).show(),$(editUserdetails[6]).parent().show(),$(editUserdetails[7]).hide(),$(editUserdetails[7]).parent().hide()}sessionTimeOut()},function(t){$("#page-loading-spinner").hide(),sessionAuthFails(e),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})})("Wolters Kluwer Legal Education"==map.schoolLocation?"/manageUserService/getAdminLocationList":"/manageUserService/getLocationAndRoleList")}else $(editUserdetails[5]).hide(),$(editUserdetails[5]).parent().hide(),$(editUserdetails[6]).hide(),$(editUserdetails[6]).parent().hide(),$(editUserdetails[7]).show(),$(editUserdetails[7]).parent().show(),editUserdetails[5].selectedIndex=0,editUserdetails[6].selectedIndex=0,editUserdetails[6].value="-999";if("true"==map.schoolNotInListFlag){var f=r;r="other"}if("United States"===map.countryName&&"NA"!==map.schoolLocation){var v={response:function(e,t){if("false"==e.status){if("bus.exception.session.authentication.fail"===e.wkErrorCode&&"ERS500"===e.genericParam){window.location.pathname.split("plink");document.cookie="sameSession=false;path=/",localStorage.clear(),delete map.userId,window.location=properties.ui_domain}}else{var a=e.schoolVOList;for($(editUserdetails[6]).html(""),d=0,u=a.length;d<u;d++){var s=a[d].schoolName,o=a[d].schoolId,i=r&&r.toLowerCase()==s.toLowerCase()?' selected = "selected"':"",n=$('<option value="'+o+'"'+i+">"+s+"</option>");$(editUserdetails[6]).append(n)}"true"==map.schoolNotInListFlag&&($(editUserdetails[6]).parent().show(),$(editUserdetails[6]).show(),$(editUserdetails[7]).parent().show(),$(editUserdetails[7]).show(),$("#editmyaccount-otherSchoolName").show(),$("#editmyaccount-otherSchoolName").val(f)),$("#page-loading-spinner").hide()}}},b={locationVO:{locationName:$(editUserdetails[5]).val()},userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"MYACCOUNT_VIEW",pageNavigatingFrom:"",pageNavigatingTo:"myAccount"},sessionVO:map.sessionVO}},C={method:"POST",url:properties[properties.env]+"/schoolListPopulationService/getSchoolListFromCacheByLocation",data:b,handler:v,target:null};Utility.fireRequest(C)}else"true"==map.schoolNotInListFlag&&($("#editmyaccount-otherSchoolName").show(),$("#editmyaccount-otherSchoolName").val(f)),$("#page-loading-spinner").hide();themisAdminlanding?($("#editmyaccount-schoolName").attr("disabled",!0),$("#editmyaccount-schoolLocation").attr("disabled",!0),$("#editmyaccount-countryName").attr("disabled",!0)):($("#editmyaccount-schoolName").removeAttr("disabled"),$("#editmyaccount-schoolLocation").removeAttr("disabled"),$("#editmyaccount-countryName").removeAttr("disabled"))}}},Handler.updateUserDetail={request:function(e){var t="false";e.data.userId=map.userId;var a=this.form[0][5],s=this.form[0][6],o=this.form[0][4],i=$("#editmyaccount-emailPreferences").val(),r=map.userRole,n=map.userRoleId,l=o.options[o.selectedIndex].text;if("United States"===l){var d=s.options[s.selectedIndex].value,c=s.options[s.selectedIndex].text,u=a.options[a.selectedIndex].text;"-999"==d&&(c=e.data.other,t="true")}else if("United States"!==l){c=e.data.other,u="NA",d="-999";t="true"}map.updatedUserName=e.data.firstName,e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,firstName:e.data.firstName,lastName:e.data.lastName,email:map.email,userRole:r,userRoleId:n,schoolId:d,schoolName:c,country:l,schoolLocation:u,subscriptionFlag:i,schoolNotInListFlag:t}},e.data.userVO.userActivityVO={lastActivityCode:"MYACCOUNT_VIEW",pageNavigatingFrom:"",pageNavigatingTo:"MYACCOUNT"},e.data.userVO.sessionVO=map.sessionVO},response:function(e,t){if(localStorage.getItem("userId")||CaseConnect.currentUserId,"false"===e.status)delete map.updatedUserName,alert("Unable to update the user data"),sessionAuthFails(e),Utility.hideSpinner();else{map.myAccountPageUpdated="editProfile",myAcReq={},myAcReq.data={},Handler.myAccount.request(myAcReq),myAcReq.method="POST";var a=properties[properties.env]+"/manageUserService/getUserDetail";myAcReq.url=a,myAcReq.handler=Handler.myAccount,Utility.fireRequest(myAcReq)}}},Handler.changePassword={request:function(e){map.newPasslength=e.data.passwordNew.length,e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,password:e.data.passwordCurrent,passwordNew:e.data.passwordNew,userActivityVO:{lastActivityCode:"MYACCOUNT_VIEW",pageNavigatingFrom:"myAccount",pageNavigatingTo:"myAccount"}}},e.data.userVO.sessionVO=map.sessionVO},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)$(".change-password-heading").addClass("").after("<span class='error-text error-label display-this'>"+e.errorMessg+"</span>"),Utility.hideSpinner(),sessionAuthFails(e),event.stopPropagation();else{var a=map.newPasslength;localStorage.setItem("lenOfPassword",a);var s="********************";s=s.substr(0,a),$("#encrypt-password").html(s),map.myAccountPageUpdated="changePassword",myAcReq={},myAcReq.data={},Handler.myAccount.request(myAcReq),myAcReq.method="POST";var o=properties[properties.env]+"/manageUserService/getUserDetail";myAcReq.url=o,myAcReq.handler=Handler.myAccount,Utility.fireRequest(myAcReq)}}},Handler.createNewPassword={request:function(e){var t=e.url.split("/"),a=t[t.length-1].split("?")[1].split("&")[0].split("=")[1];e.data={userVO:{userId:a,passwordNew:e.data.password}},Handler.decorate(e.data)},response:function(e,t){(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status?("bus.exception.this.is.not.an.activated.account"===e.wkErrorCode?$(".account-validation-msg").css("display","block"):$(".create-new-password-text").addClass("").after("<span class='reset-error-msg error-label'>"+e.errorMessg+"</span>"),Utility.hideSpinner()):map.isIE9?(localStorage.setItem("requestedPage","continueLogin.html"),window.location=properties.ui_domain):localStorage.getItem("userId")?window.location=properties.ui_domain:(window.history.pushState({page:"login"},"Casebook Connect | Legal Education from Wolters Kluwer",properties.ui_domain+"login"),map.wk_conatiner.load("continueLogin.html?v8",function(){$("#login_email").val(""),$("#login_email").focus(),$(".login-blk").show(),$(".reset-login-blk").hide(),$(".static-page-bar").show(),$(".footer-link").show(),$(".login-remember-label").show(),Utility.hideSpinner(),Utility.getAnonymousSessionAuthToken()}))}},Handler.getStudyDashBoardForProfessor={request:function(e){e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:CaseConnect.currentClassId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{bookId:CaseConnect.currentBookId}},""!==CaseConnect.currentClassId&&null!==CaseConnect.currentClassId&&(e.data.classVO.classId=CaseConnect.currentClassId),Utility.showSpinner()},response:function(e,t){if("false"===e.status)alert("Error occured while saving data"),sessionAuthFails(e),Utility.hideSpinner();else{CaseConnect.studyDashBoardVO=e.studyDashBoardVO;var a=e.studyDashBoardVO.numberOfEnrolledStudentInClass;CaseConnect.currentClassEnrollmentCount=e.studyDashBoardVO.numberOfEnrolledStudentInClass;var s=e.studyDashBoardVO.enrolledStudentList;if($(".class-enrolled-students-count, .enrolled-students-list, #filterContainer, #studyDashBoard").hide(),$(".faculty-dashboard").show(),$(".faculty-dashboard").addClass("display-inline-block"),0==a)$("#studyDashBoard").html("No students enrolled."),$(".class-enrolled-students-count").text("No students enrolled."),$("#archivedStudyDashboard,#archivedSeperator,#hyperLinkForArchive").hide(),$(".class-enrolled-students-count, #studyDashBoard").show(),$(window).trigger("resize");else{$("#faculty-delete-class-button").css("display","none"),"object"==$.type(s)&&(s=[s]),$(".enrolled-students-list").html("");for(var o=0;o<s.length;o++){var i=$('<div class="col-md-6 col-sm-7 col-xs-12">'+s[o].lastName+", "+s[o].firstName+'</div><div class="col-md-6 col-sm-5 col-xs-12"></div>');$(".enrolled-students-list").append(i)}if(a<2)$(".class-enrolled-students-count").text(a+" Student Enrolled"),$("#studyDashBoard").html("Not enough enrolled students to display study center data.").show(),$("#archivedStudyDashboard,#archivedSeperator,#hyperLinkForArchive").hide(),$(window).trigger("resize");else{$(".class-enrolled-students-count").text(a+" Students Enrolled"),"object"==$.type(e.studyDashBoardVO.studyDashBoardDetail)&&(e.studyDashBoardVO.studyDashBoardDetail=[e.studyDashBoardVO.studyDashBoardDetail]);var r=e.studyDashBoardVO.studyDashBoardDetail;CaseConnect.questionTypeList=["flashcard","hypothetical","essay","issuespotting"],Handler.getStudyDashBoardForProfessor.processStudyDashBoardData(r,a),$(window).trigger("resize")}$(".class-enrolled-students-count").show()}Utility.hideSpinner(),adjustLeftNavHeight()}},processStudyDashBoardData:function(e,t){for(var a=0;a<e.length;a++){"object"==$.type(e[a].learningObjectiveProgressVOList)&&(e[a].learningObjectiveProgressVOList=[e[a].learningObjectiveProgressVOList]);for(var s=e[a].learningObjectiveProgressVOList,o=0,i=0,r=0,n=0,l=e[a].chapterVO,d=$("#filterContainer input:checked"),c=0;c<d.length;++c)for(var u=0;u<l.distinctChapterResponseList.length;u++)if($(d[c]).attr("id")==l.distinctChapterResponseList[u].questionType){o+=parseInt(l.distinctChapterResponseList[u].totalQuestions),i+=parseInt(l.distinctChapterResponseList[u].totalCorrectAnswer),r+=parseInt(l.distinctChapterResponseList[u].totalPartialCorrect),n+=parseInt(l.distinctChapterResponseList[u].totalWrongAnswer);break}for(var p=0;p<s.length;p++){"object"==$.type(s[p].learningObjectiveResponseList)&&(s[p].learningObjectiveResponseList=[s[p].learningObjectiveResponseList]);for(var m=s[p].learningObjectiveResponseList,h=0,g=0,f=0,v=0,b=0;b<m.length;b++)CaseConnect.questionTypeList.indexOf(m[b].questionType)>-1||(h+=parseInt(m[b].totalQuestions),g+=parseInt(m[b].totalCorrectAnswer),f+=parseInt(m[b].totalPartialCorrect),v+=parseInt(m[b].totalWrongAnswer));var C=Handler.getStudyDashBoardForStudent.roundOff(g/(g+f+v)*100),y=Handler.getStudyDashBoardForStudent.roundOff(f/(g+f+v)*100),O=Handler.getStudyDashBoardForStudent.roundOff(100-(C+y)),k=Handler.getStudyDashBoardForStudent.roundOff((g+f+v)/(h*t)*100);s[p].totalQuestions=h,s[p].correctPercentage=isNaN(C)?0:C,s[p].partialCorrectPercentage=isNaN(y)?0:y,s[p].incorrectPercentage=isNaN(O)?0:O,s[p].answeredPercentage=isNaN(k)?0:k}var w=Handler.getStudyDashBoardForStudent.roundOff(i/(i+r+n)*100),S=Handler.getStudyDashBoardForStudent.roundOff(r/(i+r+n)*100),V=Handler.getStudyDashBoardForStudent.roundOff(100-(w+S)),A=Handler.getStudyDashBoardForStudent.roundOff((i+r+n)/(o*t)*100);e[a].totalQuestions=o,e[a].correctPercentage=isNaN(w)?0:w,e[a].partialCorrectPercentage=isNaN(S)?0:S,e[a].incorrectPercentage=isNaN(V)?0:V,e[a].answeredPercentage=isNaN(A)?0:A}var I=Handlebars.getTemplate("studyDashBoardForProfessor")(e);if(1==archivedStatus){$("#archivedStudyDashBoardProfessor").html(I),$("#filterContainer, #archivedStudyDashBoardProfessor").show();var L=parseInt($("#archivedStudyDashBoardProfessor").css("height"))-60;$("#archivedStudyDashBoardProfessor").find("table").find(".professor-dashboard-table").removeClass("professor-dashboard-table").addClass("archived-professor-dashboard-table"),$("#archivedStudyDashBoardProfessor").find("table").find(".professor-dashboard-table-td").removeClass("professor-dashboard-table-td").addClass("archived-professor-dashboard-table-td"),$("#archivedStudyDashBoardProfessor").find("ul").removeClass("bars").addClass("archived-bars"),$("#archivedStudyDashBoardProfessor").find("li").find(".bar").removeClass("bar").addClass("archived-bar"),$(".archived-professor-dashboard-table").height(L+"px"),$(".archived-professor-dashboard-table-td").height(L+"px"),$(".archived-bars li .archived-bar").each(function(e,t){var a=$(this).data("percentage");0==parseInt(a)?($(this).closest("ul").append("<div class='faculty-dashboard-empty-result'></div>"),$(this).closest("li").hide()):$(this).animate({width:a+"%",height:"100%"},1e3)}),archivedStatus=!1}else{$("#studyDashBoard").html(I),$("#filterContainer, #studyDashBoard").show();var P=parseInt($("#studyDashBoard").css("height"))-60;$(".professor-dashboard-table").height(P+"px"),$(".professor-dashboard-table-td").height(P+"px"),$(".bars li .bar").each(function(e,t){var a=$(this).data("percentage");0==parseInt(a)?($(this).closest("ul").append("<div class='faculty-dashboard-empty-result'></div>"),$(this).closest("li").hide()):$(this).animate({width:a+"%",height:"100%"},1e3)})}},updateResults:function(){if(0==$("#filterContainer > input:checked").length){var e=$("#filterContainer input#multichoice");e.prop("checked","checked"),Handler.getStudyDashBoardForStudent.updateQuestionTypeList(e[0])}var t=CaseConnect.studyDashBoardVO,a=t.numberOfEnrolledStudentInClass;"object"==$.type(t.studyDashBoardDetail)&&(t.studyDashBoardDetail=[t.studyDashBoardDetail]);var s=t.studyDashBoardDetail;Handler.getStudyDashBoardForProfessor.processStudyDashBoardData(s,a)},updateQuestionTypeList:function(e){var t=$(e),a=CaseConnect.questionTypeList;t.is(":checked")?a.splice(a.indexOf(t.attr("id")),1):a.push(t.attr("id")),CaseConnect.questionTypeList=a},showHideLearningObjective:function(e){$(window).width()<768&&event.stopPropagation();var t=$(e);t.parent().find(">a:first").toggleClass("glyphicon-chevron-right").toggleClass("glyphicon-chevron-down"),t.parent().find(">a:first").hasClass("glyphicon-chevron-down")?t.parent().find(">a:first").attr("aria-label","Hide chapter details"):t.parent().find(">a:first").hasClass("glyphicon-chevron-right")&&t.parent().find(">a:first").attr("aria-label","View chapter details"),t.parent().parent().next(".learningObjectiveList").slideToggle("slow",function(){if(t.parent().parent().parent().hasClass("archived-dashboard-snapshot")){var e=parseInt($("#archivedStudyDashBoardProfessor").css("height"))-60;$(".archived-professor-dashboard-table").height(e+"px"),$(".archived-professor-dashboard-table-td").height(e+"px")}else{var a=parseInt($("#studyDashBoard").css("height"))-60;$(".professor-dashboard-table").height(a+"px"),$(".professor-dashboard-table-td").height(a+"px")}adjustLeftNavHeight()})},expandCollapseList:function(){$("#enrolled-students-list").slideToggle("slow",function(){adjustLeftNavHeight()}),$("#faculty-class-enrolled-students").find("h2 > a:first").toggleClass("expand-enrolled-students-list").toggleClass("collapse-enrolled-students-list"),$("#faculty-class-enrolled-students").find("h2 > a:first").hasClass("collapse-enrolled-students-list")?$("#faculty-class-enrolled-students").find("h2 > a:first").attr("aria-label","Hide enrolled students"):$("#faculty-class-enrolled-students").find("h2 > a:first").hasClass("expand-enrolled-students-list")&&$("#faculty-class-enrolled-students").find("h2 > a:first").attr("aria-label","View enrolled students"),adjustLeftNavHeight()}},Handler.student={request:function(e){CaseConnect.currentUserId=""!=CaseConnect.currentUserId?CaseConnect.currentUserId:map.userId,e.data={userVO:{userId:CaseConnect.currentUserId,userRole:CaseConnect.currentUserRole,userRoleId:CaseConnect.currentUserRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_PROFESSORS_AND_CLASSES_FOR_ENROLL_STUDENT",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId}},Utility.showSpinner()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alert("Error occured while fetching data"),sessionAuthFails(e),Utility.hideSpinner();else{var a=e.userList,s=e.classVOList;if("object"==$.type(a)&&(a=[a]),"object"==$.type(s)&&(s=[s]),CaseConnect.classList=s,$("#student-professor-name option:not(:eq(0))").remove(),$("#student-professor-name").val("-999"),$("#student-class-code").removeAttr("disabled"),null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(CaseConnect.currentUserId=map.userId,CaseConnect.currentUserRoleId=map.userRoleId,CaseConnect.currentUserRole=map.userRole,checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),a)for(var o=0;o<a.length;o++){var i=$('<option value="'+a[o].userId+'">'+a[o].lastName+", "+a[o].firstName+"</option>");$("#student-professor-name").append(i)}studentEnrollClassWelcome()}},goToStudentEnrollPage:function(event){localStorage.setItem("eulaValidationCheck",event.currentTarget.getAttribute("eulaFlag"));var eulaValidationElem=localStorage.getItem("eulaValidationCheck");if("true"===eulaValidationElem){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),event)var listOfAttributes=event.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(listOfAttributes).each(function(){var e=this.name,t=this.value;$("#eula-validation-modal button").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"})}$(".books-thumbnail").popover("hide"),map.overlay.fadeOut(200),map.wk_conatiner.load("studentEnroll.html?v19495",function(){$(".bookshelflink").show(),$(".tutoriallink").show(),classInsightsQuestionResultCalled=!1,enableCopyPaste(),$("#bookshelf-nav-menu-mobile").modal("hide"),insideClassInsightsPage=!0,insideStudycenterPage=!1,insideNewsFeed=!1,insideCasesPage=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideOutline=!1,insideStaticPage=!1,insideBookshelf=!1,insideResourcePage=!1,insideGlobalSearchResult=!1,$(window).trigger("resize");var b=document.documentElement;b.setAttribute("data-useragent",navigator.userAgent),b.setAttribute("data-platform",navigator.platform);var ie10=navigator.userAgent.match(/Trident\/[6]/i);ie10&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"});var bookTitle="",thumbnailimagepath="";if(event.target?(CaseConnect.currentBookId=event.target.getAttribute("bookId"),CaseConnect.bookType=event.target.getAttribute("bookType"),CaseConnect.resourceFlag=event.target.getAttribute("resourceFlag"),CaseConnect.casesFlag=event.target.getAttribute("casesFlag"),CaseConnect.newsFeedFlag=event.target.getAttribute("newsFeedFlag"),CaseConnect.currentProductId=event.target.getAttribute("relatedThemisproductId"),localStorage.setItem("currentProductId",CaseConnect.currentProductId),CaseConnect.bookTitle=event.target.getAttribute("bookTitle"),bookTitle=event.target.getAttribute("booktitle"),thumbnailimagepath=event.target.getAttribute("thumbnailimagepath")):(CaseConnect.currentBookId=event.bookId,CaseConnect.bookType=event.bookType,CaseConnect.resourceFlag=event.resourceFlag,CaseConnect.casesFlag=event.casesFlag,CaseConnect.newsFeedFlag=event.newsFeedFlag,CaseConnect.currentProductId=event.relatedThemisproductId,localStorage.setItem("currentProductId",CaseConnect.currentProductId),bookTitle=event.bookTitle,CaseConnect.bookTitle=event.target.getAttribute("bookTitle"),thumbnailimagepath=event.thumbnailImagePath),$(".thumbnail-image").attr("src",thumbnailimagepath).attr("alt",bookTitle),$(".bookshelf-book-title").html(bookTitle),$(".bookshelf-book-title").attr("title",bookTitle),$(".ereader-main-header-title").html(bookTitle),$(".read-modal-book-title").html(bookTitle),$(".faculty-open-book").css("display","none"),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),bookSpecificFeatureDisplay(),!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf){for(var bookDataArr=CaseConnect.navigatingAwayFromNewBookshelf,count=0;count<bookDataArr.length;++count)if(bookDataArr[count].bookId==CaseConnect.currentBookId){CaseConnect.bookData=bookDataArr[count];break}}else event.target||(CaseConnect.bookData=event);classInsightsTotalBookQuestion();var handler="student",request={},data={};request.url="/manageClassWebService/getProfessorAndClassListForStudentEnrollment",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request),adjustLeftNavHeight(),getMyRequestNoftificationCount(),$("#student-details-container").hide(),$(".student-dashboard").show(),$("#studentEroll-right-header").show(),map.wk_conatiner.removeAttr("style");var handler="getStudyDashBoardForStudent",request={},req_data={};request.url="/manageClassWebService/getStudyDashBoardForProfessorOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=req_data,request.handler.request.apply(null,[request]),Utility.fireRequest(request),$(window).trigger("resize"),adminSuppressFunc()})},cancelStudentEnroll:function(){if(""!=$.trim($("#student-class-code").val())||"-999"!=$("#student-professor-name").val()||"-999"!=$("#student-class-name").val())$("#cancel-enroll-dialog").modal("show");else{var handler="goToBookShelf",request={},data={};request.url="/bookShelfRetrivalService/getBookList",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}},resetStudentEnroll:function(){if(""!=$.trim($("#student-class-code").val())||"-999"!=$("#student-professor-name").val()||"-999"!=$("#student-class-name").val())$("#cancel-enroll-dialog").modal("show");else{var handler="goToBookShelf",data={},request={url:"/bookShelfRetrivalService/getBookList"};request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}},populateClassList:function(e){var t=$(e.target).val();if("-999"==t)$("#student-class-name option:not(:eq(0))").remove(),$("#student-class-name").val("-999").trigger("change"),$("#student-class-name").attr("disabled","disabled"),$("#student-class-code").removeAttr("disabled");else{$("#student-class-name option:not(:eq(0))").remove(),$("#student-class-name").val("-999").trigger("change");var a=CaseConnect.classList;if(a&&a.length>0){for(var s=0;s<a.length;s++)if(a[s].createdBy==t){var o="";if(a[s].coProfessorList){var i=a[s].coProfessorList;"object"==$.type(i)&&(i=[i]);for(s=0;s<i.length;s++)o+=i[s].firstName+" "+i[s].lastName+", ";o=o.substring(0,o.lastIndexOf(","))}$("#student-class-name").append('<option value="'+a[s].classId+'" classCode="'+a[s].classCode+'" semesterYear="'+a[s].semesterYear+'" section="'+a[s].section+'" meetingTime="'+a[s].meetingTime+'" coProfessor="'+o+'" classDescription="'+a[s].classDescription+'">'+a[s].className+"</option>")}$("#student-class-code").val("").attr("disabled","disabled"),$("#student-class-name").removeAttr("disabled")}else $("#generic-message-text > span").html("No classes available for this professor."),$("#generic-message-dialog").modal("show")}},validateData:function(e){var t=$.trim($("#student-class-code").val()),a="-999"!=$("#student-class-name").val()?$("#student-class-name").val():"",s="-999"!=$("#student-professor-name").val()?$("#student-professor-name").val():"";""==t&&""==a&&(e.stopPropagation(),$("#generic-message-text > span").html("Please provide a Class Code or select Professor Name and Class Name."),$("#generic-message-dialog").modal("show")),""!=a&&""==s&&(e.stopPropagation(),$("#generic-message-text > span").html("Please provide a Class Code or select Professor Name and Class Name."),$("#generic-message-dialog").modal("show"))},populateAdditionalDetail:function(){var e=$("#student-class-name option:selected");"-999"==e.val()?($("#additional-info").hide(),$("#enrollAtBottom").hide()):(""!=e.attr("classDescription")?($("#class-desc > span").html(e.attr("classDescription")),$("#class-desc").show()):$("#class-desc").hide(),""!=e.attr("semesterYear")?($("#sem-year > span").html(e.attr("semesterYear")),$("#sem-year").show()):$("#sem-year").hide(),""!=e.attr("section")?($("#section-name > span").html(e.attr("section")),$("#section-name").show()):$("#section-name").hide(),""!=e.attr("meetingTime")?($("#meeting-time > span").html(e.attr("meetingTime")),$("#meeting-time").show()):$("#meeting-time").hide(),""!=e.attr("coProfessor")?($("#coprofessor-name > span").html(e.attr("coProfessor")),$("#coprofessor-name").show()):$("#coprofessor-name").hide(),$("#additional-info").show(),$("#enrollAtBottom").show())},displayNoProfessorMsg:function(e){13!=e.keyCode&&"click"!=e.type||1==$("#student-professor-name").find("option").length&&setTimeout(function(){$("#generic-message-text > span").html("No professor at your school has created a class for this book."),$("#generic-message-dialog").modal("show")},500)}},Handler.getClassDetails={request:function(e){var t="";if($(this).attr("data-handler"))t=$(this).attr("createdBy"),CaseConnect.currentClassId=$(this).attr("classId"),CaseConnect.currentBookId=$(this).attr("bookId"),CaseConnect.bookTitle=$(this).attr("booktitle"),CaseConnect.thumbnailimagepath=$(this).attr("thumbnailimagepath");else if(!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf){for(var a=CaseConnect.navigatingAwayFromNewBookshelf,s=0;s<a.length;++s)if(a[s].bookId==CaseConnect.currentBookId){CaseConnect.currentClassId=lastVisitedClassId,CaseConnect.currentBookId=a[s].bookId;break}}else CaseConnect.bookData.bookId?(CaseConnect.currentClassId=lastVisitedClassId,CaseConnect.currentBookId=CaseConnect.bookData.bookId,CaseConnect.bookType=CaseConnect.bookData.bookType):CaseConnect.navigatingAwayFromNewBookshelf||(CaseConnect.currentClassId=lastVisitedClassId,CaseConnect.currentBookId||bookChapterSupplimentList||(getChapterAndSupplementalList(),CaseConnect.currentBookId=bookChapterSupplimentList[0].bookId,CaseConnect.bookType=bookChapterSupplimentList[0].bookType));CaseConnect.currentUserId=""!=CaseConnect.currentUserId?CaseConnect.currentUserId:map.userId,e.data={userVO:{userId:CaseConnect.currentUserId,userRole:CaseConnect.currentUserRole,userRoleId:CaseConnect.currentUserRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_CLASS",pageNavigatingFrom:"ClassInsight",pageNavigatingTo:"ClassInsight",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:CaseConnect.currentClassId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{classId:CaseConnect.currentClassId,bookId:CaseConnect.currentBookId,createdBy:t}},Utility.showSpinner()},response:function(e,t){$(".books-thumbnail").popover("hide"),map.overlay.fadeOut(200),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status?(alert("Error occured while fetching data"),sessionAuthFails(e),Utility.hideSpinner()):("true"==e.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),void 0!==e.newsFeedFlag&&(CaseConnect.newsFeedFlag=e.newsFeedFlag),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),Handler.getClassDetails.processClassDetails(e))},processClassDetails:function(data){Handler.login.updateStatusBar(),insideClassInsightsPage=!0,insideStudycenterPage=!1,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideOutline=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideStaticPage=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,enableCopyPaste(),map.wk_conatiner.load("studentEnroll.html?v19495",function(){"true"==data.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),$(".bookshelflink").show(),$(".tutoriallink").show(),classInsightsQuestionResultCalled=!1,$("#bookshelf-nav-menu-mobile").modal("hide"),$(window).trigger("resize"),data.resourceFlag&&(CaseConnect.resourceFlag=data.resourceFlag),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),void 0!==data.casesFlag&&"true"==data.casesFlag&&(CaseConnect.casesFlag=data.casesFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide()),void 0!==data.newsFeedFlag&&(CaseConnect.newsFeedFlag=data.newsFeedFlag),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),bookSpecificFeatureDisplay();var b=document.documentElement;b.setAttribute("data-useragent",navigator.userAgent),b.setAttribute("data-platform",navigator.platform);var ie10=navigator.userAgent.match(/Trident\/[6]/i);if(ie10&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf){for(var bookDataArr=CaseConnect.navigatingAwayFromNewBookshelf,count=0;count<bookDataArr.length;++count)if(bookDataArr[count].bookId==CaseConnect.currentBookId){CaseConnect.bookData=bookDataArr[count];break}}else data.bookVO&&(CaseConnect.bookData=data.bookVO);if("true"==data.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),void 0!==data.casesFlag&&(CaseConnect.casesFlag=data.casesFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide()),void 0!==data.newsFeedFlag&&"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),CaseConnect.currentChapterId="",CaseConnect.currentBookId=data.bookVO.bookId,CaseConnect.bookType=data.bookVO.bookType,CaseConnect.bookTitle=data.bookVO.bookTitle,CaseConnect.thumbnailimagepath=data.bookVO.thumbnailImagePath,CaseConnect.currentClassId=data.classVO.classId,data=data.classVO,$("#right-header-bookTitle").html(CaseConnect.bookTitle.toUpperCase()),$("#right-header-bookTitle").attr("title",CaseConnect.bookTitle),$(".thumbnail-image").attr("src",CaseConnect.thumbnailimagepath).attr("alt",CaseConnect.bookTitle),$(".bookshelf-book-title").html(CaseConnect.bookTitle),$(".bookshelf-book-title").attr("title",CaseConnect.bookTitle),$(".ereader-main-header-title").html(CaseConnect.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookTitle),$(".faculty-open-book").css("display","none"),$(".class-insights-header").html("Class Insights"),"-99999"==data.classId){var handler="student",request={},req_data={};request.url="/manageClassWebService/getProfessorAndClassListForStudentEnrollment",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=req_data,request.handler.request.apply(null,[request]),Utility.fireRequest(request),classInsightsTotalBookQuestion(),$("#student-details-container").hide(),$(".student-dashboard").show(),$("#studentEroll-right-header").show(),map.wk_conatiner.removeAttr("style");var handler="getStudyDashBoardForStudent",request={},req_data={};request.url="/manageClassWebService/getStudyDashBoardForProfessorOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=req_data,request.handler.request.apply(null,[request]),Utility.fireRequest(request),map.wk_conatiner.removeAttr("style")}else{if($("#studentEnroll-heading").html("Class Insights"),$(".class-insights-header").html("Class Insights"),$(".student-book-title").html(data.className),data.professorVO?$("#std-faculty-name > span.student-label-text").html(data.professorVO.firstName+" "+data.professorVO.lastName):$("#std-faculty-name").hide(),data.semesterYear?$("#std-semester-name > span.student-label-text").html(data.semesterYear):$("#std-semester-name").hide(),data.section?$("#std-section-name > span.student-label-text").html(data.section):$("#std-section-name").hide(),data.meetingTime?$("#std-meeting-time > span.student-label-text").html(data.meetingTime):$("#std-meeting-time").hide(),data.classDescription?$("#std-class-desc > span.student-label-text").html(data.classDescription):$("#std-class-desc").hide(),data.coProfessorList){var coProfessorList=data.coProfessorList;"object"==$.type(coProfessorList)&&(coProfessorList=[coProfessorList]);for(var coProfessors="",i=0;i<coProfessorList.length;i++)coProfessors+=coProfessorList[i].firstName+" "+coProfessorList[i].lastName+", ";coProfessors=coProfessors.substring(0,coProfessors.lastIndexOf(",")),$("#std-coprofessor-name > span.student-label-text").html(coProfessors)}else $("#std-coprofessor-name").hide();if(data.fileList){var fileList=data.fileList;"object"==$.type(fileList)&&(fileList=[fileList]);for(var j=0;j<fileList.length;j++){if(0==j)var loMaterial=$('<div class="faculty-learning-materials-list" style="margin-top:0px;" fileId="'+fileList[j].fileId+'" onclick="Handler.click.downloadFacultyDocumet(event)"></div>');else var loMaterial=$('<div class="faculty-learning-materials-list" fileId="'+fileList[j].fileId+'" onclick="Handler.click.downloadFacultyDocumet(event)"></div>');var materialName=$('<a href="#"><span class="faculty-material-for-stud-name reset-additional-info display-inline-block" title="'+fileList[j].fileName+'">'+fileList[j].fileName+"</span></a>"),icon="";".doc"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/doc-icon.png" alt="Microsoft Word"></a>'):".docx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/doc-icon.png" alt="Microsoft Word"></a>'):".pdf"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/pdf-icon.png" alt="PDF"></a>'):".jpg"===fileList[j].fileType||".JPG"===fileList[j].fileType||".png"===fileList[j].fileType||".PNG"===fileList[j].fileType||".jpeg"===fileList[j].fileType||".JPEG"===fileList[j].fileType||".tif"===fileList[j].fileType||".TIF"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/jpg-icon.png" alt="Image"></a>'):".ppt"===fileList[j].fileType||".pptx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/ppt-icon.png" alt="Microsoft PowerPoint"></a>'):".zip"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/zip-icon.png" alt="ZIP"></a>'):".xls"===fileList[j].fileType||".xlsx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/xls-icon.png" alt="Microsoft Excel"></a>'):".rtf"===fileList[j].fileType&&(icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/rtf-icon.png" alt="Rich Text Format"></a>')),loMaterial.append(icon).append(materialName),$("#faculty-uploaded-list").append(loMaterial)}fileList.length>4?$("#faculty-uploaded-list").css({"max-height":"140px","overflow-y":"scroll",width:"63%"}):$("#faculty-uploaded-list").css({"max-height":"1005px","overflow-y":"hidden"})}else $("#faculty-learning-materials").hide();$("#facultyClassCode").html(data.classCode.toUpperCase()),$("#student-enroll-container").hide(),$("#student-details-container, .student-dashboard").show(),$("#studentEroll-right-header").show(),classInsightsTotalBookQuestion(),map.wk_conatiner.removeAttr("style"),Utility.showSpinner();var handler="getStudyDashBoardForStudent",request={},req_data={};request.url="/manageClassWebService/getStudyDashBoardForProfessorOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=req_data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}adjustLeftNavHeight(),$(window).trigger("resize"),getMyRequestNoftificationCount(),adminSuppressFunc()})}},Handler.enrollStudentInClass={request:function(e){var t=$.trim($("#student-class-code").val()),a="-999"!=$("#student-class-name").val()?$("#student-class-name").val():"",s="-999"!=$("#student-professor-name").val()?$("#student-professor-name").val():"";CaseConnect.classList;if(CaseConnect.currentUserId=""!=CaseConnect.currentUserId?CaseConnect.currentUserId:map.userId,!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf)for(var o=CaseConnect.navigatingAwayFromNewBookshelf,i=0;i<o.length;++i)if(o[i].bookId==CaseConnect.currentBookId){CaseConnect.currentClassId=lastVisitedClassId,CaseConnect.currentBookId=o[i].bookId;break}e.data={userVO:{userId:CaseConnect.currentUserId,userRole:CaseConnect.currentUserRole,userRoleId:CaseConnect.currentUserRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_ENROLL_STUDENT_IN_CLASS",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:a},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}},""!=t?e.data.classVO={classCode:t,bookId:CaseConnect.currentBookId}:""!=a&&(CaseConnect.currentClassId=a,""!=s?e.data.classVO={classId:a,createdBy:s,bookId:CaseConnect.currentBookId}:($("#generic-message-text > span").html("Please provide a Class Code or select Professor Name and Class Name."),$("#generic-message-dialog").modal("show"))),Utility.showSpinner()},response:function(data,status){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===data.status)sessionAuthFails(data),Utility.hideSpinner(),"bus.exception.valid.cq.class.code"==$.trim(data.wkErrorCode)?$("#error-message-dialogue").modal("show"):"bus.exception.invalid.class.code"==$.trim(data.wkErrorCode)?($("#error-message-text > span").html("Invalid class code."),$("#error-message-text").attr("title","Invalid class code"),$("#error-message-text").attr("aria-label","Invalid class code"),$("#error-message-dialog").modal("show")):($("#generic-message-text > span").html(data.errorMessg),$("#generic-message-dialog").modal("show"));else{$("#studentEnroll-heading").html("Class Insights"),$(".class-insights-header").html("Class Insights"),$("#right-header-bookTitle").html($.trim($("#create-class-book-column img").attr("alt")).toUpperCase());var data=data.classVO;if("-999"!=$("#student-class-name").val()&&"-999"!=$("#student-professor-name").val()){var selectedClass=$("#student-class-name option:selected"),selectedProf=$("#student-professor-name option:selected");$(".student-book-title").html(selectedClass.text()),$("#std-faculty-name > span").html(selectedProf.text()),selectedClass.attr("semesterYear")?$("#std-semester-name > span.student-label-text").html(selectedClass.attr("semesterYear")):$("#std-semester-name").hide(),selectedClass.attr("section")?$("#std-section-name > span.student-label-text").html(selectedClass.attr("section")):$("#std-section-name").hide(),selectedClass.attr("meetingTime")?$("#std-meeting-time > span.student-label-text").html(selectedClass.attr("meetingTime")):$("#std-meeting-time").hide(),selectedClass.attr("classDescription")?$("#std-class-desc > span.student-label-text").html(selectedClass.attr("classDescription")):$("#std-class-desc").hide(),$("#facultyClassCode").html(selectedClass.attr("classCode").toUpperCase())}else CaseConnect.currentClassId=data.classId,$(".student-book-title").html(data.className),$("#std-faculty-name > span").html(data.professorVO.firstName+" "+data.professorVO.lastName),null!=data&&data.semesterYear?$("#std-semester-name > span.student-label-text").html(data.semesterYear):$("#std-semester-name").hide(),null!=data&&data.section?$("#std-section-name > span.student-label-text").html(data.section):$("#std-section-name").hide(),null!=data&&data.meetingTime?$("#std-meeting-time > span.student-label-text").html(data.meetingTime):$("#std-meeting-time").hide(),null!=data&&data.classDescription?$("#std-class-desc > span.student-label-text").html(data.classDescription):$("#std-class-desc").hide(),$("#facultyClassCode").html(data.classCode.toUpperCase());if(null!=data&&data.coProfessorList){var coProfessorList=data.coProfessorList;"object"==$.type(coProfessorList)&&(coProfessorList=[coProfessorList]);for(var coProfessors="",i=0;i<coProfessorList.length;i++)coProfessors+=coProfessorList[i].firstName+" "+coProfessorList[i].lastName+", ";coProfessors=coProfessors.substring(0,coProfessors.lastIndexOf(",")),$("#std-coprofessor-name > span").html(coProfessors)}else $("#std-coprofessor-name").hide();if(null!=data&&data.fileList){var fileList=data.fileList;"object"==$.type(fileList)&&(fileList=[fileList]);for(var j=0;j<fileList.length;j++){if(0==j)var loMaterial=$('<div class="faculty-learning-materials-list" style="margin-top:0px;" fileId="'+fileList[j].fileId+'" onclick="Handler.click.downloadFacultyDocumet(event)"></div>');else var loMaterial=$('<div class="faculty-learning-materials-list" fileId="'+fileList[j].fileId+'" onclick="Handler.click.downloadFacultyDocumet(event)"></div>');var materialName=$('<a href="#"><span class="faculty-material-for-stud-name reset-additional-info display-inline-block" title="'+fileList[j].fileName+'">'+fileList[j].fileName+"</span></a>"),icon="";".doc"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/doc-icon.png" alt="Microsoft Word"></a>'):".docx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/doc-icon.png" alt="Microsoft Word"></a>'):".pdf"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/pdf-icon.png" alt="PDF"></a>'):".jpg"===fileList[j].fileType||".JPG"===fileList[j].fileType||".png"===fileList[j].fileType||".PNG"===fileList[j].fileType||".jpeg"===fileList[j].fileType||".JPEG"===fileList[j].fileType||".tif"===fileList[j].fileType||".TIF"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/jpg-icon.png" alt="Image"></a>'):".ppt"===fileList[j].fileType||".pptx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/ppt-icon.png" alt="Microsoft PowerPoint"></a>'):".zip"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/zip-icon.png" alt="ZIP"></a>'):".xls"===fileList[j].fileType||".xlsx"===fileList[j].fileType?icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/xls-icon.png" alt="Microsoft Excel"></a>'):".rtf"===fileList[j].fileType&&(icon=$('<a href="#/"><img class="faculty-materials-icon" src="img/bookshelf/rtf-icon.png" alt="Rich Text Format"></a>')),loMaterial.append(icon).append(materialName),$("#faculty-uploaded-list").append(loMaterial)}fileList.length>4?$("#faculty-uploaded-list").css({"max-height":"140px","overflow-y":"scroll",width:"100%"}):$("#faculty-uploaded-list").css({"max-height":"1005px","overflow-y":"hidden"})}else $("#faculty-learning-materials").hide();classInsightsTotalBookQuestion(),$("#student-enroll-container").hide(),$("#student-details-container, .student-dashboard").show(),$("#studentEroll-right-header").show(),$("#student-class-code").val(""),$("#student-professor-name").val("-999"),$("#student-class-name").val("-999").trigger("change"),$("#student-class-name").attr("disabled","disabled"),$("#student-class-code").removeAttr("disabled"),CaseConnect.fromEnroll=!0,Utility.showSpinner();var handler="getStudyDashBoardForStudent",request={},req_data={};request.url="/manageClassWebService/getStudyDashBoardForProfessorOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=req_data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}}},Handler.getStudyDashBoardForStudent={request:function(e){e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{bookId:CaseConnect.currentBookId}},null!==CaseConnect.currentClassId&&""!==CaseConnect.currentClassId?(e.data.classVO.classId=CaseConnect.currentClassId,e.data.userVO.lastViewedClassId=CaseConnect.currentClassId):(e.data.classVO.classId="-99999",e.data.userVO.lastViewedClassId="-99999"),Utility.showSpinner()},response:function(e,t){if(localStorage.getItem("userId")||CaseConnect.currentUserId,"false"===e.status)sessionAuthFails(e),Utility.hideSpinner();else{CaseConnect.studyDashBoardVO=e.studyDashBoardVO;var a=e.studyDashBoardVO.numberOfEnrolledStudentInClass;$("#filterContainer, #studyDashBoard").hide(),"object"==$.type(e.studyDashBoardVO.studyDashBoardDetail)&&(e.studyDashBoardVO.studyDashBoardDetail=[e.studyDashBoardVO.studyDashBoardDetail]);var s=e.studyDashBoardVO.studyDashBoardDetail;CaseConnect.questionTypeList=["multichoice","flashcard","hypothetical","essay","issuespotting"],Handler.getStudyDashBoardForStudent.processStudyDashBoardData(s,a),$(".class-enrolled-students-count").show(),Utility.hideSpinner(),CaseConnect.fromEnroll&&($("#student-enroll-success-message").modal("show"),CaseConnect.fromEnroll=!1)}},processStudyDashBoardData:function(e,t){t-=1;for(var a=0;a<e.length;a++){"object"==$.type(e[a].learningObjectiveProgressVOList)&&(e[a].learningObjectiveProgressVOList=[e[a].learningObjectiveProgressVOList]);for(var s=e[a].learningObjectiveProgressVOList,o=0,i=0,r=0,n=0,l=0,d=0,c=0,u=e[a].chapterVO,p=$("#filterContainer input:checked"),m=0;m<p.length;++m)for(var h=0;h<u.distinctChapterResponseList.length;h++)if($(p[m]).attr("id")==u.distinctChapterResponseList[h].questionType){o+=parseInt(u.distinctChapterResponseList[h].totalQuestions),i+=parseInt(u.distinctChapterResponseList[h].totalCorrectAnswer),r+=parseInt(u.distinctChapterResponseList[h].totalPartialCorrect),n+=parseInt(u.distinctChapterResponseList[h].totalWrongAnswer),l+=parseInt(u.distinctChapterResponseList[h].totalCorrectAnswerByLoggedinStudent),d+=parseInt(u.distinctChapterResponseList[h].totalPartialCorrectAnswerByLoggedinStudent),c+=parseInt(u.distinctChapterResponseList[h].totalWrongAnswerByLoggedinStudent);break}for(var g=0;g<s.length;g++){"object"==$.type(s[g].learningObjectiveResponseList)&&(s[g].learningObjectiveResponseList=[s[g].learningObjectiveResponseList]);var f=s[g].learningObjectiveResponseList,v=0,b=0,C=0,y=0,O=0,k=0,w=0,S=0;for(m=0;m<p.length;++m)for(var V=0;V<f.length;V++)$(p[m]).attr("id")==f[V].questionType&&(v+=parseInt(f[V].totalQuestions),b+=parseInt(f[V].totalCorrectAnswer),C+=parseInt(f[V].totalPartialCorrect),y+=parseInt(f[V].totalWrongAnswer),O+=parseInt(f[V].totalQuestions),k+=parseInt(f[V].totalCorrectAnswerByLoggedinStudent),w+=parseInt(f[V].totalPartialCorrectAnswerByLoggedinStudent),S+=parseInt(f[V].totalWrongAnswerByLoggedinStudent));var A=Handler.getStudyDashBoardForStudent.roundOff(b/(b+C+y)*100),I=Handler.getStudyDashBoardForStudent.roundOff(C/(b+C+y)*100),L=Handler.getStudyDashBoardForStudent.roundOff(100-(A+I)),P=Handler.getStudyDashBoardForStudent.roundOff((b+C+y)/(v*t)*100);s[g].totalQuestions=v,s[g].correctPercentage=isNaN(A)?0:A,s[g].partialCorrectPercentage=isNaN(I)?0:I,s[g].incorrectPercentage=isNaN(L)?0:L,s[g].answeredPercentage=isNaN(P)?0:P;var T=Handler.getStudyDashBoardForStudent.roundOff(k/(k+w+S)*100),N=Handler.getStudyDashBoardForStudent.roundOff(w/(k+w+S)*100),F=Handler.getStudyDashBoardForStudent.roundOff(100-(T+N)),R=Handler.getStudyDashBoardForStudent.roundOff((k+w+S)/O*100);s[g].totalQuestionsForLoggedinStudent=O,s[g].correctPercentageForLoggedinStudent=isNaN(T)?0:T,s[g].partialCorrectPercentageForLoggedinStudent=isNaN(N)?0:N,s[g].incorrectPercentageForLoggedinStudent=isNaN(F)?0:F,s[g].answeredPercentageForLoggedinStudent=isNaN(R)?0:R}var x=Handler.getStudyDashBoardForStudent.roundOff(i/(i+r+n)*100),B=Handler.getStudyDashBoardForStudent.roundOff(r/(r+i+n)*100),D=Handler.getStudyDashBoardForStudent.roundOff(100-(x+B)),q=Handler.getStudyDashBoardForStudent.roundOff((i+r+n)/(o*t)*100);e[a].totalQuestions=o,e[a].correctPercentage=isNaN(x)?0:x,e[a].partialCorrectPercentage=isNaN(B)?0:B,e[a].incorrectPercentage=isNaN(D)?0:D,e[a].answeredPercentage=isNaN(q)?0:q;var _=Handler.getStudyDashBoardForStudent.roundOff(l/(l+d+c)*100),z=Handler.getStudyDashBoardForStudent.roundOff(d/(l+d+c)*100),U=Handler.getStudyDashBoardForStudent.roundOff(100-(_+z)),E=Handler.getStudyDashBoardForStudent.roundOff((l+d+c)/o*100);e[a].totalQuestionsForLoggedinStudent=o,e[a].correctPercentageForLoggedinStudent=isNaN(_)?0:_,e[a].partialCorrectPercentageForLoggedinStudent=isNaN(z)?0:z,e[a].incorrectPercentageForLoggedinStudent=isNaN(U)?0:U,e[a].answeredPercentageForLoggedinStudent=isNaN(E)?0:E}var Q=Handlebars.getTemplate("studyDashBoardForStudent")(e);$("#studyDashBoard").html(Q),t+1===0?($("#comparisonContainer").hide(),$("#comparisonContainer div.switch-user").hide(),$(".stud-dashboard-class-data").hide()):t+1<2?($("#comparisonContainer").hide(),$("#comparisonContainer div.switch-user").show(),$("input#stud-class-comparison").removeAttr("checked"),$("input#stud-class-comparison").attr("disabled","disabled"),$("#comparisonContainer div.switch-label").html("CLASS COMPARISON - OFF"),$("#comparisonContainer div.switch-user").hide(),$(".stud-dashboard-class-data").hide()):($(".stud-dashboard-class-data").show(),$("input#stud-class-comparison").prop("checked","true"),$("input#stud-class-comparison").removeAttr("disabled"),$("#comparisonContainer div.switch-label").html("CLASS COMPARISON - ON"),$("#comparisonContainer div.switch-user").show()),$("#filterContainer, #studyDashBoard").show(),$(".bars li .bar, .bars li .graybar").each(function(e,t){var a=$(this).data("percentage");0==parseInt(a)?($(this).closest("li").append("<div class='student-dashboard-empty-result'></div>"),$(this).hide()):$(this).animate({width:a+"%",height:"100%"},1e3)});var M=parseInt($("#studyDashBoard").css("height"))-22;$(".student-dashboard-table").height(M+"px"),$(".professor-dashboard-table-td").height(M+"px"),$(window).trigger("resize")},updateResults:function(){if(0==$("#filterContainer input:checked").length){var e=$("#filterContainer input#multichoice,#filterContainer input#flashcard, #filterContainer input#hypothetical, #filterContainer input#essay, #filterContainer input#issuespotting");e.prop("checked","checked"),Handler.getStudyDashBoardForStudent.updateQuestionTypeList(e[0])}var t=CaseConnect.studyDashBoardVO,a=t.numberOfEnrolledStudentInClass;"object"==$.type(t.studyDashBoardDetail)&&(t.studyDashBoardDetail=[t.studyDashBoardDetail]);var s=t.studyDashBoardDetail;Handler.getStudyDashBoardForStudent.processStudyDashBoardData(s,a)},updateQuestionTypeList:function(e){var t=$(e),a=CaseConnect.questionTypeList;t.is(":checked")?a.splice(a.indexOf(t.attr("id")),1):a.push(t.attr("id")),CaseConnect.questionTypeList=a},showHideLearningObjective:function(e){$(window).width()<768&&event.stopPropagation();var t=$(e);t.parent().find(">a:first").toggleClass("glyphicon-chevron-right").toggleClass("glyphicon-chevron-down"),t.parent().find(">a:first").hasClass("glyphicon-chevron-down")?t.parent().find(">a:first").attr("aria-label","Hide chapter details"):t.parent().find(">a:first").hasClass("glyphicon-chevron-right")&&t.parent().find(">a:first").attr("aria-label","View chapter details"),t.parent().parent().next(".learningObjectiveList").slideToggle("slow",function(){var e=parseInt($("#studyDashBoard").css("height"))-22;$(".student-dashboard-table").height(e+"px"),$(".professor-dashboard-table-td").height(e+"px"),adjustLeftNavHeight()})},roundOff:function(e){var t=""+e;if(t.indexOf(".")>-1){var a=parseFloat(t.substring(t.indexOf(".")));a>.5?e+=1-a:e-=a}return e}},Handler.dropClass={request:function(e){e.data={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_DELETE_STUDENT_ENROLLMENT_FROM_CLASS",pageNavigatingFrom:"ClassInsight",pageNavigatingTo:"ClassInsight",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:CaseConnect.currentClassId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{classId:CaseConnect.currentClassId,bookId:CaseConnect.currentBookId}},Utility.showSpinner()},response:function(e,t){(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status?(sessionAuthFails(e),Utility.hideSpinner()):(map.wk_conatiner.load("bookShelf.html?v19894",function(){Utility.showSpinner(),localStorage.removeItem("classCodeAddSectionRefresh"),CaseConnect.bookTitle="",CaseConnect.resourceFlag=!1;var t=e;Array.isArray(t.bookVOList)||(t.bookVOList=[t.bookVOList]),$("#drop-class-dialog").modal("hide");var a=t.bookVOList;CaseConnect.navigatingAwayFromNewBookshelf=a;for(var s=0;s<a.length;++s)if(null!=a[s]&&null!=a[s]){if(a[s].classVOList&&"object"==$.type(a[s].classVOList)&&(a[s].classVOList=[a[s].classVOList]),a[s].classVOList)for(var o=[],i="",r=0;r<a[s].classVOList.length;r++){if(a[s].classVOList[r].classVOListLength=a[s].classVOList.length,"object"==$.type(a[s].classVOList[r].coProfessorList)&&(a[s].classVOList[r].coProfessorList=[a[s].classVOList[r].coProfessorList]),o=a[s].classVOList[r].coProfessorList){for(var n=0;n<o.length;n++)i+=o[n].firstName+" "+o[n].lastName+", ";i=i.substring(0,i.lastIndexOf(",")),a[s].classVOList[r].coProfessorList=i}a[s].classVOList[r].classCode&&(a[s].classVOList[r].classCode=a[s].classVOList[r].classCode.toUpperCase())}}else alertMessagesModal("You don't have any book in your bookshelf.");if(null!=t&&null!=t.bookVOList&&null!=t.bookVOList[0]){for(n=0,j=t.bookVOList.length;n<j;n++){var l=(b=t.bookVOList[n]).bookTitle?b.bookTitle:t.lastReadBookTitle;if(l.length>30)var d=l.slice(0,30)+"...";else d=l;var c=new Date(b.bookPublishDate),u=c.getMonth()+1;u<10&&(u="0"+u);var p=c.getDate();p<10&&(p="0"+p);var m=u+"/"+p+"/"+c.getFullYear();b.truncatedBookName=d,b.formatedDate=m}var h=Handlebars.getTemplate("bookshelf-grid")(t),g=$(this).find("#books-grid-view").html(h),f=$(".student-book-author");for(n=0;n<f.length;n++)f[n].innerHTML=f[n].innerHTML.replace(/&nbsp;/g," ");var v=$(".student-book-title");for(n=0;n<v.length;n++)v[n].innerHTML=v[n].innerHTML.replace(/&amp;/g,"&");for(g.find(".books-thumbnail").popover({placement:"right",template:'<div class="popover book-info-popover" aria-hidden="true" tabindex="-1" role="dialog"><div class="arrow info-arrow-right"></div><div class="popover-content"></div></div>',content:function(){return $(this.parentNode).find("#book-info-content").html()}}),n=0;n<t.bookVOList.length;n++){var b;"Resource"!==(b=t.bookVOList[n]).bookType&&"studyaid"!==b.bookType&&"practicepack"!==b.bookType&&"oer"!==b.bookType&&"Themis"!==b.bookType||$("[bookId='"+b.bookId+"']").addClass("center-button")}new List("books-grid-view",{valueNames:["student-book-title","student-book-author","popover-isbn"],listClass:"to-search-booklist",searchClass:"my-search"});CaseConnect.bookListForUser=t,loadPromoSpotlightDashboard(this),$("#bookshelf-username").html(localStorage.getItem("firstName")),$(window).trigger("resize"),e.skipLS||localStorage.setItem("getBookList",JSON.stringify(t))}else alertMessagesModal("You don't have any book in your bookshelf.");Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf()}),Utility.hideSpinner())},showConfirmationDialog:function(){$("#drop-class-dialog").modal("show"),Utility.hideSpinner()}};